
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_gallery/plot_geographic_finite_difference.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_auto_gallery_plot_geographic_finite_difference.py>`
        to download the full example code.

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_gallery_plot_geographic_finite_difference.py:


Geographic Finite Difference
===================================

Before proceeding with all the steps, first import some necessary libraries and packages

.. GENERATED FROM PYTHON SOURCE LINES 8-13

.. code-block:: Python

    import easyclimate as ecl
    import xarray as xr
    import matplotlib.pyplot as plt
    import cartopy.crs as ccrs








.. GENERATED FROM PYTHON SOURCE LINES 14-27

Then consider obtaining meridional and zonal wind variables in tutorial data

.. tip::

  You can download following datasets here:

  - :download:`Download uwnd_202201_mon_mean.nc <https://raw.githubusercontent.com/shenyulu/easyclimate-data/refs/heads/main/uwnd_202201_mon_mean.nc>`
  - :download:`Download vwnd_202201_mon_mean.nc <https://raw.githubusercontent.com/shenyulu/easyclimate-data/refs/heads/main/vwnd_202201_mon_mean.nc>`
  - :download:`Download hgt_202201_mon_mean.nc <https://raw.githubusercontent.com/shenyulu/easyclimate-data/refs/heads/main/hgt_202201_mon_mean.nc>`
  - :download:`Download air_202201_mon_mean.nc <https://raw.githubusercontent.com/shenyulu/easyclimate-data/refs/heads/main/air_202201_mon_mean.nc>`
  - :download:`Download shum_202201_mon_mean.nc <https://raw.githubusercontent.com/shenyulu/easyclimate-data/refs/heads/main/shum_202201_mon_mean.nc>`
  - :download:`Download pressfc_202201_mon_mean.nc <https://raw.githubusercontent.com/shenyulu/easyclimate-data/refs/heads/main/pressfc_202201_mon_mean.nc>`
  - :download:`Download precip_202201_mon_mean.nc <https://raw.githubusercontent.com/shenyulu/easyclimate-data/refs/heads/main/precip_202201_mon_mean.nc>`

.. GENERATED FROM PYTHON SOURCE LINES 27-44

.. code-block:: Python


    u_data = ecl.tutorial.open_tutorial_dataset("uwnd_202201_mon_mean").sortby("lat").uwnd
    v_data = ecl.tutorial.open_tutorial_dataset("vwnd_202201_mon_mean").sortby("lat").vwnd
    z_data = ecl.tutorial.open_tutorial_dataset("hgt_202201_mon_mean").sortby("lat").hgt
    temp_data = ecl.tutorial.open_tutorial_dataset("air_202201_mon_mean").sortby("lat").air
    q_data = ecl.tutorial.open_tutorial_dataset("shum_202201_mon_mean").sortby("lat").shum
    msl_data = (
        ecl.tutorial.open_tutorial_dataset("pressfc_202201_mon_mean").sortby("lat").pres
    )
    pr_data = (
        ecl.tutorial.open_tutorial_dataset("precip_202201_mon_mean").sortby("lat").precip
    )

    uvdata = xr.Dataset()
    uvdata["uwnd"] = u_data
    uvdata["vwnd"] = v_data





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    vwnd_202201_mon_mean.nc ━━━━━━━━━━━━━━ 100.0% • 1.2/1.2 MB • 14.3 MB/s • 0:00:00
    hgt_202201_mon_mean.nc ━━━━━━━━━━━━ 100.0% • 960.5/960.5   • 11.6 MB/s • 0:00:00
                                                 kB                                 
    air_202201_mon_mean.nc ━━━━━━━━━━━━━━━ 100.0% • 1.1/1.1 MB • 13.4 MB/s • 0:00:00
    shum_202201_mon_mean.nc ━━━━━━━━━━━━ 100.0% • 603.3/603.3   • 4.8 MB/s • 0:00:00
                                                  kB                                
    pressfc_202201_mon_mean.nc ━━━━━━━━━━━ 100.0% • 98.7/98.7   • 3.4 MB/s • 0:00:00
                                                    kB                              
    precip_202201_mon_mean.nc ━━━━━━━━━━━━ 100.0% • 74.4/74.4   • 2.5 MB/s • 0:00:00
                                                    kB                              




.. GENERATED FROM PYTHON SOURCE LINES 45-46

Obtain data slices on 500hPa isobars for January 2022

.. GENERATED FROM PYTHON SOURCE LINES 46-51

.. code-block:: Python


    uvdata_500_202201 = uvdata.sel(level=500, time="2022-01-01")
    z_data_500_202201 = z_data.sel(level=500, time="2022-01-01")
    temp_data_500_202201 = temp_data.sel(level=500, time="2022-01-01")








.. GENERATED FROM PYTHON SOURCE LINES 52-53

Plotting a sample `quiver` plot of this data slice

.. GENERATED FROM PYTHON SOURCE LINES 53-72

.. code-block:: Python


    fig, ax = plt.subplots(
        subplot_kw={"projection": ccrs.PlateCarree(central_longitude=180)}
    )

    ax.stock_img()
    ax.gridlines(draw_labels=["bottom", "left"], color="grey", alpha=0.5, linestyle="--")
    ax.coastlines(edgecolor="black", linewidths=0.5)

    uvdata_500_202201.thin(lon=3, lat=3).plot.quiver(
        ax=ax,
        u="uwnd",
        v="vwnd",
        x="lon",
        y="lat",
        # projection on data
        transform=ccrs.PlateCarree(),
    )




.. image-sg:: /auto_gallery/images/sphx_glr_plot_geographic_finite_difference_001.png
   :alt: time = 2022-01-01, level = 500.0 [millibar]
   :srcset: /auto_gallery/images/sphx_glr_plot_geographic_finite_difference_001.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    <matplotlib.quiver.Quiver object at 0x7ff420a014d0>



.. GENERATED FROM PYTHON SOURCE LINES 73-83

First-order Partial Derivative
-------------------------------------

Consider the function :py:func:`easyclimate.calc_gradient <easyclimate.calc_gradient>` to compute the gradient of the zonal wind with respect to longitude.

.. math::

  \frac{\partial u}{\partial \lambda}

The argument `dim` to the function :py:func:`easyclimate.calc_gradient <easyclimate.calc_gradient>` specifies that the direction of the solution is `longitude`.

.. GENERATED FROM PYTHON SOURCE LINES 83-88

.. code-block:: Python


    uwnd_dx = ecl.calc_gradient(uvdata_500_202201.uwnd, dim="lon")

    uwnd_dx






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
    <defs>
    <symbol id="icon-database" viewBox="0 0 32 32">
    <path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
    <path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    <path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    </symbol>
    <symbol id="icon-file-text2" viewBox="0 0 32 32">
    <path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
    <path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    </symbol>
    </defs>
    </svg>
    <style>/* CSS stylesheet for displaying xarray objects in notebooks */

    :root {
      --xr-font-color0: var(
        --jp-content-font-color0,
        var(--pst-color-text-base rgba(0, 0, 0, 1))
      );
      --xr-font-color2: var(
        --jp-content-font-color2,
        var(--pst-color-text-base, rgba(0, 0, 0, 0.54))
      );
      --xr-font-color3: var(
        --jp-content-font-color3,
        var(--pst-color-text-base, rgba(0, 0, 0, 0.38))
      );
      --xr-border-color: var(
        --jp-border-color2,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 10))
      );
      --xr-disabled-color: var(
        --jp-layout-color3,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 40))
      );
      --xr-background-color: var(
        --jp-layout-color0,
        var(--pst-color-on-background, white)
      );
      --xr-background-color-row-even: var(
        --jp-layout-color1,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 5))
      );
      --xr-background-color-row-odd: var(
        --jp-layout-color2,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 15))
      );
    }

    html[theme="dark"],
    html[data-theme="dark"],
    body[data-theme="dark"],
    body.vscode-dark {
      --xr-font-color0: var(
        --jp-content-font-color0,
        var(--pst-color-text-base, rgba(255, 255, 255, 1))
      );
      --xr-font-color2: var(
        --jp-content-font-color2,
        var(--pst-color-text-base, rgba(255, 255, 255, 0.54))
      );
      --xr-font-color3: var(
        --jp-content-font-color3,
        var(--pst-color-text-base, rgba(255, 255, 255, 0.38))
      );
      --xr-border-color: var(
        --jp-border-color2,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))
      );
      --xr-disabled-color: var(
        --jp-layout-color3,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))
      );
      --xr-background-color: var(
        --jp-layout-color0,
        var(--pst-color-on-background, #111111)
      );
      --xr-background-color-row-even: var(
        --jp-layout-color1,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))
      );
      --xr-background-color-row-odd: var(
        --jp-layout-color2,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))
      );
    }

    .xr-wrap {
      display: block !important;
      min-width: 300px;
      max-width: 700px;
      line-height: 1.6;
    }

    .xr-text-repr-fallback {
      /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
      display: none;
    }

    .xr-header {
      padding-top: 6px;
      padding-bottom: 6px;
      margin-bottom: 4px;
      border-bottom: solid 1px var(--xr-border-color);
    }

    .xr-header > div,
    .xr-header > ul {
      display: inline;
      margin-top: 0;
      margin-bottom: 0;
    }

    .xr-obj-type,
    .xr-obj-name,
    .xr-group-name {
      margin-left: 2px;
      margin-right: 10px;
    }

    .xr-group-name::before {
      content: "📁";
      padding-right: 0.3em;
    }

    .xr-group-name,
    .xr-obj-type {
      color: var(--xr-font-color2);
    }

    .xr-sections {
      padding-left: 0 !important;
      display: grid;
      grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
      margin-block-start: 0;
      margin-block-end: 0;
    }

    .xr-section-item {
      display: contents;
    }

    .xr-section-item input {
      display: inline-block;
      opacity: 0;
      height: 0;
      margin: 0;
    }

    .xr-section-item input + label {
      color: var(--xr-disabled-color);
      border: 2px solid transparent !important;
    }

    .xr-section-item input:enabled + label {
      cursor: pointer;
      color: var(--xr-font-color2);
    }

    .xr-section-item input:focus + label {
      border: 2px solid var(--xr-font-color0) !important;
    }

    .xr-section-item input:enabled + label:hover {
      color: var(--xr-font-color0);
    }

    .xr-section-summary {
      grid-column: 1;
      color: var(--xr-font-color2);
      font-weight: 500;
    }

    .xr-section-summary > span {
      display: inline-block;
      padding-left: 0.5em;
    }

    .xr-section-summary-in:disabled + label {
      color: var(--xr-font-color2);
    }

    .xr-section-summary-in + label:before {
      display: inline-block;
      content: "►";
      font-size: 11px;
      width: 15px;
      text-align: center;
    }

    .xr-section-summary-in:disabled + label:before {
      color: var(--xr-disabled-color);
    }

    .xr-section-summary-in:checked + label:before {
      content: "▼";
    }

    .xr-section-summary-in:checked + label > span {
      display: none;
    }

    .xr-section-summary,
    .xr-section-inline-details {
      padding-top: 4px;
    }

    .xr-section-inline-details {
      grid-column: 2 / -1;
    }

    .xr-section-details {
      display: none;
      grid-column: 1 / -1;
      margin-top: 4px;
      margin-bottom: 5px;
    }

    .xr-section-summary-in:checked ~ .xr-section-details {
      display: contents;
    }

    .xr-group-box {
      display: inline-grid;
      grid-template-columns: 0px 20px auto;
      width: 100%;
    }

    .xr-group-box-vline {
      grid-column-start: 1;
      border-right: 0.2em solid;
      border-color: var(--xr-border-color);
      width: 0px;
    }

    .xr-group-box-hline {
      grid-column-start: 2;
      grid-row-start: 1;
      height: 1em;
      width: 20px;
      border-bottom: 0.2em solid;
      border-color: var(--xr-border-color);
    }

    .xr-group-box-contents {
      grid-column-start: 3;
    }

    .xr-array-wrap {
      grid-column: 1 / -1;
      display: grid;
      grid-template-columns: 20px auto;
    }

    .xr-array-wrap > label {
      grid-column: 1;
      vertical-align: top;
    }

    .xr-preview {
      color: var(--xr-font-color3);
    }

    .xr-array-preview,
    .xr-array-data {
      padding: 0 5px !important;
      grid-column: 2;
    }

    .xr-array-data,
    .xr-array-in:checked ~ .xr-array-preview {
      display: none;
    }

    .xr-array-in:checked ~ .xr-array-data,
    .xr-array-preview {
      display: inline-block;
    }

    .xr-dim-list {
      display: inline-block !important;
      list-style: none;
      padding: 0 !important;
      margin: 0;
    }

    .xr-dim-list li {
      display: inline-block;
      padding: 0;
      margin: 0;
    }

    .xr-dim-list:before {
      content: "(";
    }

    .xr-dim-list:after {
      content: ")";
    }

    .xr-dim-list li:not(:last-child):after {
      content: ",";
      padding-right: 5px;
    }

    .xr-has-index {
      font-weight: bold;
    }

    .xr-var-list,
    .xr-var-item {
      display: contents;
    }

    .xr-var-item > div,
    .xr-var-item label,
    .xr-var-item > .xr-var-name span {
      background-color: var(--xr-background-color-row-even);
      border-color: var(--xr-background-color-row-odd);
      margin-bottom: 0;
      padding-top: 2px;
    }

    .xr-var-item > .xr-var-name:hover span {
      padding-right: 5px;
    }

    .xr-var-list > li:nth-child(odd) > div,
    .xr-var-list > li:nth-child(odd) > label,
    .xr-var-list > li:nth-child(odd) > .xr-var-name span {
      background-color: var(--xr-background-color-row-odd);
      border-color: var(--xr-background-color-row-even);
    }

    .xr-var-name {
      grid-column: 1;
    }

    .xr-var-dims {
      grid-column: 2;
    }

    .xr-var-dtype {
      grid-column: 3;
      text-align: right;
      color: var(--xr-font-color2);
    }

    .xr-var-preview {
      grid-column: 4;
    }

    .xr-index-preview {
      grid-column: 2 / 5;
      color: var(--xr-font-color2);
    }

    .xr-var-name,
    .xr-var-dims,
    .xr-var-dtype,
    .xr-preview,
    .xr-attrs dt {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      padding-right: 10px;
    }

    .xr-var-name:hover,
    .xr-var-dims:hover,
    .xr-var-dtype:hover,
    .xr-attrs dt:hover {
      overflow: visible;
      width: auto;
      z-index: 1;
    }

    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      display: none;
      border-top: 2px dotted var(--xr-background-color);
      padding-bottom: 20px !important;
      padding-top: 10px !important;
    }

    .xr-var-attrs-in + label,
    .xr-var-data-in + label,
    .xr-index-data-in + label {
      padding: 0 1px;
    }

    .xr-var-attrs-in:checked ~ .xr-var-attrs,
    .xr-var-data-in:checked ~ .xr-var-data,
    .xr-index-data-in:checked ~ .xr-index-data {
      display: block;
    }

    .xr-var-data > table {
      float: right;
    }

    .xr-var-data > pre,
    .xr-index-data > pre,
    .xr-var-data > table > tbody > tr {
      background-color: transparent !important;
    }

    .xr-var-name span,
    .xr-var-data,
    .xr-index-name div,
    .xr-index-data,
    .xr-attrs {
      padding-left: 25px !important;
    }

    .xr-attrs,
    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      grid-column: 1 / -1;
    }

    dl.xr-attrs {
      padding: 0;
      margin: 0;
      display: grid;
      grid-template-columns: 125px auto;
    }

    .xr-attrs dt,
    .xr-attrs dd {
      padding: 0;
      margin: 0;
      float: left;
      padding-right: 10px;
      width: auto;
    }

    .xr-attrs dt {
      font-weight: normal;
      grid-column: 1;
    }

    .xr-attrs dt:hover span {
      display: inline-block;
      background: var(--xr-background-color);
      padding-right: 10px;
    }

    .xr-attrs dd {
      grid-column: 2;
      white-space: pre-wrap;
      word-break: break-all;
    }

    .xr-icon-database,
    .xr-icon-file-text2,
    .xr-no-icon {
      display: inline-block;
      vertical-align: middle;
      width: 1em;
      height: 1.5em !important;
      stroke-width: 0;
      stroke: currentColor;
      fill: currentColor;
    }

    .xr-var-attrs-in:checked + label > .xr-icon-file-text2,
    .xr-var-data-in:checked + label > .xr-icon-database,
    .xr-index-data-in:checked + label > .xr-icon-database {
      color: var(--xr-font-color0);
      filter: drop-shadow(1px 1px 5px var(--xr-font-color2));
      stroke-width: 0.8px;
    }
    </style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;uwnd&#x27; (lat: 73, lon: 144)&gt; Size: 42kB
    array([[ 0.14999962,  0.13225818,  0.11854815, ...,  0.15927446,
             0.15080655,  0.14274216],
           [ 0.25967765,  0.25645185,  0.24798417, ...,  0.27499998,
             0.27661264,  0.27983665],
           [ 0.33306527,  0.30725718,  0.2846775 , ...,  0.35040367,
             0.34435558,  0.34112835],
           ...,
           [-0.1056456 , -0.12661296, -0.13790333, ..., -0.08024192,
            -0.09354854, -0.11290336],
           [-0.07903278, -0.08870995, -0.09435463, ..., -0.08266127,
            -0.08064544, -0.07741928],
           [-0.0576601 , -0.03749967, -0.02540326, ..., -0.07540298,
            -0.06532216, -0.06693745]], shape=(73, 144), dtype=float32)
    Coordinates:
      * lat      (lat) float32 292B -90.0 -87.5 -85.0 -82.5 ... 82.5 85.0 87.5 90.0
      * lon      (lon) float32 576B 0.0 2.5 5.0 7.5 10.0 ... 350.0 352.5 355.0 357.5
        time     datetime64[ns] 8B 2022-01-01
        level    float32 4B 500.0
    Attributes:
        long_name:     Monthly mean u wind
        units:         m/s
        precision:     2
        var_desc:      u-wind
        level_desc:    Pressure Levels
        statistic:     Mean
        parent_stat:   Other
        dataset:       NCEP Reanalysis Derived Products
        actual_range:  [-68.194824 124.399994]</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-obj-name'>&#x27;uwnd&#x27;</div><ul class='xr-dim-list'><li><span class='xr-has-index'>lat</span>: 73</li><li><span class='xr-has-index'>lon</span>: 144</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-71a66e27-fc32-471b-b23b-916853c2ff6c' class='xr-array-in' type='checkbox' checked><label for='section-71a66e27-fc32-471b-b23b-916853c2ff6c' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>0.15 0.1323 0.1185 0.1125 ... -0.08952 -0.0754 -0.06532 -0.06694</span></div><div class='xr-array-data'><pre>array([[ 0.14999962,  0.13225818,  0.11854815, ...,  0.15927446,
             0.15080655,  0.14274216],
           [ 0.25967765,  0.25645185,  0.24798417, ...,  0.27499998,
             0.27661264,  0.27983665],
           [ 0.33306527,  0.30725718,  0.2846775 , ...,  0.35040367,
             0.34435558,  0.34112835],
           ...,
           [-0.1056456 , -0.12661296, -0.13790333, ..., -0.08024192,
            -0.09354854, -0.11290336],
           [-0.07903278, -0.08870995, -0.09435463, ..., -0.08266127,
            -0.08064544, -0.07741928],
           [-0.0576601 , -0.03749967, -0.02540326, ..., -0.07540298,
            -0.06532216, -0.06693745]], shape=(73, 144), dtype=float32)</pre></div></div></li><li class='xr-section-item'><input id='section-5d310f85-4a8f-4f18-9147-271b0833fd9d' class='xr-section-summary-in' type='checkbox'  checked><label for='section-5d310f85-4a8f-4f18-9147-271b0833fd9d' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-90.0 -87.5 -85.0 ... 87.5 90.0</div><input id='attrs-d418de4a-645d-45b2-b439-9454b42879e9' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-d418de4a-645d-45b2-b439-9454b42879e9' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6c590b28-101a-498b-b103-776eb6dba14d' class='xr-var-data-in' type='checkbox'><label for='data-6c590b28-101a-498b-b103-776eb6dba14d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>long_name :</span></dt><dd>Latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>axis :</span></dt><dd>Y</dd></dl></div><div class='xr-var-data'><pre>array([-90. , -87.5, -85. , -82.5, -80. , -77.5, -75. , -72.5, -70. , -67.5,
           -65. , -62.5, -60. , -57.5, -55. , -52.5, -50. , -47.5, -45. , -42.5,
           -40. , -37.5, -35. , -32.5, -30. , -27.5, -25. , -22.5, -20. , -17.5,
           -15. , -12.5, -10. ,  -7.5,  -5. ,  -2.5,   0. ,   2.5,   5. ,   7.5,
            10. ,  12.5,  15. ,  17.5,  20. ,  22.5,  25. ,  27.5,  30. ,  32.5,
            35. ,  37.5,  40. ,  42.5,  45. ,  47.5,  50. ,  52.5,  55. ,  57.5,
            60. ,  62.5,  65. ,  67.5,  70. ,  72.5,  75. ,  77.5,  80. ,  82.5,
            85. ,  87.5,  90. ], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.0 2.5 5.0 ... 352.5 355.0 357.5</div><input id='attrs-534e7e5e-5111-475e-b7ce-e40d37ac7bfc' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-534e7e5e-5111-475e-b7ce-e40d37ac7bfc' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2fcfcaf9-ef41-48f0-a2ec-5054f09cf193' class='xr-var-data-in' type='checkbox'><label for='data-2fcfcaf9-ef41-48f0-a2ec-5054f09cf193' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>long_name :</span></dt><dd>Longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>axis :</span></dt><dd>X</dd></dl></div><div class='xr-var-data'><pre>array([  0. ,   2.5,   5. ,   7.5,  10. ,  12.5,  15. ,  17.5,  20. ,  22.5,
            25. ,  27.5,  30. ,  32.5,  35. ,  37.5,  40. ,  42.5,  45. ,  47.5,
            50. ,  52.5,  55. ,  57.5,  60. ,  62.5,  65. ,  67.5,  70. ,  72.5,
            75. ,  77.5,  80. ,  82.5,  85. ,  87.5,  90. ,  92.5,  95. ,  97.5,
           100. , 102.5, 105. , 107.5, 110. , 112.5, 115. , 117.5, 120. , 122.5,
           125. , 127.5, 130. , 132.5, 135. , 137.5, 140. , 142.5, 145. , 147.5,
           150. , 152.5, 155. , 157.5, 160. , 162.5, 165. , 167.5, 170. , 172.5,
           175. , 177.5, 180. , 182.5, 185. , 187.5, 190. , 192.5, 195. , 197.5,
           200. , 202.5, 205. , 207.5, 210. , 212.5, 215. , 217.5, 220. , 222.5,
           225. , 227.5, 230. , 232.5, 235. , 237.5, 240. , 242.5, 245. , 247.5,
           250. , 252.5, 255. , 257.5, 260. , 262.5, 265. , 267.5, 270. , 272.5,
           275. , 277.5, 280. , 282.5, 285. , 287.5, 290. , 292.5, 295. , 297.5,
           300. , 302.5, 305. , 307.5, 310. , 312.5, 315. , 317.5, 320. , 322.5,
           325. , 327.5, 330. , 332.5, 335. , 337.5, 340. , 342.5, 345. , 347.5,
           350. , 352.5, 355. , 357.5], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>time</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2022-01-01</div><input id='attrs-fd1329f2-3d5f-4148-8cec-663355b3fdf2' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-fd1329f2-3d5f-4148-8cec-663355b3fdf2' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-64d69426-d563-4e68-9f0e-263395c68d6a' class='xr-var-data-in' type='checkbox'><label for='data-64d69426-d563-4e68-9f0e-263395c68d6a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>time</dd><dt><span>long_name :</span></dt><dd>Time</dd><dt><span>axis :</span></dt><dd>T</dd></dl></div><div class='xr-var-data'><pre>array(&#x27;2022-01-01T00:00:00.000000000&#x27;, dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>level</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>500.0</div><input id='attrs-a0d89cda-5a7f-4862-945a-636d1937ff74' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-a0d89cda-5a7f-4862-945a-636d1937ff74' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4003d74c-ed83-4779-a6ab-6c4f94a1c22b' class='xr-var-data-in' type='checkbox'><label for='data-4003d74c-ed83-4779-a6ab-6c4f94a1c22b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>air_pressure</dd><dt><span>long_name :</span></dt><dd>Level</dd><dt><span>units :</span></dt><dd>millibar</dd><dt><span>positive :</span></dt><dd>down</dd><dt><span>axis :</span></dt><dd>Z</dd><dt><span>GRIB_id :</span></dt><dd>100</dd><dt><span>GRIB_name :</span></dt><dd>hPa</dd><dt><span>actual_range :</span></dt><dd>[1000.   10.]</dd></dl></div><div class='xr-var-data'><pre>array(500., dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-c80a3834-7665-4316-ae6b-3d0f8ffe87b6' class='xr-section-summary-in' type='checkbox'  checked><label for='section-c80a3834-7665-4316-ae6b-3d0f8ffe87b6' class='xr-section-summary' >Attributes: <span>(9)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Monthly mean u wind</dd><dt><span>units :</span></dt><dd>m/s</dd><dt><span>precision :</span></dt><dd>2</dd><dt><span>var_desc :</span></dt><dd>u-wind</dd><dt><span>level_desc :</span></dt><dd>Pressure Levels</dd><dt><span>statistic :</span></dt><dd>Mean</dd><dt><span>parent_stat :</span></dt><dd>Other</dd><dt><span>dataset :</span></dt><dd>NCEP Reanalysis Derived Products</dd><dt><span>actual_range :</span></dt><dd>[-68.194824 124.399994]</dd></dl></div></li></ul></div></div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 89-107

.. code-block:: Python


    fig, ax = plt.subplots(
        subplot_kw={"projection": ccrs.PlateCarree(central_longitude=180)}
    )

    ax.stock_img()
    ax.gridlines(draw_labels=["bottom", "left"], color="grey", alpha=0.5, linestyle="--")
    ax.coastlines(edgecolor="black", linewidths=0.5)

    uwnd_dx.plot.contourf(
        ax=ax,
        # projection on data
        transform=ccrs.PlateCarree(),
        # Colorbar is placed at the bottom
        cbar_kwargs={"location": "bottom"},
        levels=21,
    )




.. image-sg:: /auto_gallery/images/sphx_glr_plot_geographic_finite_difference_002.png
   :alt: time = 2022-01-01, level = 500.0 [millibar]
   :srcset: /auto_gallery/images/sphx_glr_plot_geographic_finite_difference_002.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    <cartopy.mpl.contour.GeoContourSet object at 0x7ff420df6790>



.. GENERATED FROM PYTHON SOURCE LINES 108-109

Of course, it is also possible to pass in :py:class:`xarray.Dataset<xarray.Dataset>` directly into the function :py:func:`easyclimate.calc_gradient <easyclimate.calc_gradient>` to iterate through all the variables, so that you can get the gradient of both the zonal and meridional winds with respect to longitude at the same time.

.. GENERATED FROM PYTHON SOURCE LINES 109-114

.. code-block:: Python


    uvwnd_dx = ecl.calc_gradient(uvdata_500_202201, dim="lon")

    uvwnd_dx






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
    <defs>
    <symbol id="icon-database" viewBox="0 0 32 32">
    <path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
    <path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    <path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    </symbol>
    <symbol id="icon-file-text2" viewBox="0 0 32 32">
    <path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
    <path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    </symbol>
    </defs>
    </svg>
    <style>/* CSS stylesheet for displaying xarray objects in notebooks */

    :root {
      --xr-font-color0: var(
        --jp-content-font-color0,
        var(--pst-color-text-base rgba(0, 0, 0, 1))
      );
      --xr-font-color2: var(
        --jp-content-font-color2,
        var(--pst-color-text-base, rgba(0, 0, 0, 0.54))
      );
      --xr-font-color3: var(
        --jp-content-font-color3,
        var(--pst-color-text-base, rgba(0, 0, 0, 0.38))
      );
      --xr-border-color: var(
        --jp-border-color2,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 10))
      );
      --xr-disabled-color: var(
        --jp-layout-color3,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 40))
      );
      --xr-background-color: var(
        --jp-layout-color0,
        var(--pst-color-on-background, white)
      );
      --xr-background-color-row-even: var(
        --jp-layout-color1,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 5))
      );
      --xr-background-color-row-odd: var(
        --jp-layout-color2,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 15))
      );
    }

    html[theme="dark"],
    html[data-theme="dark"],
    body[data-theme="dark"],
    body.vscode-dark {
      --xr-font-color0: var(
        --jp-content-font-color0,
        var(--pst-color-text-base, rgba(255, 255, 255, 1))
      );
      --xr-font-color2: var(
        --jp-content-font-color2,
        var(--pst-color-text-base, rgba(255, 255, 255, 0.54))
      );
      --xr-font-color3: var(
        --jp-content-font-color3,
        var(--pst-color-text-base, rgba(255, 255, 255, 0.38))
      );
      --xr-border-color: var(
        --jp-border-color2,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))
      );
      --xr-disabled-color: var(
        --jp-layout-color3,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))
      );
      --xr-background-color: var(
        --jp-layout-color0,
        var(--pst-color-on-background, #111111)
      );
      --xr-background-color-row-even: var(
        --jp-layout-color1,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))
      );
      --xr-background-color-row-odd: var(
        --jp-layout-color2,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))
      );
    }

    .xr-wrap {
      display: block !important;
      min-width: 300px;
      max-width: 700px;
      line-height: 1.6;
    }

    .xr-text-repr-fallback {
      /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
      display: none;
    }

    .xr-header {
      padding-top: 6px;
      padding-bottom: 6px;
      margin-bottom: 4px;
      border-bottom: solid 1px var(--xr-border-color);
    }

    .xr-header > div,
    .xr-header > ul {
      display: inline;
      margin-top: 0;
      margin-bottom: 0;
    }

    .xr-obj-type,
    .xr-obj-name,
    .xr-group-name {
      margin-left: 2px;
      margin-right: 10px;
    }

    .xr-group-name::before {
      content: "📁";
      padding-right: 0.3em;
    }

    .xr-group-name,
    .xr-obj-type {
      color: var(--xr-font-color2);
    }

    .xr-sections {
      padding-left: 0 !important;
      display: grid;
      grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
      margin-block-start: 0;
      margin-block-end: 0;
    }

    .xr-section-item {
      display: contents;
    }

    .xr-section-item input {
      display: inline-block;
      opacity: 0;
      height: 0;
      margin: 0;
    }

    .xr-section-item input + label {
      color: var(--xr-disabled-color);
      border: 2px solid transparent !important;
    }

    .xr-section-item input:enabled + label {
      cursor: pointer;
      color: var(--xr-font-color2);
    }

    .xr-section-item input:focus + label {
      border: 2px solid var(--xr-font-color0) !important;
    }

    .xr-section-item input:enabled + label:hover {
      color: var(--xr-font-color0);
    }

    .xr-section-summary {
      grid-column: 1;
      color: var(--xr-font-color2);
      font-weight: 500;
    }

    .xr-section-summary > span {
      display: inline-block;
      padding-left: 0.5em;
    }

    .xr-section-summary-in:disabled + label {
      color: var(--xr-font-color2);
    }

    .xr-section-summary-in + label:before {
      display: inline-block;
      content: "►";
      font-size: 11px;
      width: 15px;
      text-align: center;
    }

    .xr-section-summary-in:disabled + label:before {
      color: var(--xr-disabled-color);
    }

    .xr-section-summary-in:checked + label:before {
      content: "▼";
    }

    .xr-section-summary-in:checked + label > span {
      display: none;
    }

    .xr-section-summary,
    .xr-section-inline-details {
      padding-top: 4px;
    }

    .xr-section-inline-details {
      grid-column: 2 / -1;
    }

    .xr-section-details {
      display: none;
      grid-column: 1 / -1;
      margin-top: 4px;
      margin-bottom: 5px;
    }

    .xr-section-summary-in:checked ~ .xr-section-details {
      display: contents;
    }

    .xr-group-box {
      display: inline-grid;
      grid-template-columns: 0px 20px auto;
      width: 100%;
    }

    .xr-group-box-vline {
      grid-column-start: 1;
      border-right: 0.2em solid;
      border-color: var(--xr-border-color);
      width: 0px;
    }

    .xr-group-box-hline {
      grid-column-start: 2;
      grid-row-start: 1;
      height: 1em;
      width: 20px;
      border-bottom: 0.2em solid;
      border-color: var(--xr-border-color);
    }

    .xr-group-box-contents {
      grid-column-start: 3;
    }

    .xr-array-wrap {
      grid-column: 1 / -1;
      display: grid;
      grid-template-columns: 20px auto;
    }

    .xr-array-wrap > label {
      grid-column: 1;
      vertical-align: top;
    }

    .xr-preview {
      color: var(--xr-font-color3);
    }

    .xr-array-preview,
    .xr-array-data {
      padding: 0 5px !important;
      grid-column: 2;
    }

    .xr-array-data,
    .xr-array-in:checked ~ .xr-array-preview {
      display: none;
    }

    .xr-array-in:checked ~ .xr-array-data,
    .xr-array-preview {
      display: inline-block;
    }

    .xr-dim-list {
      display: inline-block !important;
      list-style: none;
      padding: 0 !important;
      margin: 0;
    }

    .xr-dim-list li {
      display: inline-block;
      padding: 0;
      margin: 0;
    }

    .xr-dim-list:before {
      content: "(";
    }

    .xr-dim-list:after {
      content: ")";
    }

    .xr-dim-list li:not(:last-child):after {
      content: ",";
      padding-right: 5px;
    }

    .xr-has-index {
      font-weight: bold;
    }

    .xr-var-list,
    .xr-var-item {
      display: contents;
    }

    .xr-var-item > div,
    .xr-var-item label,
    .xr-var-item > .xr-var-name span {
      background-color: var(--xr-background-color-row-even);
      border-color: var(--xr-background-color-row-odd);
      margin-bottom: 0;
      padding-top: 2px;
    }

    .xr-var-item > .xr-var-name:hover span {
      padding-right: 5px;
    }

    .xr-var-list > li:nth-child(odd) > div,
    .xr-var-list > li:nth-child(odd) > label,
    .xr-var-list > li:nth-child(odd) > .xr-var-name span {
      background-color: var(--xr-background-color-row-odd);
      border-color: var(--xr-background-color-row-even);
    }

    .xr-var-name {
      grid-column: 1;
    }

    .xr-var-dims {
      grid-column: 2;
    }

    .xr-var-dtype {
      grid-column: 3;
      text-align: right;
      color: var(--xr-font-color2);
    }

    .xr-var-preview {
      grid-column: 4;
    }

    .xr-index-preview {
      grid-column: 2 / 5;
      color: var(--xr-font-color2);
    }

    .xr-var-name,
    .xr-var-dims,
    .xr-var-dtype,
    .xr-preview,
    .xr-attrs dt {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      padding-right: 10px;
    }

    .xr-var-name:hover,
    .xr-var-dims:hover,
    .xr-var-dtype:hover,
    .xr-attrs dt:hover {
      overflow: visible;
      width: auto;
      z-index: 1;
    }

    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      display: none;
      border-top: 2px dotted var(--xr-background-color);
      padding-bottom: 20px !important;
      padding-top: 10px !important;
    }

    .xr-var-attrs-in + label,
    .xr-var-data-in + label,
    .xr-index-data-in + label {
      padding: 0 1px;
    }

    .xr-var-attrs-in:checked ~ .xr-var-attrs,
    .xr-var-data-in:checked ~ .xr-var-data,
    .xr-index-data-in:checked ~ .xr-index-data {
      display: block;
    }

    .xr-var-data > table {
      float: right;
    }

    .xr-var-data > pre,
    .xr-index-data > pre,
    .xr-var-data > table > tbody > tr {
      background-color: transparent !important;
    }

    .xr-var-name span,
    .xr-var-data,
    .xr-index-name div,
    .xr-index-data,
    .xr-attrs {
      padding-left: 25px !important;
    }

    .xr-attrs,
    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      grid-column: 1 / -1;
    }

    dl.xr-attrs {
      padding: 0;
      margin: 0;
      display: grid;
      grid-template-columns: 125px auto;
    }

    .xr-attrs dt,
    .xr-attrs dd {
      padding: 0;
      margin: 0;
      float: left;
      padding-right: 10px;
      width: auto;
    }

    .xr-attrs dt {
      font-weight: normal;
      grid-column: 1;
    }

    .xr-attrs dt:hover span {
      display: inline-block;
      background: var(--xr-background-color);
      padding-right: 10px;
    }

    .xr-attrs dd {
      grid-column: 2;
      white-space: pre-wrap;
      word-break: break-all;
    }

    .xr-icon-database,
    .xr-icon-file-text2,
    .xr-no-icon {
      display: inline-block;
      vertical-align: middle;
      width: 1em;
      height: 1.5em !important;
      stroke-width: 0;
      stroke: currentColor;
      fill: currentColor;
    }

    .xr-var-attrs-in:checked + label > .xr-icon-file-text2,
    .xr-var-data-in:checked + label > .xr-icon-database,
    .xr-index-data-in:checked + label > .xr-icon-database {
      color: var(--xr-font-color0);
      filter: drop-shadow(1px 1px 5px var(--xr-font-color2));
      stroke-width: 0.8px;
    }
    </style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 85kB
    Dimensions:  (lon: 144, lat: 73)
    Coordinates:
      * lon      (lon) float32 576B 0.0 2.5 5.0 7.5 10.0 ... 350.0 352.5 355.0 357.5
      * lat      (lat) float32 292B -90.0 -87.5 -85.0 -82.5 ... 82.5 85.0 87.5 90.0
        time     datetime64[ns] 8B 2022-01-01
        level    float32 4B 500.0
    Data variables:
        uwnd     (lat, lon) float32 42kB 0.15 0.1323 0.1185 ... -0.06532 -0.06694
        vwnd     (lat, lon) float32 42kB 0.1734 0.1815 0.1895 ... 0.2234 0.2137</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-497558d9-ef45-4060-8549-c2fb00361f45' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-497558d9-ef45-4060-8549-c2fb00361f45' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>lon</span>: 144</li><li><span class='xr-has-index'>lat</span>: 73</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-faff6d9f-5be4-43ef-bbd3-e26cbadb6711' class='xr-section-summary-in' type='checkbox'  checked><label for='section-faff6d9f-5be4-43ef-bbd3-e26cbadb6711' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.0 2.5 5.0 ... 352.5 355.0 357.5</div><input id='attrs-db39f324-76eb-4d79-83af-a9bbbc754aeb' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-db39f324-76eb-4d79-83af-a9bbbc754aeb' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d3fff164-257f-4e45-bd13-43d342ea6144' class='xr-var-data-in' type='checkbox'><label for='data-d3fff164-257f-4e45-bd13-43d342ea6144' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>long_name :</span></dt><dd>Longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>axis :</span></dt><dd>X</dd></dl></div><div class='xr-var-data'><pre>array([  0. ,   2.5,   5. ,   7.5,  10. ,  12.5,  15. ,  17.5,  20. ,  22.5,
            25. ,  27.5,  30. ,  32.5,  35. ,  37.5,  40. ,  42.5,  45. ,  47.5,
            50. ,  52.5,  55. ,  57.5,  60. ,  62.5,  65. ,  67.5,  70. ,  72.5,
            75. ,  77.5,  80. ,  82.5,  85. ,  87.5,  90. ,  92.5,  95. ,  97.5,
           100. , 102.5, 105. , 107.5, 110. , 112.5, 115. , 117.5, 120. , 122.5,
           125. , 127.5, 130. , 132.5, 135. , 137.5, 140. , 142.5, 145. , 147.5,
           150. , 152.5, 155. , 157.5, 160. , 162.5, 165. , 167.5, 170. , 172.5,
           175. , 177.5, 180. , 182.5, 185. , 187.5, 190. , 192.5, 195. , 197.5,
           200. , 202.5, 205. , 207.5, 210. , 212.5, 215. , 217.5, 220. , 222.5,
           225. , 227.5, 230. , 232.5, 235. , 237.5, 240. , 242.5, 245. , 247.5,
           250. , 252.5, 255. , 257.5, 260. , 262.5, 265. , 267.5, 270. , 272.5,
           275. , 277.5, 280. , 282.5, 285. , 287.5, 290. , 292.5, 295. , 297.5,
           300. , 302.5, 305. , 307.5, 310. , 312.5, 315. , 317.5, 320. , 322.5,
           325. , 327.5, 330. , 332.5, 335. , 337.5, 340. , 342.5, 345. , 347.5,
           350. , 352.5, 355. , 357.5], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-90.0 -87.5 -85.0 ... 87.5 90.0</div><input id='attrs-abda960e-d1cd-4765-81aa-30f57d0692f9' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-abda960e-d1cd-4765-81aa-30f57d0692f9' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e6e0b5fb-5eda-4e62-9ff2-9487461227d4' class='xr-var-data-in' type='checkbox'><label for='data-e6e0b5fb-5eda-4e62-9ff2-9487461227d4' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>long_name :</span></dt><dd>Latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>axis :</span></dt><dd>Y</dd></dl></div><div class='xr-var-data'><pre>array([-90. , -87.5, -85. , -82.5, -80. , -77.5, -75. , -72.5, -70. , -67.5,
           -65. , -62.5, -60. , -57.5, -55. , -52.5, -50. , -47.5, -45. , -42.5,
           -40. , -37.5, -35. , -32.5, -30. , -27.5, -25. , -22.5, -20. , -17.5,
           -15. , -12.5, -10. ,  -7.5,  -5. ,  -2.5,   0. ,   2.5,   5. ,   7.5,
            10. ,  12.5,  15. ,  17.5,  20. ,  22.5,  25. ,  27.5,  30. ,  32.5,
            35. ,  37.5,  40. ,  42.5,  45. ,  47.5,  50. ,  52.5,  55. ,  57.5,
            60. ,  62.5,  65. ,  67.5,  70. ,  72.5,  75. ,  77.5,  80. ,  82.5,
            85. ,  87.5,  90. ], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>time</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2022-01-01</div><input id='attrs-748f3f19-72dd-47d0-8413-7736289b0cfb' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-748f3f19-72dd-47d0-8413-7736289b0cfb' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1d8f8dae-f686-4c9b-a3c0-32e7b088f7b1' class='xr-var-data-in' type='checkbox'><label for='data-1d8f8dae-f686-4c9b-a3c0-32e7b088f7b1' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>time</dd><dt><span>long_name :</span></dt><dd>Time</dd><dt><span>axis :</span></dt><dd>T</dd></dl></div><div class='xr-var-data'><pre>array(&#x27;2022-01-01T00:00:00.000000000&#x27;, dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>level</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>500.0</div><input id='attrs-34bbd40b-3b1a-4a7d-938d-8ce9010a4088' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-34bbd40b-3b1a-4a7d-938d-8ce9010a4088' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-67d02f42-f81d-4e03-b889-d0c8243fc665' class='xr-var-data-in' type='checkbox'><label for='data-67d02f42-f81d-4e03-b889-d0c8243fc665' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>air_pressure</dd><dt><span>long_name :</span></dt><dd>Level</dd><dt><span>units :</span></dt><dd>millibar</dd><dt><span>positive :</span></dt><dd>down</dd><dt><span>axis :</span></dt><dd>Z</dd><dt><span>GRIB_id :</span></dt><dd>100</dd><dt><span>GRIB_name :</span></dt><dd>hPa</dd><dt><span>actual_range :</span></dt><dd>[1000.   10.]</dd></dl></div><div class='xr-var-data'><pre>array(500., dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-8dca5400-61ce-4c6f-8d54-2f12376edd4e' class='xr-section-summary-in' type='checkbox'  checked><label for='section-8dca5400-61ce-4c6f-8d54-2f12376edd4e' class='xr-section-summary' >Data variables: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>uwnd</span></div><div class='xr-var-dims'>(lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.15 0.1323 ... -0.06532 -0.06694</div><input id='attrs-04eaacde-7565-402c-9061-04acab922df5' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-04eaacde-7565-402c-9061-04acab922df5' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d592a2f0-513d-4a81-aa20-c43b6b394036' class='xr-var-data-in' type='checkbox'><label for='data-d592a2f0-513d-4a81-aa20-c43b6b394036' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Monthly mean u wind</dd><dt><span>units :</span></dt><dd>m/s</dd><dt><span>precision :</span></dt><dd>2</dd><dt><span>var_desc :</span></dt><dd>u-wind</dd><dt><span>level_desc :</span></dt><dd>Pressure Levels</dd><dt><span>statistic :</span></dt><dd>Mean</dd><dt><span>parent_stat :</span></dt><dd>Other</dd><dt><span>dataset :</span></dt><dd>NCEP Reanalysis Derived Products</dd><dt><span>actual_range :</span></dt><dd>[-68.194824 124.399994]</dd></dl></div><div class='xr-var-data'><pre>array([[ 0.14999962,  0.13225818,  0.11854815, ...,  0.15927446,
             0.15080655,  0.14274216],
           [ 0.25967765,  0.25645185,  0.24798417, ...,  0.27499998,
             0.27661264,  0.27983665],
           [ 0.33306527,  0.30725718,  0.2846775 , ...,  0.35040367,
             0.34435558,  0.34112835],
           ...,
           [-0.1056456 , -0.12661296, -0.13790333, ..., -0.08024192,
            -0.09354854, -0.11290336],
           [-0.07903278, -0.08870995, -0.09435463, ..., -0.08266127,
            -0.08064544, -0.07741928],
           [-0.0576601 , -0.03749967, -0.02540326, ..., -0.07540298,
            -0.06532216, -0.06693745]], shape=(73, 144), dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>vwnd</span></div><div class='xr-var-dims'>(lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.1734 0.1815 ... 0.2234 0.2137</div><input id='attrs-c9e73c0c-e451-4658-abd3-79774f5fd622' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-c9e73c0c-e451-4658-abd3-79774f5fd622' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-299689dc-98b5-4cf8-83b0-acd946770504' class='xr-var-data-in' type='checkbox'><label for='data-299689dc-98b5-4cf8-83b0-acd946770504' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Monthly mean v wind</dd><dt><span>units :</span></dt><dd>m/s</dd><dt><span>precision :</span></dt><dd>2</dd><dt><span>var_desc :</span></dt><dd>v-wind</dd><dt><span>level_desc :</span></dt><dd>Pressure Levels</dd><dt><span>statistic :</span></dt><dd>Mean</dd><dt><span>parent_stat :</span></dt><dd>Other</dd><dt><span>dataset :</span></dt><dd>NCEP Reanalysis Derived Products</dd><dt><span>actual_range :</span></dt><dd>[-68.57001  68.56999]</dd></dl></div><div class='xr-var-data'><pre>array([[ 0.17338598,  0.1814518 ,  0.18951654, ...,  0.15846789,
             0.1677419 ,  0.17258167],
           [ 0.1516118 ,  0.16128993,  0.18346763, ...,  0.08145142,
             0.09516072,  0.10322666],
           [ 0.1903243 ,  0.24516177,  0.28387117, ...,  0.06572509,
             0.11209702,  0.16209793],
           ...,
           [-0.02338713, -0.00887108,  0.00120991, ..., -0.0399195 ,
            -0.03588688, -0.02540255],
           [ 0.10685444,  0.11249995,  0.11653227, ...,  0.09112895,
             0.09274191,  0.10564566],
           [ 0.22661296,  0.22983876,  0.2318549 , ...,  0.2217744 ,
             0.22338712,  0.21370983]], shape=(73, 144), dtype=float32)</pre></div></li></ul></div></li></ul></div></div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 115-119

However, if one is required to solve for the gradient of the zonal wind with respect to the corresponding distance at each longitude, the function `calc_lon_gradient` should be used to calculate.

.. math::
  \frac{\partial F}{\partial x} = \frac{1}{R \cos\varphi} \cdot \frac{\partial F}{\partial \lambda}

.. GENERATED FROM PYTHON SOURCE LINES 119-138

.. code-block:: Python


    uwnd_dlon = ecl.calc_lon_gradient(uvdata_500_202201.uwnd, lon_dim="lon", lat_dim="lat")

    fig, ax = plt.subplots(
        subplot_kw={"projection": ccrs.PlateCarree(central_longitude=180)}
    )

    ax.gridlines(draw_labels=["bottom", "left"], color="grey", alpha=0.5, linestyle="--")
    ax.coastlines(edgecolor="black", linewidths=0.5)

    uwnd_dlon.plot.contourf(
        ax=ax,
        # projection on data
        transform=ccrs.PlateCarree(),
        # Colorbar is placed at the bottom
        cbar_kwargs={"location": "bottom"},
        levels=21,
    )




.. image-sg:: /auto_gallery/images/sphx_glr_plot_geographic_finite_difference_003.png
   :alt: time = 2022-01-01, level = 500.0 [millibar]
   :srcset: /auto_gallery/images/sphx_glr_plot_geographic_finite_difference_003.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    <cartopy.mpl.contour.GeoContourSet object at 0x7ff420f48a90>



.. GENERATED FROM PYTHON SOURCE LINES 139-140

Similarly, use :py:func:`easyclimate.calc_lat_gradient <easyclimate.calc_lat_gradient>` to solve for the gradient of the meridional wind with respect to the corresponding distance at each latitude.

.. GENERATED FROM PYTHON SOURCE LINES 142-151

Second-order Partial Derivative
------------------------------------

The solution of the second-order partial derivative relies on three functional calculations

- :py:func:`easyclimate.calc_lon_laplacian <easyclimate.calc_lon_laplacian>`: calculation of the second-order partial derivative term (Laplace term) along longitude.

.. math::
  \frac{\partial^2 F}{\partial x^2} = \frac{1}{(R \cos\varphi)^2} \cdot \frac{\partial^2 F}{\partial \lambda^2}

.. GENERATED FROM PYTHON SOURCE LINES 151-156

.. code-block:: Python


    uwnd_dlon2 = ecl.calc_lon_laplacian(
        uvdata_500_202201.uwnd, lon_dim="lon", lat_dim="lat"
    )








.. GENERATED FROM PYTHON SOURCE LINES 157-161

- :py:func:`easyclimate.calc_lat_laplacian <easyclimate.calc_lat_laplacian>`: calculation of the second-order partial derivative term (Laplace term) along latitude.

.. math::
  \frac{\partial^2 F}{\partial y^2} = \frac{1}{R^2} \cdot \frac{\partial^2 F}{\partial \varphi^2}

.. GENERATED FROM PYTHON SOURCE LINES 162-165

.. code-block:: Python


    uwnd_dlat2 = ecl.calc_lat_laplacian(uvdata_500_202201.uwnd, lat_dim="lat")








.. GENERATED FROM PYTHON SOURCE LINES 166-171

- :py:func:`easyclimate.calc_lon_lat_mixed_derivatives <easyclimate.calc_lon_lat_mixed_derivatives>`: second-order mixed partial derivative terms along longitude and latitude.

.. math::
  \frac{\partial^2 F}{\partial x \partial y} = \frac{1}{R^2 \cos\varphi} \cdot \frac{\partial^2 F}{\partial \lambda \partial \varphi}


.. GENERATED FROM PYTHON SOURCE LINES 172-177

.. code-block:: Python


    uwnd_dlonlat = ecl.calc_lon_lat_mixed_derivatives(
        uvdata_500_202201.uwnd, lon_dim="lon", lat_dim="lat"
    )








.. GENERATED FROM PYTHON SOURCE LINES 178-179

Second-order partial derivative term along longitude.

.. GENERATED FROM PYTHON SOURCE LINES 179-192

.. code-block:: Python


    fig, ax = plt.subplots(
        subplot_kw={"projection": ccrs.PlateCarree(central_longitude=180)}
    )

    ax.gridlines(draw_labels=["bottom", "left"], color="grey", alpha=0.5, linestyle="--")
    ax.coastlines(edgecolor="black", linewidths=0.5)

    uwnd_dlon2.plot.contourf(
        ax=ax, transform=ccrs.PlateCarree(), cbar_kwargs={"location": "bottom"}, levels=21
    )
    ax.set_title("$\\frac{\\partial^2 F}{\\partial x^2}$", fontsize=20)




.. image-sg:: /auto_gallery/images/sphx_glr_plot_geographic_finite_difference_004.png
   :alt: $\frac{\partial^2 F}{\partial x^2}$
   :srcset: /auto_gallery/images/sphx_glr_plot_geographic_finite_difference_004.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    Text(0.5, 1.0326797365031362, '$\\frac{\\partial^2 F}{\\partial x^2}$')



.. GENERATED FROM PYTHON SOURCE LINES 193-194

Second-order partial derivative term along latitude.

.. GENERATED FROM PYTHON SOURCE LINES 194-207

.. code-block:: Python


    fig, ax = plt.subplots(
        subplot_kw={"projection": ccrs.PlateCarree(central_longitude=180)}
    )

    ax.gridlines(draw_labels=["bottom", "left"], color="grey", alpha=0.5, linestyle="--")
    ax.coastlines(edgecolor="black", linewidths=0.5)

    uwnd_dlat2.plot.contourf(
        ax=ax, transform=ccrs.PlateCarree(), cbar_kwargs={"location": "bottom"}, levels=21
    )
    ax.set_title("$\\frac{\\partial^2 F}{\\partial y^2}$", fontsize=20)




.. image-sg:: /auto_gallery/images/sphx_glr_plot_geographic_finite_difference_005.png
   :alt: $\frac{\partial^2 F}{\partial y^2}$
   :srcset: /auto_gallery/images/sphx_glr_plot_geographic_finite_difference_005.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    Text(0.5, 1.048071096550179, '$\\frac{\\partial^2 F}{\\partial y^2}$')



.. GENERATED FROM PYTHON SOURCE LINES 208-209

Second-order mixed partial derivative terms along longitude and latitude.

.. GENERATED FROM PYTHON SOURCE LINES 209-222

.. code-block:: Python


    fig, ax = plt.subplots(
        subplot_kw={"projection": ccrs.PlateCarree(central_longitude=180)}
    )

    ax.gridlines(draw_labels=["bottom", "left"], color="grey", alpha=0.5, linestyle="--")
    ax.coastlines(edgecolor="black", linewidths=0.5)

    uwnd_dlonlat.plot.contourf(
        ax=ax, transform=ccrs.PlateCarree(), cbar_kwargs={"location": "bottom"}, levels=21
    )
    ax.set_title("$\\frac{\\partial^2 F}{\\partial x \\partial y}$", fontsize=20)




.. image-sg:: /auto_gallery/images/sphx_glr_plot_geographic_finite_difference_006.png
   :alt: $\frac{\partial^2 F}{\partial x \partial y}$
   :srcset: /auto_gallery/images/sphx_glr_plot_geographic_finite_difference_006.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    Text(0.5, 1.02873053875448, '$\\frac{\\partial^2 F}{\\partial x \\partial y}$')



.. GENERATED FROM PYTHON SOURCE LINES 223-233

Vorticity and Divergence
------------------------------------

Vorticity and divergence are measures of the degree of atmospheric rotation and volumetric flux per unit volume respectively. For vorticity and divergence in the quasi-geostrophic case, the potential height is used as input data for the calculations. In general, we first calculate the quasi-geostrophic wind.

- :py:func:`easyclimate.calc_geostrophic_wind <easyclimate.calc_geostrophic_wind>`: calculate the geostrophic wind.

.. math::
  u_g = - \frac{g}{f} \frac{\partial H}{\partial y}, \ v_g = \frac{g}{f} \frac{\partial H}{\partial x}


.. GENERATED FROM PYTHON SOURCE LINES 233-238

.. code-block:: Python


    geostrophic_wind_data_500_202201 = ecl.calc_geostrophic_wind(
        z_data_500_202201, lon_dim="lon", lat_dim="lat"
    )








.. GENERATED FROM PYTHON SOURCE LINES 239-247

The function :py:func:`easyclimate.calc_vorticity <easyclimate.calc_vorticity>` is then used to compute the quasi-geostrophic vorticity.

- :py:func:`easyclimate.calc_vorticity <easyclimate.calc_vorticity>`: calculate the horizontal relative vorticity term.

.. math::

  \zeta = \frac{\partial v}{\partial x} - \frac{\partial u}{\partial y} + \frac{u}{R} \tan \varphi


.. GENERATED FROM PYTHON SOURCE LINES 247-257

.. code-block:: Python


    qg_vor_data_500_202201 = ecl.calc_vorticity(
        u_data=geostrophic_wind_data_500_202201.ug,
        v_data=geostrophic_wind_data_500_202201.vg,
        lon_dim="lon",
        lat_dim="lat",
    )

    qg_vor_data_500_202201.sel(lat=slice(20, 80)).plot.contourf(levels=21)




.. image-sg:: /auto_gallery/images/sphx_glr_plot_geographic_finite_difference_007.png
   :alt: time = 2022-01-01, level = 500.0 [millibar]
   :srcset: /auto_gallery/images/sphx_glr_plot_geographic_finite_difference_007.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    <matplotlib.contour.QuadContourSet object at 0x7ff422413350>



.. GENERATED FROM PYTHON SOURCE LINES 258-259

Similar vorticity for actual winds, but for actual winds rather than quasi-geostrophic winds.

.. GENERATED FROM PYTHON SOURCE LINES 259-269

.. code-block:: Python


    vor_data_500_202201 = ecl.calc_vorticity(
        u_data=uvdata_500_202201["uwnd"],
        v_data=uvdata_500_202201["vwnd"],
        lon_dim="lon",
        lat_dim="lat",
    )

    vor_data_500_202201.sel(lat=slice(20, 80)).plot.contourf(levels=21)




.. image-sg:: /auto_gallery/images/sphx_glr_plot_geographic_finite_difference_008.png
   :alt: time = 2022-01-01, level = 500.0 [millibar]
   :srcset: /auto_gallery/images/sphx_glr_plot_geographic_finite_difference_008.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    <matplotlib.contour.QuadContourSet object at 0x7ff4212d5b10>



.. GENERATED FROM PYTHON SOURCE LINES 270-279

In addition, the function :py:func:`easyclimate.calc_divergence <easyclimate.calc_divergence>` calculate the quasi-geostrophic divergence.

.. math::

  \mathrm{D} = \frac{\partial u}{\partial x} + \frac{\partial v}{\partial y} - \frac{v}{R} \tan \varphi

- :py:func:`easyclimate.calc_divergence <easyclimate.calc_divergence>`: calculate the horizontal divergence term.

Quasi-geostrophic divergence

.. GENERATED FROM PYTHON SOURCE LINES 279-289

.. code-block:: Python


    qg_div_data_500_202201 = ecl.calc_divergence(
        u_data=geostrophic_wind_data_500_202201.ug,
        v_data=geostrophic_wind_data_500_202201.vg,
        lon_dim="lon",
        lat_dim="lat",
    )

    qg_div_data_500_202201.sel(lat=slice(20, 80)).plot.contourf(levels=21)




.. image-sg:: /auto_gallery/images/sphx_glr_plot_geographic_finite_difference_009.png
   :alt: time = 2022-01-01, level = 500.0 [millibar]
   :srcset: /auto_gallery/images/sphx_glr_plot_geographic_finite_difference_009.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    <matplotlib.contour.QuadContourSet object at 0x7ff4214d9210>



.. GENERATED FROM PYTHON SOURCE LINES 290-291

Actual divergence

.. GENERATED FROM PYTHON SOURCE LINES 291-301

.. code-block:: Python


    div_data_500_202201 = ecl.calc_divergence(
        u_data=uvdata_500_202201["uwnd"],
        v_data=uvdata_500_202201["vwnd"],
        lon_dim="lon",
        lat_dim="lat",
    )

    div_data_500_202201.sel(lat=slice(20, 80)).plot.contourf(levels=21)




.. image-sg:: /auto_gallery/images/sphx_glr_plot_geographic_finite_difference_010.png
   :alt: time = 2022-01-01, level = 500.0 [millibar]
   :srcset: /auto_gallery/images/sphx_glr_plot_geographic_finite_difference_010.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    <matplotlib.contour.QuadContourSet object at 0x7ff4214306d0>



.. GENERATED FROM PYTHON SOURCE LINES 302-306

Of course, in addition to the built-in finite difference method, the spherical harmonic function mothod can be solved, but you must ensure that it is **Global** and **Regular or Gaussian grid** type data.

- :py:func:`easyclimate.windspharm.calc_relative_vorticity <easyclimate.windspharm.calc_relative_vorticity>`: calculate the relative vorticity term with the spherical harmonic function mothod.
- :py:func:`easyclimate.windspharm.calc_divergence <easyclimate.windspharm.calc_divergence>`: calculate the horizontal divergence term with the spherical harmonic function mothod.

.. GENERATED FROM PYTHON SOURCE LINES 306-316

.. code-block:: Python


    vor_data_500_202201_windspharm = ecl.windspharm.calc_relative_vorticity(
        u_data=uvdata_500_202201["uwnd"],
        v_data=uvdata_500_202201["vwnd"],
    )

    vor_data_500_202201_windspharm.sortby("lat").sel(lat=slice(20, 80)).plot.contourf(
        levels=21
    )




.. image-sg:: /auto_gallery/images/sphx_glr_plot_geographic_finite_difference_011.png
   :alt: plot geographic finite difference
   :srcset: /auto_gallery/images/sphx_glr_plot_geographic_finite_difference_011.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    <matplotlib.contour.QuadContourSet object at 0x7ff422636350>



.. GENERATED FROM PYTHON SOURCE LINES 317-327

.. code-block:: Python


    div_data_500_202201_windspharm = ecl.windspharm.calc_divergence(
        u_data=uvdata_500_202201["uwnd"],
        v_data=uvdata_500_202201["vwnd"],
    )

    div_data_500_202201_windspharm.sortby("lat").sel(lat=slice(20, 80)).plot.contourf(
        levels=21
    )




.. image-sg:: /auto_gallery/images/sphx_glr_plot_geographic_finite_difference_012.png
   :alt: plot geographic finite difference
   :srcset: /auto_gallery/images/sphx_glr_plot_geographic_finite_difference_012.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    <matplotlib.contour.QuadContourSet object at 0x7ff420ac4f10>



.. GENERATED FROM PYTHON SOURCE LINES 328-329

Generally speaking, the calculation results of the finite difference method and the spherical harmonic function method are similar. The former does not require global regional data, but the calculation results of the latter are more accurate for high latitude regions.

.. GENERATED FROM PYTHON SOURCE LINES 331-341

Advection
-------------------
`Advection <https://glossary.ametsoc.org/wiki/Advection>`__ is the process of transport of an atmospheric property solely by the mass motion (velocity field) of the atmosphere; also, the rate of change of the value of the advected property at a given point.

For zonal advection, we can calculate as follows.

.. math::

  -u \frac{\partial T}{\partial x}


.. GENERATED FROM PYTHON SOURCE LINES 341-348

.. code-block:: Python


    u_advection_500_202201 = ecl.calc_u_advection(
        u_data=uvdata_500_202201["uwnd"], temper_data=temp_data_500_202201
    )

    u_advection_500_202201.sortby("lat").sel(lat=slice(20, 80)).plot.contourf(levels=21)




.. image-sg:: /auto_gallery/images/sphx_glr_plot_geographic_finite_difference_013.png
   :alt: time = 2022-01-01, level = 500.0 [millibar]
   :srcset: /auto_gallery/images/sphx_glr_plot_geographic_finite_difference_013.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    <matplotlib.contour.QuadContourSet object at 0x7ff42136c710>



.. GENERATED FROM PYTHON SOURCE LINES 349-355

Similarly, the meridional advection can acquire as follows.

.. math::

  -v \frac{\partial T}{\partial y}


.. GENERATED FROM PYTHON SOURCE LINES 355-362

.. code-block:: Python


    v_advection_500_202201 = ecl.calc_v_advection(
        v_data=uvdata_500_202201["vwnd"], temper_data=temp_data_500_202201
    )

    v_advection_500_202201.sortby("lat").sel(lat=slice(20, 80)).plot.contourf(levels=21)




.. image-sg:: /auto_gallery/images/sphx_glr_plot_geographic_finite_difference_014.png
   :alt: time = 2022-01-01, level = 500.0 [millibar]
   :srcset: /auto_gallery/images/sphx_glr_plot_geographic_finite_difference_014.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    <matplotlib.contour.QuadContourSet object at 0x7ff4208c61d0>



.. GENERATED FROM PYTHON SOURCE LINES 363-380

Water Flux
-------------------------

- :py:func:`easyclimate.calc_horizontal_water_flux <easyclimate.calc_horizontal_water_flux>`: calculate horizontal water vapor flux at each vertical level.

.. math::

  \frac{1}{g} q \mathbf{V} = \frac{1}{g} (u q\ \mathbf{i} + vq\ \mathbf{j})

- :py:func:`easyclimate.calc_vertical_water_flux <easyclimate.calc_vertical_water_flux>`: calculate vertical water vapor flux.

.. math::
  -\omega \frac{q}{g}

- :py:func:`easyclimate.calc_water_flux_top2surface_integral <easyclimate.calc_water_flux_top2surface_integral>`: calculate the water vapor flux across the vertical level.

:py:func:`easyclimate.calc_horizontal_water_flux <easyclimate.calc_horizontal_water_flux>` can calculate the horizontal water flux of single layers.

.. GENERATED FROM PYTHON SOURCE LINES 380-387

.. code-block:: Python


    ecl.calc_horizontal_water_flux(
        specific_humidity_data=q_data,
        u_data=uvdata.uwnd,
        v_data=uvdata.vwnd,
    )






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
    <defs>
    <symbol id="icon-database" viewBox="0 0 32 32">
    <path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
    <path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    <path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    </symbol>
    <symbol id="icon-file-text2" viewBox="0 0 32 32">
    <path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
    <path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    </symbol>
    </defs>
    </svg>
    <style>/* CSS stylesheet for displaying xarray objects in notebooks */

    :root {
      --xr-font-color0: var(
        --jp-content-font-color0,
        var(--pst-color-text-base rgba(0, 0, 0, 1))
      );
      --xr-font-color2: var(
        --jp-content-font-color2,
        var(--pst-color-text-base, rgba(0, 0, 0, 0.54))
      );
      --xr-font-color3: var(
        --jp-content-font-color3,
        var(--pst-color-text-base, rgba(0, 0, 0, 0.38))
      );
      --xr-border-color: var(
        --jp-border-color2,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 10))
      );
      --xr-disabled-color: var(
        --jp-layout-color3,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 40))
      );
      --xr-background-color: var(
        --jp-layout-color0,
        var(--pst-color-on-background, white)
      );
      --xr-background-color-row-even: var(
        --jp-layout-color1,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 5))
      );
      --xr-background-color-row-odd: var(
        --jp-layout-color2,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 15))
      );
    }

    html[theme="dark"],
    html[data-theme="dark"],
    body[data-theme="dark"],
    body.vscode-dark {
      --xr-font-color0: var(
        --jp-content-font-color0,
        var(--pst-color-text-base, rgba(255, 255, 255, 1))
      );
      --xr-font-color2: var(
        --jp-content-font-color2,
        var(--pst-color-text-base, rgba(255, 255, 255, 0.54))
      );
      --xr-font-color3: var(
        --jp-content-font-color3,
        var(--pst-color-text-base, rgba(255, 255, 255, 0.38))
      );
      --xr-border-color: var(
        --jp-border-color2,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))
      );
      --xr-disabled-color: var(
        --jp-layout-color3,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))
      );
      --xr-background-color: var(
        --jp-layout-color0,
        var(--pst-color-on-background, #111111)
      );
      --xr-background-color-row-even: var(
        --jp-layout-color1,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))
      );
      --xr-background-color-row-odd: var(
        --jp-layout-color2,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))
      );
    }

    .xr-wrap {
      display: block !important;
      min-width: 300px;
      max-width: 700px;
      line-height: 1.6;
    }

    .xr-text-repr-fallback {
      /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
      display: none;
    }

    .xr-header {
      padding-top: 6px;
      padding-bottom: 6px;
      margin-bottom: 4px;
      border-bottom: solid 1px var(--xr-border-color);
    }

    .xr-header > div,
    .xr-header > ul {
      display: inline;
      margin-top: 0;
      margin-bottom: 0;
    }

    .xr-obj-type,
    .xr-obj-name,
    .xr-group-name {
      margin-left: 2px;
      margin-right: 10px;
    }

    .xr-group-name::before {
      content: "📁";
      padding-right: 0.3em;
    }

    .xr-group-name,
    .xr-obj-type {
      color: var(--xr-font-color2);
    }

    .xr-sections {
      padding-left: 0 !important;
      display: grid;
      grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
      margin-block-start: 0;
      margin-block-end: 0;
    }

    .xr-section-item {
      display: contents;
    }

    .xr-section-item input {
      display: inline-block;
      opacity: 0;
      height: 0;
      margin: 0;
    }

    .xr-section-item input + label {
      color: var(--xr-disabled-color);
      border: 2px solid transparent !important;
    }

    .xr-section-item input:enabled + label {
      cursor: pointer;
      color: var(--xr-font-color2);
    }

    .xr-section-item input:focus + label {
      border: 2px solid var(--xr-font-color0) !important;
    }

    .xr-section-item input:enabled + label:hover {
      color: var(--xr-font-color0);
    }

    .xr-section-summary {
      grid-column: 1;
      color: var(--xr-font-color2);
      font-weight: 500;
    }

    .xr-section-summary > span {
      display: inline-block;
      padding-left: 0.5em;
    }

    .xr-section-summary-in:disabled + label {
      color: var(--xr-font-color2);
    }

    .xr-section-summary-in + label:before {
      display: inline-block;
      content: "►";
      font-size: 11px;
      width: 15px;
      text-align: center;
    }

    .xr-section-summary-in:disabled + label:before {
      color: var(--xr-disabled-color);
    }

    .xr-section-summary-in:checked + label:before {
      content: "▼";
    }

    .xr-section-summary-in:checked + label > span {
      display: none;
    }

    .xr-section-summary,
    .xr-section-inline-details {
      padding-top: 4px;
    }

    .xr-section-inline-details {
      grid-column: 2 / -1;
    }

    .xr-section-details {
      display: none;
      grid-column: 1 / -1;
      margin-top: 4px;
      margin-bottom: 5px;
    }

    .xr-section-summary-in:checked ~ .xr-section-details {
      display: contents;
    }

    .xr-group-box {
      display: inline-grid;
      grid-template-columns: 0px 20px auto;
      width: 100%;
    }

    .xr-group-box-vline {
      grid-column-start: 1;
      border-right: 0.2em solid;
      border-color: var(--xr-border-color);
      width: 0px;
    }

    .xr-group-box-hline {
      grid-column-start: 2;
      grid-row-start: 1;
      height: 1em;
      width: 20px;
      border-bottom: 0.2em solid;
      border-color: var(--xr-border-color);
    }

    .xr-group-box-contents {
      grid-column-start: 3;
    }

    .xr-array-wrap {
      grid-column: 1 / -1;
      display: grid;
      grid-template-columns: 20px auto;
    }

    .xr-array-wrap > label {
      grid-column: 1;
      vertical-align: top;
    }

    .xr-preview {
      color: var(--xr-font-color3);
    }

    .xr-array-preview,
    .xr-array-data {
      padding: 0 5px !important;
      grid-column: 2;
    }

    .xr-array-data,
    .xr-array-in:checked ~ .xr-array-preview {
      display: none;
    }

    .xr-array-in:checked ~ .xr-array-data,
    .xr-array-preview {
      display: inline-block;
    }

    .xr-dim-list {
      display: inline-block !important;
      list-style: none;
      padding: 0 !important;
      margin: 0;
    }

    .xr-dim-list li {
      display: inline-block;
      padding: 0;
      margin: 0;
    }

    .xr-dim-list:before {
      content: "(";
    }

    .xr-dim-list:after {
      content: ")";
    }

    .xr-dim-list li:not(:last-child):after {
      content: ",";
      padding-right: 5px;
    }

    .xr-has-index {
      font-weight: bold;
    }

    .xr-var-list,
    .xr-var-item {
      display: contents;
    }

    .xr-var-item > div,
    .xr-var-item label,
    .xr-var-item > .xr-var-name span {
      background-color: var(--xr-background-color-row-even);
      border-color: var(--xr-background-color-row-odd);
      margin-bottom: 0;
      padding-top: 2px;
    }

    .xr-var-item > .xr-var-name:hover span {
      padding-right: 5px;
    }

    .xr-var-list > li:nth-child(odd) > div,
    .xr-var-list > li:nth-child(odd) > label,
    .xr-var-list > li:nth-child(odd) > .xr-var-name span {
      background-color: var(--xr-background-color-row-odd);
      border-color: var(--xr-background-color-row-even);
    }

    .xr-var-name {
      grid-column: 1;
    }

    .xr-var-dims {
      grid-column: 2;
    }

    .xr-var-dtype {
      grid-column: 3;
      text-align: right;
      color: var(--xr-font-color2);
    }

    .xr-var-preview {
      grid-column: 4;
    }

    .xr-index-preview {
      grid-column: 2 / 5;
      color: var(--xr-font-color2);
    }

    .xr-var-name,
    .xr-var-dims,
    .xr-var-dtype,
    .xr-preview,
    .xr-attrs dt {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      padding-right: 10px;
    }

    .xr-var-name:hover,
    .xr-var-dims:hover,
    .xr-var-dtype:hover,
    .xr-attrs dt:hover {
      overflow: visible;
      width: auto;
      z-index: 1;
    }

    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      display: none;
      border-top: 2px dotted var(--xr-background-color);
      padding-bottom: 20px !important;
      padding-top: 10px !important;
    }

    .xr-var-attrs-in + label,
    .xr-var-data-in + label,
    .xr-index-data-in + label {
      padding: 0 1px;
    }

    .xr-var-attrs-in:checked ~ .xr-var-attrs,
    .xr-var-data-in:checked ~ .xr-var-data,
    .xr-index-data-in:checked ~ .xr-index-data {
      display: block;
    }

    .xr-var-data > table {
      float: right;
    }

    .xr-var-data > pre,
    .xr-index-data > pre,
    .xr-var-data > table > tbody > tr {
      background-color: transparent !important;
    }

    .xr-var-name span,
    .xr-var-data,
    .xr-index-name div,
    .xr-index-data,
    .xr-attrs {
      padding-left: 25px !important;
    }

    .xr-attrs,
    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      grid-column: 1 / -1;
    }

    dl.xr-attrs {
      padding: 0;
      margin: 0;
      display: grid;
      grid-template-columns: 125px auto;
    }

    .xr-attrs dt,
    .xr-attrs dd {
      padding: 0;
      margin: 0;
      float: left;
      padding-right: 10px;
      width: auto;
    }

    .xr-attrs dt {
      font-weight: normal;
      grid-column: 1;
    }

    .xr-attrs dt:hover span {
      display: inline-block;
      background: var(--xr-background-color);
      padding-right: 10px;
    }

    .xr-attrs dd {
      grid-column: 2;
      white-space: pre-wrap;
      word-break: break-all;
    }

    .xr-icon-database,
    .xr-icon-file-text2,
    .xr-no-icon {
      display: inline-block;
      vertical-align: middle;
      width: 1em;
      height: 1.5em !important;
      stroke-width: 0;
      stroke: currentColor;
      fill: currentColor;
    }

    .xr-var-attrs-in:checked + label > .xr-icon-file-text2,
    .xr-var-data-in:checked + label > .xr-icon-database,
    .xr-index-data-in:checked + label > .xr-icon-database {
      color: var(--xr-font-color0);
      filter: drop-shadow(1px 1px 5px var(--xr-font-color2));
      stroke-width: 0.8px;
    }
    </style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 1MB
    Dimensions:  (time: 2, lon: 144, lat: 73, level: 8)
    Coordinates:
      * time     (time) datetime64[ns] 16B 2022-01-01 2022-02-01
      * lon      (lon) float32 576B 0.0 2.5 5.0 7.5 10.0 ... 350.0 352.5 355.0 357.5
      * lat      (lat) float32 292B -90.0 -87.5 -85.0 -82.5 ... 82.5 85.0 87.5 90.0
      * level    (level) float32 32B 1e+03 925.0 850.0 700.0 600.0 500.0 400.0 300.0
    Data variables:
        qu       (time, level, lat, lon) float32 673kB 0.3579 0.3982 ... -0.007047
        qv       (time, level, lat, lon) float32 673kB -0.9287 -0.9122 ... 0.001194</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-592a0274-1be0-45ca-8602-81dc1413c4d8' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-592a0274-1be0-45ca-8602-81dc1413c4d8' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 2</li><li><span class='xr-has-index'>lon</span>: 144</li><li><span class='xr-has-index'>lat</span>: 73</li><li><span class='xr-has-index'>level</span>: 8</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-0bb0b65e-2e2d-4f26-9e8f-67ad8d5d9bd7' class='xr-section-summary-in' type='checkbox'  checked><label for='section-0bb0b65e-2e2d-4f26-9e8f-67ad8d5d9bd7' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2022-01-01 2022-02-01</div><input id='attrs-0a8c9a41-59e7-4549-a85e-a27fe29b958d' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-0a8c9a41-59e7-4549-a85e-a27fe29b958d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e1be900f-f474-4f90-a2d2-110e94e07066' class='xr-var-data-in' type='checkbox'><label for='data-e1be900f-f474-4f90-a2d2-110e94e07066' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>time</dd><dt><span>long_name :</span></dt><dd>Time</dd><dt><span>axis :</span></dt><dd>T</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;2022-01-01T00:00:00.000000000&#x27;, &#x27;2022-02-01T00:00:00.000000000&#x27;],
          dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.0 2.5 5.0 ... 352.5 355.0 357.5</div><input id='attrs-47c4bd3e-c87d-4327-8cdf-fa482b8e83db' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-47c4bd3e-c87d-4327-8cdf-fa482b8e83db' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-196e66d5-7a70-4b06-9325-1addeb0848f4' class='xr-var-data-in' type='checkbox'><label for='data-196e66d5-7a70-4b06-9325-1addeb0848f4' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>long_name :</span></dt><dd>Longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>axis :</span></dt><dd>X</dd></dl></div><div class='xr-var-data'><pre>array([  0. ,   2.5,   5. ,   7.5,  10. ,  12.5,  15. ,  17.5,  20. ,  22.5,
            25. ,  27.5,  30. ,  32.5,  35. ,  37.5,  40. ,  42.5,  45. ,  47.5,
            50. ,  52.5,  55. ,  57.5,  60. ,  62.5,  65. ,  67.5,  70. ,  72.5,
            75. ,  77.5,  80. ,  82.5,  85. ,  87.5,  90. ,  92.5,  95. ,  97.5,
           100. , 102.5, 105. , 107.5, 110. , 112.5, 115. , 117.5, 120. , 122.5,
           125. , 127.5, 130. , 132.5, 135. , 137.5, 140. , 142.5, 145. , 147.5,
           150. , 152.5, 155. , 157.5, 160. , 162.5, 165. , 167.5, 170. , 172.5,
           175. , 177.5, 180. , 182.5, 185. , 187.5, 190. , 192.5, 195. , 197.5,
           200. , 202.5, 205. , 207.5, 210. , 212.5, 215. , 217.5, 220. , 222.5,
           225. , 227.5, 230. , 232.5, 235. , 237.5, 240. , 242.5, 245. , 247.5,
           250. , 252.5, 255. , 257.5, 260. , 262.5, 265. , 267.5, 270. , 272.5,
           275. , 277.5, 280. , 282.5, 285. , 287.5, 290. , 292.5, 295. , 297.5,
           300. , 302.5, 305. , 307.5, 310. , 312.5, 315. , 317.5, 320. , 322.5,
           325. , 327.5, 330. , 332.5, 335. , 337.5, 340. , 342.5, 345. , 347.5,
           350. , 352.5, 355. , 357.5], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-90.0 -87.5 -85.0 ... 87.5 90.0</div><input id='attrs-d5d15b0d-421b-4732-89e3-9d2e40d36d9d' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-d5d15b0d-421b-4732-89e3-9d2e40d36d9d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2e22632e-0697-4ee9-8493-fb5101645499' class='xr-var-data-in' type='checkbox'><label for='data-2e22632e-0697-4ee9-8493-fb5101645499' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>long_name :</span></dt><dd>Latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>axis :</span></dt><dd>Y</dd></dl></div><div class='xr-var-data'><pre>array([-90. , -87.5, -85. , -82.5, -80. , -77.5, -75. , -72.5, -70. , -67.5,
           -65. , -62.5, -60. , -57.5, -55. , -52.5, -50. , -47.5, -45. , -42.5,
           -40. , -37.5, -35. , -32.5, -30. , -27.5, -25. , -22.5, -20. , -17.5,
           -15. , -12.5, -10. ,  -7.5,  -5. ,  -2.5,   0. ,   2.5,   5. ,   7.5,
            10. ,  12.5,  15. ,  17.5,  20. ,  22.5,  25. ,  27.5,  30. ,  32.5,
            35. ,  37.5,  40. ,  42.5,  45. ,  47.5,  50. ,  52.5,  55. ,  57.5,
            60. ,  62.5,  65. ,  67.5,  70. ,  72.5,  75. ,  77.5,  80. ,  82.5,
            85. ,  87.5,  90. ], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>level</span></div><div class='xr-var-dims'>(level)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>1e+03 925.0 850.0 ... 400.0 300.0</div><input id='attrs-917c9766-8278-4d9c-8e8c-15204e941474' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-917c9766-8278-4d9c-8e8c-15204e941474' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-24ff78b1-576b-47e6-83ee-3f7256f69bdf' class='xr-var-data-in' type='checkbox'><label for='data-24ff78b1-576b-47e6-83ee-3f7256f69bdf' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>air_pressure</dd><dt><span>long_name :</span></dt><dd>Level</dd><dt><span>units :</span></dt><dd>millibar</dd><dt><span>positive :</span></dt><dd>down</dd><dt><span>axis :</span></dt><dd>Z</dd><dt><span>GRIB_id :</span></dt><dd>100</dd><dt><span>GRIB_name :</span></dt><dd>hPa</dd><dt><span>actual_range :</span></dt><dd>[1000.  300.]</dd></dl></div><div class='xr-var-data'><pre>array([1000.,  925.,  850.,  700.,  600.,  500.,  400.,  300.], dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-56db175a-a8e7-4827-8ad7-ff56f3b9c367' class='xr-section-summary-in' type='checkbox'  checked><label for='section-56db175a-a8e7-4827-8ad7-ff56f3b9c367' class='xr-section-summary' >Data variables: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>qu</span></div><div class='xr-var-dims'>(time, level, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.3579 0.3982 ... -0.007047</div><input id='attrs-4f871efc-8fca-4761-8dfa-edab51458bda' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-4f871efc-8fca-4761-8dfa-edab51458bda' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-418a65e7-18c7-4bb7-bc03-797b936723dc' class='xr-var-data-in' type='checkbox'><label for='data-418a65e7-18c7-4bb7-bc03-797b936723dc' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Monthly Mean of Specific Humidity</dd><dt><span>units :</span></dt><dd>grams/kg</dd><dt><span>precision :</span></dt><dd>3</dd><dt><span>var_desc :</span></dt><dd>Specific Humidity</dd><dt><span>level_desc :</span></dt><dd>Pressure Levels</dd><dt><span>statistic :</span></dt><dd>Mean</dd><dt><span>parent_stat :</span></dt><dd>Other</dd><dt><span>dataset :</span></dt><dd>NCEP Reanalysis Derived Products</dd><dt><span>actual_range :</span></dt><dd>[ 0.      34.88718]</dd></dl></div><div class='xr-var-data'><pre>array([[[[ 3.57883036e-01,  3.98152560e-01,  4.38422114e-01, ...,
               2.34596267e-01,  2.76930898e-01,  3.16993952e-01],
             [ 6.72771037e-02,  1.20953225e-01,  1.75328195e-01, ...,
              -8.64081681e-02, -3.64194512e-02,  1.26979304e-02],
             [ 4.37529944e-02,  1.26659304e-01,  2.18098059e-01, ...,
              -1.39770165e-01, -8.91409293e-02, -2.89416406e-02],
             ...,
             [-1.29531682e-01, -1.49078846e-01, -1.68693021e-01, ...,
              -7.36974776e-02, -9.17841047e-02, -1.10312007e-01],
             [-1.70557305e-01, -1.75420001e-01, -1.79937020e-01, ...,
              -1.53795123e-01, -1.59868911e-01, -1.65068328e-01],
             [-2.19000965e-01, -2.25325063e-01, -2.31118590e-01, ...,
              -1.97861537e-01, -2.05247089e-01, -2.12588385e-01]],

            [[ 2.69623637e-01,  3.00784588e-01,  3.31781358e-01, ...,
               1.71712905e-01,  2.03857839e-01,  2.37314716e-01],
             [ 5.87694049e-02,  1.02082960e-01,  1.47941858e-01, ...,
              -6.27753958e-02, -2.28826758e-02,  1.66655779e-02],
             [ 1.21284816e-02,  7.87778050e-02,  1.51972592e-01, ...,
              -1.33276269e-01, -9.41526294e-02, -4.61209677e-02],
    ...
              -8.08279868e-03, -8.66123475e-03, -9.28526092e-03],
             [-2.21411902e-02, -2.19771210e-02, -2.17400584e-02, ...,
              -2.27421131e-02, -2.25342512e-02, -2.23478209e-02],
             [-3.46937589e-02, -3.42834592e-02, -3.38446163e-02, ...,
              -3.54394391e-02, -3.52539122e-02, -3.50005962e-02]],

            [[ 4.03247541e-03,  4.02526790e-03,  4.00544750e-03, ...,
               4.04148409e-03,  4.05770075e-03,  4.04508831e-03],
             [ 6.15896285e-03,  6.34491444e-03,  6.51857676e-03, ...,
               5.91550255e-03,  5.91961620e-03,  6.04589144e-03],
             [ 6.69910340e-03,  7.49462703e-03,  8.37483816e-03, ...,
               5.19840326e-03,  5.43986401e-03,  5.99670364e-03],
             ...,
             [-1.21538877e-03, -1.24731637e-03, -1.27466582e-03, ...,
              -1.13206636e-03, -1.16068567e-03, -1.18242716e-03],
             [-3.84470983e-03, -3.76838353e-03, -3.65987723e-03, ...,
              -4.09236364e-03, -4.01350297e-03, -3.94624844e-03],
             [-6.99382089e-03, -6.91809133e-03, -6.83114212e-03, ...,
              -7.12775113e-03, -7.09689967e-03, -7.04711350e-03]]]],
          shape=(2, 8, 73, 144), dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>qv</span></div><div class='xr-var-dims'>(time, level, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-0.9287 -0.9122 ... 0.001194</div><input id='attrs-7dbc1aa3-7bcb-4f64-83ae-9cb7f6bb12b4' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-7dbc1aa3-7bcb-4f64-83ae-9cb7f6bb12b4' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-158d6802-d259-499a-8a74-c1936df44a1e' class='xr-var-data-in' type='checkbox'><label for='data-158d6802-d259-499a-8a74-c1936df44a1e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Monthly Mean of Specific Humidity</dd><dt><span>units :</span></dt><dd>grams/kg</dd><dt><span>precision :</span></dt><dd>3</dd><dt><span>var_desc :</span></dt><dd>Specific Humidity</dd><dt><span>level_desc :</span></dt><dd>Pressure Levels</dd><dt><span>statistic :</span></dt><dd>Mean</dd><dt><span>parent_stat :</span></dt><dd>Other</dd><dt><span>dataset :</span></dt><dd>NCEP Reanalysis Derived Products</dd><dt><span>actual_range :</span></dt><dd>[ 0.      34.88718]</dd></dl></div><div class='xr-var-data'><pre>array([[[[-9.28677619e-01, -9.12156761e-01, -8.94809842e-01, ...,
              -9.67708111e-01, -9.56969738e-01, -9.43133473e-01],
             [-9.05682266e-01, -9.12177622e-01, -9.15457249e-01, ...,
              -8.71844172e-01, -8.85442317e-01, -8.97087276e-01],
             [-1.16406357e+00, -1.23160505e+00, -1.28302145e+00, ...,
              -9.03379381e-01, -9.96056259e-01, -1.08463359e+00],
             ...,
             [-1.75585821e-01, -1.76075116e-01, -1.75573900e-01, ...,
              -1.66714668e-01, -1.70317307e-01, -1.73800007e-01],
             [-1.43474877e-01, -1.36783600e-01, -1.30478472e-01, ...,
              -1.60485014e-01, -1.55592442e-01, -1.49569124e-01],
             [-1.49612337e-01, -1.39794454e-01, -1.29976541e-01, ...,
              -1.76677883e-01, -1.68230951e-01, -1.58811092e-01]],

            [[-7.31624484e-01, -7.19980180e-01, -7.05055714e-01, ...,
              -7.60817170e-01, -7.52617002e-01, -7.42776632e-01],
             [-7.17676818e-01, -7.22057879e-01, -7.23932683e-01, ...,
              -6.89850092e-01, -7.00998783e-01, -7.11117268e-01],
             [-9.35872138e-01, -9.91929948e-01, -1.03393590e+00, ...,
              -7.23102272e-01, -7.98541546e-01, -8.70113552e-01],
    ...
               4.77810623e-04,  1.04721962e-03,  1.73542392e-03],
             [ 5.91062335e-03,  6.91751717e-03,  7.89710786e-03, ...,
               2.98286392e-03,  3.95420659e-03,  4.93401149e-03],
             [ 8.17751233e-03,  9.70098283e-03,  1.11745000e-02, ...,
               3.58925620e-03,  5.12343226e-03,  6.68614730e-03]],

            [[ 2.77480227e-04,  4.50455263e-04,  6.18024555e-04, ...,
              -2.66669784e-04, -9.00913801e-05,  8.64871035e-05],
             [-2.98992149e-03, -3.02977231e-03, -3.04939901e-03, ...,
              -2.86408933e-03, -2.88517820e-03, -2.94567435e-03],
             [-3.80958477e-03, -4.45881067e-03, -5.13322232e-03, ...,
              -2.36102776e-03, -2.70353653e-03, -3.21330922e-03],
             ...,
             [ 4.35454887e-04,  5.30001416e-04,  6.31168426e-04, ...,
               1.99651506e-04,  2.70568387e-04,  3.50068934e-04],
             [ 1.03582791e-03,  1.18577783e-03,  1.31927594e-03, ...,
               5.64198184e-04,  7.26516591e-04,  8.87191389e-04],
             [ 1.50268292e-03,  1.81051216e-03,  2.10782280e-03, ...,
               5.73586614e-04,  8.84920824e-04,  1.19415275e-03]]]],
          shape=(2, 8, 73, 144), dtype=float32)</pre></div></li></ul></div></li></ul></div></div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 388-389

The whole layer integral needs to consider the function :py:func:`easyclimate.calc_water_flux_top2surface_integral <easyclimate.calc_water_flux_top2surface_integral>` to calculate.

.. GENERATED FROM PYTHON SOURCE LINES 389-402

.. code-block:: Python


    water_flux_top2surface_integral = ecl.calc_water_flux_top2surface_integral(
        specific_humidity_data=q_data,
        u_data=u_data,
        v_data=v_data,
        surface_pressure_data=msl_data,
        surface_pressure_data_units="millibars",
        vertical_dim="level",
        vertical_dim_units="hPa",
    )

    water_flux_top2surface_integral






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
    <defs>
    <symbol id="icon-database" viewBox="0 0 32 32">
    <path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
    <path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    <path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    </symbol>
    <symbol id="icon-file-text2" viewBox="0 0 32 32">
    <path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
    <path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    </symbol>
    </defs>
    </svg>
    <style>/* CSS stylesheet for displaying xarray objects in notebooks */

    :root {
      --xr-font-color0: var(
        --jp-content-font-color0,
        var(--pst-color-text-base rgba(0, 0, 0, 1))
      );
      --xr-font-color2: var(
        --jp-content-font-color2,
        var(--pst-color-text-base, rgba(0, 0, 0, 0.54))
      );
      --xr-font-color3: var(
        --jp-content-font-color3,
        var(--pst-color-text-base, rgba(0, 0, 0, 0.38))
      );
      --xr-border-color: var(
        --jp-border-color2,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 10))
      );
      --xr-disabled-color: var(
        --jp-layout-color3,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 40))
      );
      --xr-background-color: var(
        --jp-layout-color0,
        var(--pst-color-on-background, white)
      );
      --xr-background-color-row-even: var(
        --jp-layout-color1,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 5))
      );
      --xr-background-color-row-odd: var(
        --jp-layout-color2,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 15))
      );
    }

    html[theme="dark"],
    html[data-theme="dark"],
    body[data-theme="dark"],
    body.vscode-dark {
      --xr-font-color0: var(
        --jp-content-font-color0,
        var(--pst-color-text-base, rgba(255, 255, 255, 1))
      );
      --xr-font-color2: var(
        --jp-content-font-color2,
        var(--pst-color-text-base, rgba(255, 255, 255, 0.54))
      );
      --xr-font-color3: var(
        --jp-content-font-color3,
        var(--pst-color-text-base, rgba(255, 255, 255, 0.38))
      );
      --xr-border-color: var(
        --jp-border-color2,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))
      );
      --xr-disabled-color: var(
        --jp-layout-color3,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))
      );
      --xr-background-color: var(
        --jp-layout-color0,
        var(--pst-color-on-background, #111111)
      );
      --xr-background-color-row-even: var(
        --jp-layout-color1,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))
      );
      --xr-background-color-row-odd: var(
        --jp-layout-color2,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))
      );
    }

    .xr-wrap {
      display: block !important;
      min-width: 300px;
      max-width: 700px;
      line-height: 1.6;
    }

    .xr-text-repr-fallback {
      /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
      display: none;
    }

    .xr-header {
      padding-top: 6px;
      padding-bottom: 6px;
      margin-bottom: 4px;
      border-bottom: solid 1px var(--xr-border-color);
    }

    .xr-header > div,
    .xr-header > ul {
      display: inline;
      margin-top: 0;
      margin-bottom: 0;
    }

    .xr-obj-type,
    .xr-obj-name,
    .xr-group-name {
      margin-left: 2px;
      margin-right: 10px;
    }

    .xr-group-name::before {
      content: "📁";
      padding-right: 0.3em;
    }

    .xr-group-name,
    .xr-obj-type {
      color: var(--xr-font-color2);
    }

    .xr-sections {
      padding-left: 0 !important;
      display: grid;
      grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
      margin-block-start: 0;
      margin-block-end: 0;
    }

    .xr-section-item {
      display: contents;
    }

    .xr-section-item input {
      display: inline-block;
      opacity: 0;
      height: 0;
      margin: 0;
    }

    .xr-section-item input + label {
      color: var(--xr-disabled-color);
      border: 2px solid transparent !important;
    }

    .xr-section-item input:enabled + label {
      cursor: pointer;
      color: var(--xr-font-color2);
    }

    .xr-section-item input:focus + label {
      border: 2px solid var(--xr-font-color0) !important;
    }

    .xr-section-item input:enabled + label:hover {
      color: var(--xr-font-color0);
    }

    .xr-section-summary {
      grid-column: 1;
      color: var(--xr-font-color2);
      font-weight: 500;
    }

    .xr-section-summary > span {
      display: inline-block;
      padding-left: 0.5em;
    }

    .xr-section-summary-in:disabled + label {
      color: var(--xr-font-color2);
    }

    .xr-section-summary-in + label:before {
      display: inline-block;
      content: "►";
      font-size: 11px;
      width: 15px;
      text-align: center;
    }

    .xr-section-summary-in:disabled + label:before {
      color: var(--xr-disabled-color);
    }

    .xr-section-summary-in:checked + label:before {
      content: "▼";
    }

    .xr-section-summary-in:checked + label > span {
      display: none;
    }

    .xr-section-summary,
    .xr-section-inline-details {
      padding-top: 4px;
    }

    .xr-section-inline-details {
      grid-column: 2 / -1;
    }

    .xr-section-details {
      display: none;
      grid-column: 1 / -1;
      margin-top: 4px;
      margin-bottom: 5px;
    }

    .xr-section-summary-in:checked ~ .xr-section-details {
      display: contents;
    }

    .xr-group-box {
      display: inline-grid;
      grid-template-columns: 0px 20px auto;
      width: 100%;
    }

    .xr-group-box-vline {
      grid-column-start: 1;
      border-right: 0.2em solid;
      border-color: var(--xr-border-color);
      width: 0px;
    }

    .xr-group-box-hline {
      grid-column-start: 2;
      grid-row-start: 1;
      height: 1em;
      width: 20px;
      border-bottom: 0.2em solid;
      border-color: var(--xr-border-color);
    }

    .xr-group-box-contents {
      grid-column-start: 3;
    }

    .xr-array-wrap {
      grid-column: 1 / -1;
      display: grid;
      grid-template-columns: 20px auto;
    }

    .xr-array-wrap > label {
      grid-column: 1;
      vertical-align: top;
    }

    .xr-preview {
      color: var(--xr-font-color3);
    }

    .xr-array-preview,
    .xr-array-data {
      padding: 0 5px !important;
      grid-column: 2;
    }

    .xr-array-data,
    .xr-array-in:checked ~ .xr-array-preview {
      display: none;
    }

    .xr-array-in:checked ~ .xr-array-data,
    .xr-array-preview {
      display: inline-block;
    }

    .xr-dim-list {
      display: inline-block !important;
      list-style: none;
      padding: 0 !important;
      margin: 0;
    }

    .xr-dim-list li {
      display: inline-block;
      padding: 0;
      margin: 0;
    }

    .xr-dim-list:before {
      content: "(";
    }

    .xr-dim-list:after {
      content: ")";
    }

    .xr-dim-list li:not(:last-child):after {
      content: ",";
      padding-right: 5px;
    }

    .xr-has-index {
      font-weight: bold;
    }

    .xr-var-list,
    .xr-var-item {
      display: contents;
    }

    .xr-var-item > div,
    .xr-var-item label,
    .xr-var-item > .xr-var-name span {
      background-color: var(--xr-background-color-row-even);
      border-color: var(--xr-background-color-row-odd);
      margin-bottom: 0;
      padding-top: 2px;
    }

    .xr-var-item > .xr-var-name:hover span {
      padding-right: 5px;
    }

    .xr-var-list > li:nth-child(odd) > div,
    .xr-var-list > li:nth-child(odd) > label,
    .xr-var-list > li:nth-child(odd) > .xr-var-name span {
      background-color: var(--xr-background-color-row-odd);
      border-color: var(--xr-background-color-row-even);
    }

    .xr-var-name {
      grid-column: 1;
    }

    .xr-var-dims {
      grid-column: 2;
    }

    .xr-var-dtype {
      grid-column: 3;
      text-align: right;
      color: var(--xr-font-color2);
    }

    .xr-var-preview {
      grid-column: 4;
    }

    .xr-index-preview {
      grid-column: 2 / 5;
      color: var(--xr-font-color2);
    }

    .xr-var-name,
    .xr-var-dims,
    .xr-var-dtype,
    .xr-preview,
    .xr-attrs dt {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      padding-right: 10px;
    }

    .xr-var-name:hover,
    .xr-var-dims:hover,
    .xr-var-dtype:hover,
    .xr-attrs dt:hover {
      overflow: visible;
      width: auto;
      z-index: 1;
    }

    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      display: none;
      border-top: 2px dotted var(--xr-background-color);
      padding-bottom: 20px !important;
      padding-top: 10px !important;
    }

    .xr-var-attrs-in + label,
    .xr-var-data-in + label,
    .xr-index-data-in + label {
      padding: 0 1px;
    }

    .xr-var-attrs-in:checked ~ .xr-var-attrs,
    .xr-var-data-in:checked ~ .xr-var-data,
    .xr-index-data-in:checked ~ .xr-index-data {
      display: block;
    }

    .xr-var-data > table {
      float: right;
    }

    .xr-var-data > pre,
    .xr-index-data > pre,
    .xr-var-data > table > tbody > tr {
      background-color: transparent !important;
    }

    .xr-var-name span,
    .xr-var-data,
    .xr-index-name div,
    .xr-index-data,
    .xr-attrs {
      padding-left: 25px !important;
    }

    .xr-attrs,
    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      grid-column: 1 / -1;
    }

    dl.xr-attrs {
      padding: 0;
      margin: 0;
      display: grid;
      grid-template-columns: 125px auto;
    }

    .xr-attrs dt,
    .xr-attrs dd {
      padding: 0;
      margin: 0;
      float: left;
      padding-right: 10px;
      width: auto;
    }

    .xr-attrs dt {
      font-weight: normal;
      grid-column: 1;
    }

    .xr-attrs dt:hover span {
      display: inline-block;
      background: var(--xr-background-color);
      padding-right: 10px;
    }

    .xr-attrs dd {
      grid-column: 2;
      white-space: pre-wrap;
      word-break: break-all;
    }

    .xr-icon-database,
    .xr-icon-file-text2,
    .xr-no-icon {
      display: inline-block;
      vertical-align: middle;
      width: 1em;
      height: 1.5em !important;
      stroke-width: 0;
      stroke: currentColor;
      fill: currentColor;
    }

    .xr-var-attrs-in:checked + label > .xr-icon-file-text2,
    .xr-var-data-in:checked + label > .xr-icon-database,
    .xr-index-data-in:checked + label > .xr-icon-database {
      color: var(--xr-font-color0);
      filter: drop-shadow(1px 1px 5px var(--xr-font-color2));
      stroke-width: 0.8px;
    }
    </style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 169kB
    Dimensions:  (time: 2, lon: 144, lat: 73)
    Coordinates:
      * time     (time) datetime64[ns] 16B 2022-01-01 2022-02-01
      * lon      (lon) float32 576B 0.0 2.5 5.0 7.5 10.0 ... 350.0 352.5 355.0 357.5
      * lat      (lat) float32 292B -90.0 -87.5 -85.0 -82.5 ... 82.5 85.0 87.5 90.0
    Data variables:
        qu       (time, lat, lon) float32 84kB 764.1 420.4 ... -2.405e+04 -2.415e+04
        qv       (time, lat, lon) float32 84kB 7.884e+03 7.905e+03 ... -1.976e+03</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-2a07bd9f-b14f-423d-a313-bf2aa036a012' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-2a07bd9f-b14f-423d-a313-bf2aa036a012' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 2</li><li><span class='xr-has-index'>lon</span>: 144</li><li><span class='xr-has-index'>lat</span>: 73</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-aeec75b9-c49e-403e-856a-f1d6ecc95d16' class='xr-section-summary-in' type='checkbox'  checked><label for='section-aeec75b9-c49e-403e-856a-f1d6ecc95d16' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2022-01-01 2022-02-01</div><input id='attrs-9860c07c-71c7-4420-8422-e946093edf8f' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-9860c07c-71c7-4420-8422-e946093edf8f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-96406876-1468-4483-b116-7d1676724a6f' class='xr-var-data-in' type='checkbox'><label for='data-96406876-1468-4483-b116-7d1676724a6f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>time</dd><dt><span>long_name :</span></dt><dd>Time</dd><dt><span>axis :</span></dt><dd>T</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;2022-01-01T00:00:00.000000000&#x27;, &#x27;2022-02-01T00:00:00.000000000&#x27;],
          dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.0 2.5 5.0 ... 352.5 355.0 357.5</div><input id='attrs-3ca3a60a-9f99-48d4-87d1-5243a65e42d1' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-3ca3a60a-9f99-48d4-87d1-5243a65e42d1' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-34c64603-6ed4-49b6-b272-9bd07cee632b' class='xr-var-data-in' type='checkbox'><label for='data-34c64603-6ed4-49b6-b272-9bd07cee632b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>long_name :</span></dt><dd>Longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>axis :</span></dt><dd>X</dd></dl></div><div class='xr-var-data'><pre>array([  0. ,   2.5,   5. ,   7.5,  10. ,  12.5,  15. ,  17.5,  20. ,  22.5,
            25. ,  27.5,  30. ,  32.5,  35. ,  37.5,  40. ,  42.5,  45. ,  47.5,
            50. ,  52.5,  55. ,  57.5,  60. ,  62.5,  65. ,  67.5,  70. ,  72.5,
            75. ,  77.5,  80. ,  82.5,  85. ,  87.5,  90. ,  92.5,  95. ,  97.5,
           100. , 102.5, 105. , 107.5, 110. , 112.5, 115. , 117.5, 120. , 122.5,
           125. , 127.5, 130. , 132.5, 135. , 137.5, 140. , 142.5, 145. , 147.5,
           150. , 152.5, 155. , 157.5, 160. , 162.5, 165. , 167.5, 170. , 172.5,
           175. , 177.5, 180. , 182.5, 185. , 187.5, 190. , 192.5, 195. , 197.5,
           200. , 202.5, 205. , 207.5, 210. , 212.5, 215. , 217.5, 220. , 222.5,
           225. , 227.5, 230. , 232.5, 235. , 237.5, 240. , 242.5, 245. , 247.5,
           250. , 252.5, 255. , 257.5, 260. , 262.5, 265. , 267.5, 270. , 272.5,
           275. , 277.5, 280. , 282.5, 285. , 287.5, 290. , 292.5, 295. , 297.5,
           300. , 302.5, 305. , 307.5, 310. , 312.5, 315. , 317.5, 320. , 322.5,
           325. , 327.5, 330. , 332.5, 335. , 337.5, 340. , 342.5, 345. , 347.5,
           350. , 352.5, 355. , 357.5], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-90.0 -87.5 -85.0 ... 87.5 90.0</div><input id='attrs-e6a35449-3ed4-47ac-8437-acda295f974b' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-e6a35449-3ed4-47ac-8437-acda295f974b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e47790a3-a1ae-41ef-aad7-30dc203697df' class='xr-var-data-in' type='checkbox'><label for='data-e47790a3-a1ae-41ef-aad7-30dc203697df' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>long_name :</span></dt><dd>Latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>axis :</span></dt><dd>Y</dd></dl></div><div class='xr-var-data'><pre>array([-90. , -87.5, -85. , -82.5, -80. , -77.5, -75. , -72.5, -70. , -67.5,
           -65. , -62.5, -60. , -57.5, -55. , -52.5, -50. , -47.5, -45. , -42.5,
           -40. , -37.5, -35. , -32.5, -30. , -27.5, -25. , -22.5, -20. , -17.5,
           -15. , -12.5, -10. ,  -7.5,  -5. ,  -2.5,   0. ,   2.5,   5. ,   7.5,
            10. ,  12.5,  15. ,  17.5,  20. ,  22.5,  25. ,  27.5,  30. ,  32.5,
            35. ,  37.5,  40. ,  42.5,  45. ,  47.5,  50. ,  52.5,  55. ,  57.5,
            60. ,  62.5,  65. ,  67.5,  70. ,  72.5,  75. ,  77.5,  80. ,  82.5,
            85. ,  87.5,  90. ], dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-60bf48fa-48f9-44b9-94fc-50bc11960f37' class='xr-section-summary-in' type='checkbox'  checked><label for='section-60bf48fa-48f9-44b9-94fc-50bc11960f37' class='xr-section-summary' >Data variables: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>qu</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>764.1 420.4 ... -2.415e+04</div><input id='attrs-19a02d0d-4f16-408a-8bc1-1a3a9dec9e2a' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-19a02d0d-4f16-408a-8bc1-1a3a9dec9e2a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3013ac4b-1109-44d9-86c0-b3f0504e0b82' class='xr-var-data-in' type='checkbox'><label for='data-3013ac4b-1109-44d9-86c0-b3f0504e0b82' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Monthly Mean of Specific Humidity</dd><dt><span>units :</span></dt><dd>grams/kg</dd><dt><span>precision :</span></dt><dd>3</dd><dt><span>var_desc :</span></dt><dd>Specific Humidity</dd><dt><span>level_desc :</span></dt><dd>Pressure Levels</dd><dt><span>statistic :</span></dt><dd>Mean</dd><dt><span>parent_stat :</span></dt><dd>Other</dd><dt><span>dataset :</span></dt><dd>NCEP Reanalysis Derived Products</dd><dt><span>actual_range :</span></dt><dd>[ 0.      34.88718]</dd><dt><span>Vertical integral method :</span></dt><dd>Trenberth-vibeta</dd></dl></div><div class='xr-var-data'><pre>array([[[   764.1305 ,    420.386  ,     41.37965, ...,   1754.9336 ,
               1408.9583 ,   1111.3759 ],
            [  2888.3228 ,   2628.0552 ,   2389.276  , ...,   3665.8916 ,
               3424.9082 ,   3215.754  ],
            [   947.62415,    694.2946 ,    401.24915, ...,   1777.574  ,
               1493.9509 ,   1255.2438 ],
            ...,
            [-10500.327  , -11242.958  , -11988.612  , ...,  -8289.951  ,
              -9007.941  ,  -9734.624  ],
            [-12183.795  , -12402.442  , -12612.091  , ..., -11504.028  ,
             -11724.952  , -11951.933  ],
            [-15247.002  , -15466.363  , -15664.332  , ..., -14401.904  ,
             -14706.968  , -14991.695  ]],

           [[  2536.8816 ,   2174.4268 ,   1812.0328 , ...,   3582.4114 ,
               3247.1133 ,   2892.419  ],
            [  3421.082  ,   3258.8306 ,   3107.3137 , ...,   3943.8455 ,
               3758.8271 ,   3592.8806 ],
            [  3346.2932 ,   3641.9219 ,   3921.0427 , ...,   2589.7036 ,
               2772.7332 ,   3036.336  ],
            ...,
            [ -8941.726  ,  -9802.936  , -10667.026  , ...,  -6543.59   ,
              -7298.8247 ,  -8107.329  ],
            [-17655.908  , -17937.752  , -18217.6    , ..., -16691.25   ,
             -17021.02   , -17340.396  ],
            [-24214.209  , -24232.627  , -24206.156  , ..., -23887.533  ,
             -24046.729  , -24154.074  ]]], shape=(2, 73, 144), dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>qv</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>7.884e+03 7.905e+03 ... -1.976e+03</div><input id='attrs-6e789915-9db5-42cb-af6c-49642e6e3452' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-6e789915-9db5-42cb-af6c-49642e6e3452' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a7a72bed-d2a6-4551-8c7a-d8a76592ac40' class='xr-var-data-in' type='checkbox'><label for='data-a7a72bed-d2a6-4551-8c7a-d8a76592ac40' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Monthly Mean of Specific Humidity</dd><dt><span>units :</span></dt><dd>grams/kg</dd><dt><span>precision :</span></dt><dd>3</dd><dt><span>var_desc :</span></dt><dd>Specific Humidity</dd><dt><span>level_desc :</span></dt><dd>Pressure Levels</dd><dt><span>statistic :</span></dt><dd>Mean</dd><dt><span>parent_stat :</span></dt><dd>Other</dd><dt><span>dataset :</span></dt><dd>NCEP Reanalysis Derived Products</dd><dt><span>actual_range :</span></dt><dd>[ 0.      34.88718]</dd><dt><span>Vertical integral method :</span></dt><dd>Trenberth-vibeta</dd></dl></div><div class='xr-var-data'><pre>array([[[ 7883.659  ,  7905.0005 ,  7958.5405 , ...,  7734.329  ,
              7816.0127 ,  7834.132  ],
            [ 5235.9478 ,  5501.0444 ,  5734.6694 , ...,  4427.38   ,
              4702.162  ,  4980.545  ],
            [ 7450.4116 ,  7791.355  ,  8025.6284 , ...,  5602.8    ,
              6343.4473 ,  6962.0586 ],
            ...,
            [-7246.3057 , -7228.243  , -7149.3955 , ..., -6951.0054 ,
             -7099.7163 , -7201.847  ],
            [-4956.352  , -4603.5    , -4242.636  , ..., -5917.206  ,
             -5606.452  , -5287.6064 ],
            [-5470.336  , -4798.7974 , -4126.2026 , ..., -7418.8403 ,
             -6780.4375 , -6127.9463 ]],

           [[ 8228.076  ,  8342.619  ,  8418.245  , ...,  7842.9697 ,
              7988.952  ,  8124.053  ],
            [ 3624.8127 ,  3730.7979 ,  3883.9333 , ...,  3271.8242 ,
              3390.2607 ,  3505.3909 ],
            [ 2831.7595 ,  3149.7505 ,  3397.659  , ...,  1891.5964 ,
              2185.9998 ,  2494.4062 ],
            ...,
            [-5310.676  , -4914.6494 , -4417.6567 , ..., -5789.008  ,
             -5735.0073 , -5571.867  ],
            [-2336.2898 , -1571.1039 ,  -777.90063, ..., -4423.016  ,
             -3761.101  , -3064.675  ],
            [ -919.7678 ,   132.96321,  1190.7288 , ..., -4073.0735 ,
             -3036.5168 , -1975.7177 ]]], shape=(2, 73, 144), dtype=float32)</pre></div></li></ul></div></li></ul></div></div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 403-404

Extracting the entire layer water vapor flux at mid and low latitudes at the 0th time level.

.. GENERATED FROM PYTHON SOURCE LINES 404-412

.. code-block:: Python


    draw_water_flux = (
        water_flux_top2surface_integral.isel(time=0)
        .thin(lon=3, lat=3)
        .sel(lat=slice(-60, 60))
    )
    draw_pr = pr_data.isel(time=0).sel(lat=slice(-60, 60))








.. GENERATED FROM PYTHON SOURCE LINES 413-440

.. code-block:: Python

    fig, ax = plt.subplots(
        subplot_kw={"projection": ccrs.PlateCarree(central_longitude=180)}
    )

    ax.gridlines(draw_labels=["bottom", "left"], color="grey", alpha=0.5, linestyle="--")
    ax.coastlines(edgecolor="black", linewidths=0.5)

    draw_water_flux.plot.quiver(
        ax=ax,
        u="qu",
        v="qv",
        x="lon",
        y="lat",
        transform=ccrs.PlateCarree(),
        zorder=2,
    )

    draw_pr.plot.contourf(
        ax=ax,
        transform=ccrs.PlateCarree(),
        levels=21,
        cmap="Greens",
        zorder=1,
        cbar_kwargs={"location": "bottom"},
        vmax=20,
    )




.. image-sg:: /auto_gallery/images/sphx_glr_plot_geographic_finite_difference_015.png
   :alt: time = 2022-01-01
   :srcset: /auto_gallery/images/sphx_glr_plot_geographic_finite_difference_015.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    <cartopy.mpl.contour.GeoContourSet object at 0x7ff42632f110>



.. GENERATED FROM PYTHON SOURCE LINES 441-453

Water Vapor Flux Divergence
--------------------------------------

Water vapor flux divergence represents the convergence and divergence of water vapor. There are also two built-in functions to calculate the results of single-layers and whole-layer integration respectively.

- :py:func:`easyclimate.calc_divergence_watervaporflux <easyclimate.calc_divergence_watervaporflux>`: calculate water vapor flux divergence at each vertical level.

.. math::

  \nabla \left( \frac{1}{g} q \mathbf{V} \right) = \frac{1}{g} \nabla \cdot \left( q \mathbf{V} \right)

- :py:func:`easyclimate.calc_divergence_watervaporflux_top2surface_integral <easyclimate.calc_divergence_watervaporflux_top2surface_integral>`: calculate water vapor flux divergence across the vertical level.

.. GENERATED FROM PYTHON SOURCE LINES 453-469

.. code-block:: Python


    divergence_watervaporflux_top2surface_integral = (
        ecl.calc_divergence_watervaporflux_top2surface_integral(
            specific_humidity_data=q_data,
            u_data=u_data,
            v_data=v_data,
            surface_pressure_data=msl_data,
            surface_pressure_data_units="millibars",
            specific_humidity_data_units="grams/kg",
            vertical_dim="level",
            vertical_dim_units="hPa",
        )
    )

    divergence_watervaporflux_top2surface_integral






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
    <defs>
    <symbol id="icon-database" viewBox="0 0 32 32">
    <path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
    <path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    <path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    </symbol>
    <symbol id="icon-file-text2" viewBox="0 0 32 32">
    <path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
    <path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    </symbol>
    </defs>
    </svg>
    <style>/* CSS stylesheet for displaying xarray objects in notebooks */

    :root {
      --xr-font-color0: var(
        --jp-content-font-color0,
        var(--pst-color-text-base rgba(0, 0, 0, 1))
      );
      --xr-font-color2: var(
        --jp-content-font-color2,
        var(--pst-color-text-base, rgba(0, 0, 0, 0.54))
      );
      --xr-font-color3: var(
        --jp-content-font-color3,
        var(--pst-color-text-base, rgba(0, 0, 0, 0.38))
      );
      --xr-border-color: var(
        --jp-border-color2,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 10))
      );
      --xr-disabled-color: var(
        --jp-layout-color3,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 40))
      );
      --xr-background-color: var(
        --jp-layout-color0,
        var(--pst-color-on-background, white)
      );
      --xr-background-color-row-even: var(
        --jp-layout-color1,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 5))
      );
      --xr-background-color-row-odd: var(
        --jp-layout-color2,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 15))
      );
    }

    html[theme="dark"],
    html[data-theme="dark"],
    body[data-theme="dark"],
    body.vscode-dark {
      --xr-font-color0: var(
        --jp-content-font-color0,
        var(--pst-color-text-base, rgba(255, 255, 255, 1))
      );
      --xr-font-color2: var(
        --jp-content-font-color2,
        var(--pst-color-text-base, rgba(255, 255, 255, 0.54))
      );
      --xr-font-color3: var(
        --jp-content-font-color3,
        var(--pst-color-text-base, rgba(255, 255, 255, 0.38))
      );
      --xr-border-color: var(
        --jp-border-color2,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))
      );
      --xr-disabled-color: var(
        --jp-layout-color3,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))
      );
      --xr-background-color: var(
        --jp-layout-color0,
        var(--pst-color-on-background, #111111)
      );
      --xr-background-color-row-even: var(
        --jp-layout-color1,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))
      );
      --xr-background-color-row-odd: var(
        --jp-layout-color2,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))
      );
    }

    .xr-wrap {
      display: block !important;
      min-width: 300px;
      max-width: 700px;
      line-height: 1.6;
    }

    .xr-text-repr-fallback {
      /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
      display: none;
    }

    .xr-header {
      padding-top: 6px;
      padding-bottom: 6px;
      margin-bottom: 4px;
      border-bottom: solid 1px var(--xr-border-color);
    }

    .xr-header > div,
    .xr-header > ul {
      display: inline;
      margin-top: 0;
      margin-bottom: 0;
    }

    .xr-obj-type,
    .xr-obj-name,
    .xr-group-name {
      margin-left: 2px;
      margin-right: 10px;
    }

    .xr-group-name::before {
      content: "📁";
      padding-right: 0.3em;
    }

    .xr-group-name,
    .xr-obj-type {
      color: var(--xr-font-color2);
    }

    .xr-sections {
      padding-left: 0 !important;
      display: grid;
      grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
      margin-block-start: 0;
      margin-block-end: 0;
    }

    .xr-section-item {
      display: contents;
    }

    .xr-section-item input {
      display: inline-block;
      opacity: 0;
      height: 0;
      margin: 0;
    }

    .xr-section-item input + label {
      color: var(--xr-disabled-color);
      border: 2px solid transparent !important;
    }

    .xr-section-item input:enabled + label {
      cursor: pointer;
      color: var(--xr-font-color2);
    }

    .xr-section-item input:focus + label {
      border: 2px solid var(--xr-font-color0) !important;
    }

    .xr-section-item input:enabled + label:hover {
      color: var(--xr-font-color0);
    }

    .xr-section-summary {
      grid-column: 1;
      color: var(--xr-font-color2);
      font-weight: 500;
    }

    .xr-section-summary > span {
      display: inline-block;
      padding-left: 0.5em;
    }

    .xr-section-summary-in:disabled + label {
      color: var(--xr-font-color2);
    }

    .xr-section-summary-in + label:before {
      display: inline-block;
      content: "►";
      font-size: 11px;
      width: 15px;
      text-align: center;
    }

    .xr-section-summary-in:disabled + label:before {
      color: var(--xr-disabled-color);
    }

    .xr-section-summary-in:checked + label:before {
      content: "▼";
    }

    .xr-section-summary-in:checked + label > span {
      display: none;
    }

    .xr-section-summary,
    .xr-section-inline-details {
      padding-top: 4px;
    }

    .xr-section-inline-details {
      grid-column: 2 / -1;
    }

    .xr-section-details {
      display: none;
      grid-column: 1 / -1;
      margin-top: 4px;
      margin-bottom: 5px;
    }

    .xr-section-summary-in:checked ~ .xr-section-details {
      display: contents;
    }

    .xr-group-box {
      display: inline-grid;
      grid-template-columns: 0px 20px auto;
      width: 100%;
    }

    .xr-group-box-vline {
      grid-column-start: 1;
      border-right: 0.2em solid;
      border-color: var(--xr-border-color);
      width: 0px;
    }

    .xr-group-box-hline {
      grid-column-start: 2;
      grid-row-start: 1;
      height: 1em;
      width: 20px;
      border-bottom: 0.2em solid;
      border-color: var(--xr-border-color);
    }

    .xr-group-box-contents {
      grid-column-start: 3;
    }

    .xr-array-wrap {
      grid-column: 1 / -1;
      display: grid;
      grid-template-columns: 20px auto;
    }

    .xr-array-wrap > label {
      grid-column: 1;
      vertical-align: top;
    }

    .xr-preview {
      color: var(--xr-font-color3);
    }

    .xr-array-preview,
    .xr-array-data {
      padding: 0 5px !important;
      grid-column: 2;
    }

    .xr-array-data,
    .xr-array-in:checked ~ .xr-array-preview {
      display: none;
    }

    .xr-array-in:checked ~ .xr-array-data,
    .xr-array-preview {
      display: inline-block;
    }

    .xr-dim-list {
      display: inline-block !important;
      list-style: none;
      padding: 0 !important;
      margin: 0;
    }

    .xr-dim-list li {
      display: inline-block;
      padding: 0;
      margin: 0;
    }

    .xr-dim-list:before {
      content: "(";
    }

    .xr-dim-list:after {
      content: ")";
    }

    .xr-dim-list li:not(:last-child):after {
      content: ",";
      padding-right: 5px;
    }

    .xr-has-index {
      font-weight: bold;
    }

    .xr-var-list,
    .xr-var-item {
      display: contents;
    }

    .xr-var-item > div,
    .xr-var-item label,
    .xr-var-item > .xr-var-name span {
      background-color: var(--xr-background-color-row-even);
      border-color: var(--xr-background-color-row-odd);
      margin-bottom: 0;
      padding-top: 2px;
    }

    .xr-var-item > .xr-var-name:hover span {
      padding-right: 5px;
    }

    .xr-var-list > li:nth-child(odd) > div,
    .xr-var-list > li:nth-child(odd) > label,
    .xr-var-list > li:nth-child(odd) > .xr-var-name span {
      background-color: var(--xr-background-color-row-odd);
      border-color: var(--xr-background-color-row-even);
    }

    .xr-var-name {
      grid-column: 1;
    }

    .xr-var-dims {
      grid-column: 2;
    }

    .xr-var-dtype {
      grid-column: 3;
      text-align: right;
      color: var(--xr-font-color2);
    }

    .xr-var-preview {
      grid-column: 4;
    }

    .xr-index-preview {
      grid-column: 2 / 5;
      color: var(--xr-font-color2);
    }

    .xr-var-name,
    .xr-var-dims,
    .xr-var-dtype,
    .xr-preview,
    .xr-attrs dt {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      padding-right: 10px;
    }

    .xr-var-name:hover,
    .xr-var-dims:hover,
    .xr-var-dtype:hover,
    .xr-attrs dt:hover {
      overflow: visible;
      width: auto;
      z-index: 1;
    }

    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      display: none;
      border-top: 2px dotted var(--xr-background-color);
      padding-bottom: 20px !important;
      padding-top: 10px !important;
    }

    .xr-var-attrs-in + label,
    .xr-var-data-in + label,
    .xr-index-data-in + label {
      padding: 0 1px;
    }

    .xr-var-attrs-in:checked ~ .xr-var-attrs,
    .xr-var-data-in:checked ~ .xr-var-data,
    .xr-index-data-in:checked ~ .xr-index-data {
      display: block;
    }

    .xr-var-data > table {
      float: right;
    }

    .xr-var-data > pre,
    .xr-index-data > pre,
    .xr-var-data > table > tbody > tr {
      background-color: transparent !important;
    }

    .xr-var-name span,
    .xr-var-data,
    .xr-index-name div,
    .xr-index-data,
    .xr-attrs {
      padding-left: 25px !important;
    }

    .xr-attrs,
    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      grid-column: 1 / -1;
    }

    dl.xr-attrs {
      padding: 0;
      margin: 0;
      display: grid;
      grid-template-columns: 125px auto;
    }

    .xr-attrs dt,
    .xr-attrs dd {
      padding: 0;
      margin: 0;
      float: left;
      padding-right: 10px;
      width: auto;
    }

    .xr-attrs dt {
      font-weight: normal;
      grid-column: 1;
    }

    .xr-attrs dt:hover span {
      display: inline-block;
      background: var(--xr-background-color);
      padding-right: 10px;
    }

    .xr-attrs dd {
      grid-column: 2;
      white-space: pre-wrap;
      word-break: break-all;
    }

    .xr-icon-database,
    .xr-icon-file-text2,
    .xr-no-icon {
      display: inline-block;
      vertical-align: middle;
      width: 1em;
      height: 1.5em !important;
      stroke-width: 0;
      stroke: currentColor;
      fill: currentColor;
    }

    .xr-var-attrs-in:checked + label > .xr-icon-file-text2,
    .xr-var-data-in:checked + label > .xr-icon-database,
    .xr-index-data-in:checked + label > .xr-icon-database {
      color: var(--xr-font-color0);
      filter: drop-shadow(1px 1px 5px var(--xr-font-color2));
      stroke-width: 0.8px;
    }
    </style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray (time: 2, lat: 73, lon: 144)&gt; Size: 84kB
    array([[[-1.4713906e-03,  1.3543955e-03,  2.1210895e-04, ...,
              7.6343783e-04, -1.5851890e-03, -5.6333747e-03],
            [-8.7805418e-10,  2.7797307e-09,  9.0712082e-10, ...,
             -5.3841243e-09, -1.6641454e-09,  3.4471876e-09],
            [ 1.0544438e-08,  9.5549701e-09,  1.0845967e-08, ...,
              3.0537013e-09,  6.1003917e-09,  1.0050217e-08],
            ...,
            [-8.2852196e-09, -7.6594784e-09, -7.1874280e-09, ...,
             -1.1123958e-08, -1.0065919e-08, -8.9873184e-09],
            [ 1.8905173e-09,  2.5617455e-09,  1.9823507e-09, ...,
              1.0646430e-09,  1.5509781e-09,  1.2332715e-09],
            [-7.1021746e-04, -5.9415052e-05,  5.7901783e-05, ...,
              9.3113696e-05, -7.8749137e-05,  5.9077510e-04]],

           [[ 2.8537694e-04, -1.3098042e-04,  6.4368703e-04, ...,
             -5.0326390e-04, -2.9532658e-04,  8.1608852e-04],
            [-1.0668640e-08, -8.7936973e-09, -8.8242693e-09, ...,
             -1.5486565e-08, -1.3513282e-08, -1.0864267e-08],
            [ 1.9833248e-08,  1.9836692e-08,  1.8017014e-08, ...,
              9.4895363e-09,  1.3566088e-08,  1.8495006e-08],
            ...,
            [-1.6230274e-08, -1.5716818e-08, -1.5741023e-08, ...,
             -1.5684693e-08, -1.5797136e-08, -1.6370782e-08],
            [-8.0232843e-09, -9.4303116e-09, -9.7428678e-09, ...,
             -1.0103416e-08, -9.3123296e-09, -9.3905737e-09],
            [ 5.9861140e-05,  1.4605705e-04,  9.4455783e-05, ...,
              1.3847560e-04,  6.3978128e-05, -3.9404942e-04]]],
          shape=(2, 73, 144), dtype=float32)
    Coordinates:
      * time     (time) datetime64[ns] 16B 2022-01-01 2022-02-01
      * lat      (lat) float32 292B -90.0 -87.5 -85.0 -82.5 ... 82.5 85.0 87.5 90.0
      * lon      (lon) float32 576B 0.0 2.5 5.0 7.5 10.0 ... 350.0 352.5 355.0 357.5
    Attributes:
        long_name:                 Monthly Mean of Specific Humidity
        units:                     kg/kg
        precision:                 3
        var_desc:                  Specific Humidity
        level_desc:                Pressure Levels
        statistic:                 Mean
        parent_stat:               Other
        dataset:                   NCEP Reanalysis Derived Products
        actual_range:              [ 0.      34.88718]
        Vertical integral method:  Trenberth-vibeta</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-obj-name'></div><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 2</li><li><span class='xr-has-index'>lat</span>: 73</li><li><span class='xr-has-index'>lon</span>: 144</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-7aee427f-6389-4f1a-94e1-8e5a3c3943ee' class='xr-array-in' type='checkbox' checked><label for='section-7aee427f-6389-4f1a-94e1-8e5a3c3943ee' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>-0.001471 0.001354 0.0002121 ... 0.0001385 6.398e-05 -0.000394</span></div><div class='xr-array-data'><pre>array([[[-1.4713906e-03,  1.3543955e-03,  2.1210895e-04, ...,
              7.6343783e-04, -1.5851890e-03, -5.6333747e-03],
            [-8.7805418e-10,  2.7797307e-09,  9.0712082e-10, ...,
             -5.3841243e-09, -1.6641454e-09,  3.4471876e-09],
            [ 1.0544438e-08,  9.5549701e-09,  1.0845967e-08, ...,
              3.0537013e-09,  6.1003917e-09,  1.0050217e-08],
            ...,
            [-8.2852196e-09, -7.6594784e-09, -7.1874280e-09, ...,
             -1.1123958e-08, -1.0065919e-08, -8.9873184e-09],
            [ 1.8905173e-09,  2.5617455e-09,  1.9823507e-09, ...,
              1.0646430e-09,  1.5509781e-09,  1.2332715e-09],
            [-7.1021746e-04, -5.9415052e-05,  5.7901783e-05, ...,
              9.3113696e-05, -7.8749137e-05,  5.9077510e-04]],

           [[ 2.8537694e-04, -1.3098042e-04,  6.4368703e-04, ...,
             -5.0326390e-04, -2.9532658e-04,  8.1608852e-04],
            [-1.0668640e-08, -8.7936973e-09, -8.8242693e-09, ...,
             -1.5486565e-08, -1.3513282e-08, -1.0864267e-08],
            [ 1.9833248e-08,  1.9836692e-08,  1.8017014e-08, ...,
              9.4895363e-09,  1.3566088e-08,  1.8495006e-08],
            ...,
            [-1.6230274e-08, -1.5716818e-08, -1.5741023e-08, ...,
             -1.5684693e-08, -1.5797136e-08, -1.6370782e-08],
            [-8.0232843e-09, -9.4303116e-09, -9.7428678e-09, ...,
             -1.0103416e-08, -9.3123296e-09, -9.3905737e-09],
            [ 5.9861140e-05,  1.4605705e-04,  9.4455783e-05, ...,
              1.3847560e-04,  6.3978128e-05, -3.9404942e-04]]],
          shape=(2, 73, 144), dtype=float32)</pre></div></div></li><li class='xr-section-item'><input id='section-8d0e9b91-43f4-4131-b6cb-04b07b32bd21' class='xr-section-summary-in' type='checkbox'  checked><label for='section-8d0e9b91-43f4-4131-b6cb-04b07b32bd21' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2022-01-01 2022-02-01</div><input id='attrs-718d6e0e-06b6-4808-b294-02f22f5122cc' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-718d6e0e-06b6-4808-b294-02f22f5122cc' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b5dc7758-c7e4-41f5-a249-5e3b5e633c80' class='xr-var-data-in' type='checkbox'><label for='data-b5dc7758-c7e4-41f5-a249-5e3b5e633c80' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>time</dd><dt><span>long_name :</span></dt><dd>Time</dd><dt><span>axis :</span></dt><dd>T</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;2022-01-01T00:00:00.000000000&#x27;, &#x27;2022-02-01T00:00:00.000000000&#x27;],
          dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-90.0 -87.5 -85.0 ... 87.5 90.0</div><input id='attrs-02208b37-ec73-45e3-9f48-0d7d6e95c1a4' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-02208b37-ec73-45e3-9f48-0d7d6e95c1a4' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-446f1f5b-0084-4199-8e59-6505ec16eba4' class='xr-var-data-in' type='checkbox'><label for='data-446f1f5b-0084-4199-8e59-6505ec16eba4' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>long_name :</span></dt><dd>Latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>axis :</span></dt><dd>Y</dd></dl></div><div class='xr-var-data'><pre>array([-90. , -87.5, -85. , -82.5, -80. , -77.5, -75. , -72.5, -70. , -67.5,
           -65. , -62.5, -60. , -57.5, -55. , -52.5, -50. , -47.5, -45. , -42.5,
           -40. , -37.5, -35. , -32.5, -30. , -27.5, -25. , -22.5, -20. , -17.5,
           -15. , -12.5, -10. ,  -7.5,  -5. ,  -2.5,   0. ,   2.5,   5. ,   7.5,
            10. ,  12.5,  15. ,  17.5,  20. ,  22.5,  25. ,  27.5,  30. ,  32.5,
            35. ,  37.5,  40. ,  42.5,  45. ,  47.5,  50. ,  52.5,  55. ,  57.5,
            60. ,  62.5,  65. ,  67.5,  70. ,  72.5,  75. ,  77.5,  80. ,  82.5,
            85. ,  87.5,  90. ], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.0 2.5 5.0 ... 352.5 355.0 357.5</div><input id='attrs-22c4049d-0c25-40e4-bc90-b661cae40959' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-22c4049d-0c25-40e4-bc90-b661cae40959' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7417560c-cfc4-4a2e-bde9-615ff198a5a9' class='xr-var-data-in' type='checkbox'><label for='data-7417560c-cfc4-4a2e-bde9-615ff198a5a9' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>long_name :</span></dt><dd>Longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>axis :</span></dt><dd>X</dd></dl></div><div class='xr-var-data'><pre>array([  0. ,   2.5,   5. ,   7.5,  10. ,  12.5,  15. ,  17.5,  20. ,  22.5,
            25. ,  27.5,  30. ,  32.5,  35. ,  37.5,  40. ,  42.5,  45. ,  47.5,
            50. ,  52.5,  55. ,  57.5,  60. ,  62.5,  65. ,  67.5,  70. ,  72.5,
            75. ,  77.5,  80. ,  82.5,  85. ,  87.5,  90. ,  92.5,  95. ,  97.5,
           100. , 102.5, 105. , 107.5, 110. , 112.5, 115. , 117.5, 120. , 122.5,
           125. , 127.5, 130. , 132.5, 135. , 137.5, 140. , 142.5, 145. , 147.5,
           150. , 152.5, 155. , 157.5, 160. , 162.5, 165. , 167.5, 170. , 172.5,
           175. , 177.5, 180. , 182.5, 185. , 187.5, 190. , 192.5, 195. , 197.5,
           200. , 202.5, 205. , 207.5, 210. , 212.5, 215. , 217.5, 220. , 222.5,
           225. , 227.5, 230. , 232.5, 235. , 237.5, 240. , 242.5, 245. , 247.5,
           250. , 252.5, 255. , 257.5, 260. , 262.5, 265. , 267.5, 270. , 272.5,
           275. , 277.5, 280. , 282.5, 285. , 287.5, 290. , 292.5, 295. , 297.5,
           300. , 302.5, 305. , 307.5, 310. , 312.5, 315. , 317.5, 320. , 322.5,
           325. , 327.5, 330. , 332.5, 335. , 337.5, 340. , 342.5, 345. , 347.5,
           350. , 352.5, 355. , 357.5], dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-26be27e2-7c30-4a59-988a-c05e4ea22324' class='xr-section-summary-in' type='checkbox'  ><label for='section-26be27e2-7c30-4a59-988a-c05e4ea22324' class='xr-section-summary' >Attributes: <span>(10)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Monthly Mean of Specific Humidity</dd><dt><span>units :</span></dt><dd>kg/kg</dd><dt><span>precision :</span></dt><dd>3</dd><dt><span>var_desc :</span></dt><dd>Specific Humidity</dd><dt><span>level_desc :</span></dt><dd>Pressure Levels</dd><dt><span>statistic :</span></dt><dd>Mean</dd><dt><span>parent_stat :</span></dt><dd>Other</dd><dt><span>dataset :</span></dt><dd>NCEP Reanalysis Derived Products</dd><dt><span>actual_range :</span></dt><dd>[ 0.      34.88718]</dd><dt><span>Vertical integral method :</span></dt><dd>Trenberth-vibeta</dd></dl></div></li></ul></div></div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 470-471

Extracting the entire layer water vapor flux at mid and low latitudes at the 0th time level.

.. GENERATED FROM PYTHON SOURCE LINES 471-476

.. code-block:: Python


    draw_data = divergence_watervaporflux_top2surface_integral.isel(time=0).sel(
        lat=slice(-60, 60)
    )








.. GENERATED FROM PYTHON SOURCE LINES 478-489

.. code-block:: Python


    fig, ax = plt.subplots(
        subplot_kw={"projection": ccrs.PlateCarree(central_longitude=180)}
    )

    ax.gridlines(draw_labels=["bottom", "left"], color="grey", alpha=0.5, linestyle="--")
    ax.coastlines(edgecolor="black", linewidths=0.5)

    draw_data.plot.contourf(
        ax=ax, transform=ccrs.PlateCarree(), cbar_kwargs={"location": "bottom"}, levels=21
    )



.. image-sg:: /auto_gallery/images/sphx_glr_plot_geographic_finite_difference_016.png
   :alt: time = 2022-01-01
   :srcset: /auto_gallery/images/sphx_glr_plot_geographic_finite_difference_016.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    <cartopy.mpl.contour.GeoContourSet object at 0x7ff4215ad150>




.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (0 minutes 21.664 seconds)


.. _sphx_glr_download_auto_gallery_plot_geographic_finite_difference.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: plot_geographic_finite_difference.ipynb <plot_geographic_finite_difference.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: plot_geographic_finite_difference.py <plot_geographic_finite_difference.py>`

    .. container:: sphx-glr-download sphx-glr-download-zip

      :download:`Download zipped: plot_geographic_finite_difference.zip <plot_geographic_finite_difference.zip>`
