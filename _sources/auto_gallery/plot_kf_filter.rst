
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_gallery/plot_kf_filter.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_auto_gallery_plot_kf_filter.py>`
        to download the full example code.

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_gallery_plot_kf_filter.py:


.. _wavelet_example:

KF Filter and Hovm√∂ller Diagram
============================================

The KF filter is a specialized spectral analysis technique designed to isolate and study tropical atmospheric waves by decomposing meteorological fields into their wavenumber-frequency components. Unlike traditional Fourier methods, the W-K filter applies a symmetric/antisymmetric separation to distinguish between different wave types, such as **Kelvin waves, Rossby waves, and mixed Rossby-gravity waves**, based on their theoretical dispersion relations. This approach is particularly effective in identifying **convectively coupled waves**, where tropical rainfall and large-scale circulation interact. In meteorology, the W-K filter is widely used to analyze **Madden-Julian Oscillation (MJO) dynamics**, monsoon variability, and other tropical wave disturbances, providing insights into their propagation characteristics and impacts on weather systems.

.. seealso::

    - Wheeler, M., & Kiladis, G. N. (1999). Convectively Coupled Equatorial Waves: Analysis of Clouds and Temperature in the Wavenumber‚ÄìFrequency Domain. Journal of the Atmospheric Sciences, 56(3), 374-399. https://journals.ametsoc.org/view/journals/atsc/56/3/1520-0469_1999_056_0374_ccewao_2.0.co_2.xml
    - Kiladis, G. N., Thorncroft, C. D., & Hall, N. M. J. (2006). Three-Dimensional Structure and Dynamics of African Easterly Waves. Part I: Observations. Journal of the Atmospheric Sciences, 63(9), 2212-2230. https://doi.org/10.1175/JAS3741.1
    - Hall, N. M. J., Kiladis, G. N., & Thorncroft, C. D. (2006). Three-Dimensional Structure and Dynamics of African Easterly Waves. Part II: Dynamical Modes. Journal of the Atmospheric Sciences, 63(9), 2231-2245. https://doi.org/10.1175/JAS3742.1
    - Thorncroft, C. D., Hall, N. M. J., & Kiladis, G. N. (2008). Three-Dimensional Structure and Dynamics of African Easterly Waves. Part III: Genesis. Journal of the Atmospheric Sciences, 65(11), 3596-3607. https://doi.org/10.1175/2008JAS2575.1
    - http://www.bom.gov.au/climate/mjo/

Before proceeding with all the steps, first import some necessary libraries and packages

.. GENERATED FROM PYTHON SOURCE LINES 20-26

.. code-block:: Python

    import numpy as np
    import xarray as xr
    import matplotlib.pyplot as plt
    import cartopy.crs as ccrs
    import easyclimate as ecl








.. GENERATED FROM PYTHON SOURCE LINES 27-56

Preprocessed data


.. tip::

  You can download following datasets here:

  - :download:`Download olr-daily_v01r02_19800101_20231231.nc (3.34 GB) <https://huggingface.co/datasets/shenyulu/easyclimate/resolve/main/tutorial_data/olr-daily_v01r02_19800101_20231231.nc>`
  - :download:`Download olr_smooth_data.nc <https://raw.githubusercontent.com/shenyulu/easyclimate/refs/heads/main/docs/source/dynamic_docs/olr_smooth_data.nc>`


.. code-block:: python

      lats, latn = -20, 20

      olr_data = xr.open_dataset('olr-daily_v01r02_19800101_20231231.nc', chunks='auto').sel(lat=slice(lats,latn)).olr
      olr_daily_smoothed = ecl.variability.remove_smooth_daily_annual_cycle_mean(
          olr_data, extract_time_range = slice('2017-01-01','2018-12-31')
      )

      # target grid
      target_grid = xr.Dataset()
      target_grid['lat'] = olr_daily_smoothed.lat.data
      target_grid['lon'] = olr_daily_smoothed.lon.thin(lon = 5).data

      olr_data_interpolated = ecl.interp.interp_mesh2mesh(olr_daily_smoothed, target_grid = target_grid)
      olr_data_interpolated = ecl.utility.get_compress_xarraydata(olr_data_interpolated)
      olr_data_interpolated.to_netcdf("olr_smooth_data.nc")


.. GENERATED FROM PYTHON SOURCE LINES 58-59

The example here is to avoid longer calculations, thus we open the pre-processed result data directly.

.. GENERATED FROM PYTHON SOURCE LINES 59-62

.. code-block:: Python

    olr_data_interpolated = xr.open_dataset("olr_smooth_data.nc").olr
    olr_data_interpolated






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
    <defs>
    <symbol id="icon-database" viewBox="0 0 32 32">
    <path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
    <path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    <path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    </symbol>
    <symbol id="icon-file-text2" viewBox="0 0 32 32">
    <path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
    <path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    </symbol>
    </defs>
    </svg>
    <style>/* CSS stylesheet for displaying xarray objects in notebooks */

    :root {
      --xr-font-color0: var(
        --jp-content-font-color0,
        var(--pst-color-text-base rgba(0, 0, 0, 1))
      );
      --xr-font-color2: var(
        --jp-content-font-color2,
        var(--pst-color-text-base, rgba(0, 0, 0, 0.54))
      );
      --xr-font-color3: var(
        --jp-content-font-color3,
        var(--pst-color-text-base, rgba(0, 0, 0, 0.38))
      );
      --xr-border-color: var(
        --jp-border-color2,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 10))
      );
      --xr-disabled-color: var(
        --jp-layout-color3,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 40))
      );
      --xr-background-color: var(
        --jp-layout-color0,
        var(--pst-color-on-background, white)
      );
      --xr-background-color-row-even: var(
        --jp-layout-color1,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 5))
      );
      --xr-background-color-row-odd: var(
        --jp-layout-color2,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 15))
      );
    }

    html[theme="dark"],
    html[data-theme="dark"],
    body[data-theme="dark"],
    body.vscode-dark {
      --xr-font-color0: var(
        --jp-content-font-color0,
        var(--pst-color-text-base, rgba(255, 255, 255, 1))
      );
      --xr-font-color2: var(
        --jp-content-font-color2,
        var(--pst-color-text-base, rgba(255, 255, 255, 0.54))
      );
      --xr-font-color3: var(
        --jp-content-font-color3,
        var(--pst-color-text-base, rgba(255, 255, 255, 0.38))
      );
      --xr-border-color: var(
        --jp-border-color2,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))
      );
      --xr-disabled-color: var(
        --jp-layout-color3,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))
      );
      --xr-background-color: var(
        --jp-layout-color0,
        var(--pst-color-on-background, #111111)
      );
      --xr-background-color-row-even: var(
        --jp-layout-color1,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))
      );
      --xr-background-color-row-odd: var(
        --jp-layout-color2,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))
      );
    }

    .xr-wrap {
      display: block !important;
      min-width: 300px;
      max-width: 700px;
      line-height: 1.6;
    }

    .xr-text-repr-fallback {
      /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
      display: none;
    }

    .xr-header {
      padding-top: 6px;
      padding-bottom: 6px;
      margin-bottom: 4px;
      border-bottom: solid 1px var(--xr-border-color);
    }

    .xr-header > div,
    .xr-header > ul {
      display: inline;
      margin-top: 0;
      margin-bottom: 0;
    }

    .xr-obj-type,
    .xr-obj-name,
    .xr-group-name {
      margin-left: 2px;
      margin-right: 10px;
    }

    .xr-group-name::before {
      content: "üìÅ";
      padding-right: 0.3em;
    }

    .xr-group-name,
    .xr-obj-type {
      color: var(--xr-font-color2);
    }

    .xr-sections {
      padding-left: 0 !important;
      display: grid;
      grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
      margin-block-start: 0;
      margin-block-end: 0;
    }

    .xr-section-item {
      display: contents;
    }

    .xr-section-item input {
      display: inline-block;
      opacity: 0;
      height: 0;
      margin: 0;
    }

    .xr-section-item input + label {
      color: var(--xr-disabled-color);
      border: 2px solid transparent !important;
    }

    .xr-section-item input:enabled + label {
      cursor: pointer;
      color: var(--xr-font-color2);
    }

    .xr-section-item input:focus + label {
      border: 2px solid var(--xr-font-color0) !important;
    }

    .xr-section-item input:enabled + label:hover {
      color: var(--xr-font-color0);
    }

    .xr-section-summary {
      grid-column: 1;
      color: var(--xr-font-color2);
      font-weight: 500;
    }

    .xr-section-summary > span {
      display: inline-block;
      padding-left: 0.5em;
    }

    .xr-section-summary-in:disabled + label {
      color: var(--xr-font-color2);
    }

    .xr-section-summary-in + label:before {
      display: inline-block;
      content: "‚ñ∫";
      font-size: 11px;
      width: 15px;
      text-align: center;
    }

    .xr-section-summary-in:disabled + label:before {
      color: var(--xr-disabled-color);
    }

    .xr-section-summary-in:checked + label:before {
      content: "‚ñº";
    }

    .xr-section-summary-in:checked + label > span {
      display: none;
    }

    .xr-section-summary,
    .xr-section-inline-details {
      padding-top: 4px;
    }

    .xr-section-inline-details {
      grid-column: 2 / -1;
    }

    .xr-section-details {
      display: none;
      grid-column: 1 / -1;
      margin-top: 4px;
      margin-bottom: 5px;
    }

    .xr-section-summary-in:checked ~ .xr-section-details {
      display: contents;
    }

    .xr-group-box {
      display: inline-grid;
      grid-template-columns: 0px 20px auto;
      width: 100%;
    }

    .xr-group-box-vline {
      grid-column-start: 1;
      border-right: 0.2em solid;
      border-color: var(--xr-border-color);
      width: 0px;
    }

    .xr-group-box-hline {
      grid-column-start: 2;
      grid-row-start: 1;
      height: 1em;
      width: 20px;
      border-bottom: 0.2em solid;
      border-color: var(--xr-border-color);
    }

    .xr-group-box-contents {
      grid-column-start: 3;
    }

    .xr-array-wrap {
      grid-column: 1 / -1;
      display: grid;
      grid-template-columns: 20px auto;
    }

    .xr-array-wrap > label {
      grid-column: 1;
      vertical-align: top;
    }

    .xr-preview {
      color: var(--xr-font-color3);
    }

    .xr-array-preview,
    .xr-array-data {
      padding: 0 5px !important;
      grid-column: 2;
    }

    .xr-array-data,
    .xr-array-in:checked ~ .xr-array-preview {
      display: none;
    }

    .xr-array-in:checked ~ .xr-array-data,
    .xr-array-preview {
      display: inline-block;
    }

    .xr-dim-list {
      display: inline-block !important;
      list-style: none;
      padding: 0 !important;
      margin: 0;
    }

    .xr-dim-list li {
      display: inline-block;
      padding: 0;
      margin: 0;
    }

    .xr-dim-list:before {
      content: "(";
    }

    .xr-dim-list:after {
      content: ")";
    }

    .xr-dim-list li:not(:last-child):after {
      content: ",";
      padding-right: 5px;
    }

    .xr-has-index {
      font-weight: bold;
    }

    .xr-var-list,
    .xr-var-item {
      display: contents;
    }

    .xr-var-item > div,
    .xr-var-item label,
    .xr-var-item > .xr-var-name span {
      background-color: var(--xr-background-color-row-even);
      border-color: var(--xr-background-color-row-odd);
      margin-bottom: 0;
      padding-top: 2px;
    }

    .xr-var-item > .xr-var-name:hover span {
      padding-right: 5px;
    }

    .xr-var-list > li:nth-child(odd) > div,
    .xr-var-list > li:nth-child(odd) > label,
    .xr-var-list > li:nth-child(odd) > .xr-var-name span {
      background-color: var(--xr-background-color-row-odd);
      border-color: var(--xr-background-color-row-even);
    }

    .xr-var-name {
      grid-column: 1;
    }

    .xr-var-dims {
      grid-column: 2;
    }

    .xr-var-dtype {
      grid-column: 3;
      text-align: right;
      color: var(--xr-font-color2);
    }

    .xr-var-preview {
      grid-column: 4;
    }

    .xr-index-preview {
      grid-column: 2 / 5;
      color: var(--xr-font-color2);
    }

    .xr-var-name,
    .xr-var-dims,
    .xr-var-dtype,
    .xr-preview,
    .xr-attrs dt {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      padding-right: 10px;
    }

    .xr-var-name:hover,
    .xr-var-dims:hover,
    .xr-var-dtype:hover,
    .xr-attrs dt:hover {
      overflow: visible;
      width: auto;
      z-index: 1;
    }

    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      display: none;
      border-top: 2px dotted var(--xr-background-color);
      padding-bottom: 20px !important;
      padding-top: 10px !important;
    }

    .xr-var-attrs-in + label,
    .xr-var-data-in + label,
    .xr-index-data-in + label {
      padding: 0 1px;
    }

    .xr-var-attrs-in:checked ~ .xr-var-attrs,
    .xr-var-data-in:checked ~ .xr-var-data,
    .xr-index-data-in:checked ~ .xr-index-data {
      display: block;
    }

    .xr-var-data > table {
      float: right;
    }

    .xr-var-data > pre,
    .xr-index-data > pre,
    .xr-var-data > table > tbody > tr {
      background-color: transparent !important;
    }

    .xr-var-name span,
    .xr-var-data,
    .xr-index-name div,
    .xr-index-data,
    .xr-attrs {
      padding-left: 25px !important;
    }

    .xr-attrs,
    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      grid-column: 1 / -1;
    }

    dl.xr-attrs {
      padding: 0;
      margin: 0;
      display: grid;
      grid-template-columns: 125px auto;
    }

    .xr-attrs dt,
    .xr-attrs dd {
      padding: 0;
      margin: 0;
      float: left;
      padding-right: 10px;
      width: auto;
    }

    .xr-attrs dt {
      font-weight: normal;
      grid-column: 1;
    }

    .xr-attrs dt:hover span {
      display: inline-block;
      background: var(--xr-background-color);
      padding-right: 10px;
    }

    .xr-attrs dd {
      grid-column: 2;
      white-space: pre-wrap;
      word-break: break-all;
    }

    .xr-icon-database,
    .xr-icon-file-text2,
    .xr-no-icon {
      display: inline-block;
      vertical-align: middle;
      width: 1em;
      height: 1.5em !important;
      stroke-width: 0;
      stroke: currentColor;
      fill: currentColor;
    }

    .xr-var-attrs-in:checked + label > .xr-icon-file-text2,
    .xr-var-data-in:checked + label > .xr-icon-database,
    .xr-index-data-in:checked + label > .xr-icon-database {
      color: var(--xr-font-color0);
      filter: drop-shadow(1px 1px 5px var(--xr-font-color2));
      stroke-width: 0.8px;
    }
    </style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;olr&#x27; (time: 730, lat: 40, lon: 72)&gt; Size: 8MB
    [2102400 values with dtype=float32]
    Coordinates:
      * time       (time) datetime64[ns] 6kB 2017-01-01T12:00:00 ... 2018-12-31T1...
      * lat        (lat) float32 160B -19.5 -18.5 -17.5 -16.5 ... 17.5 18.5 19.5
      * lon        (lon) float32 288B 0.5 5.5 10.5 15.5 ... 340.5 345.5 350.5 355.5
        dayofyear  (time) int64 6kB ...
    Attributes:
        standard_name:  toa_outgoing_longwave_flux
        long_name:      NOAA Climate Data Record of Daily Mean Upward Longwave Fl...
        units:          W m-2
        cell_methods:   time: mean area: mean</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-obj-name'>&#x27;olr&#x27;</div><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 730</li><li><span class='xr-has-index'>lat</span>: 40</li><li><span class='xr-has-index'>lon</span>: 72</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-b0473911-b15f-4839-8c7c-a851e8e88830' class='xr-array-in' type='checkbox' checked><label for='section-b0473911-b15f-4839-8c7c-a851e8e88830' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>...</span></div><div class='xr-array-data'><pre>[2102400 values with dtype=float32]</pre></div></div></li><li class='xr-section-item'><input id='section-6bcfe901-9089-470e-878f-14471f6e0cc1' class='xr-section-summary-in' type='checkbox'  checked><label for='section-6bcfe901-9089-470e-878f-14471f6e0cc1' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2017-01-01T12:00:00 ... 2018-12-...</div><input id='attrs-499f3ab0-d17d-47d8-aaa7-60e8b14f3ee5' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-499f3ab0-d17d-47d8-aaa7-60e8b14f3ee5' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7ab10a7b-f25e-4d10-837a-72521a01adc2' class='xr-var-data-in' type='checkbox'><label for='data-7ab10a7b-f25e-4d10-837a-72521a01adc2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>time</dd><dt><span>long_name :</span></dt><dd>reference time</dd><dt><span>bounds :</span></dt><dd>time_bnds</dd><dt><span>axis :</span></dt><dd>T</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;2017-01-01T12:00:00.000000000&#x27;, &#x27;2017-01-02T12:00:00.000000000&#x27;,
           &#x27;2017-01-03T12:00:00.000000000&#x27;, ..., &#x27;2018-12-29T12:00:00.000000000&#x27;,
           &#x27;2018-12-30T12:00:00.000000000&#x27;, &#x27;2018-12-31T12:00:00.000000000&#x27;],
          shape=(730,), dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-19.5 -18.5 -17.5 ... 18.5 19.5</div><input id='attrs-3734a1bd-22e7-4402-b654-45cf873cb0fa' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-3734a1bd-22e7-4402-b654-45cf873cb0fa' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9397dd87-3a22-4bf2-ac40-1e39a24b764f' class='xr-var-data-in' type='checkbox'><label for='data-9397dd87-3a22-4bf2-ac40-1e39a24b764f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>long_name :</span></dt><dd>latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>axis :</span></dt><dd>Y</dd><dt><span>bounds :</span></dt><dd>lat_bnds</dd></dl></div><div class='xr-var-data'><pre>array([-19.5, -18.5, -17.5, -16.5, -15.5, -14.5, -13.5, -12.5, -11.5, -10.5,
            -9.5,  -8.5,  -7.5,  -6.5,  -5.5,  -4.5,  -3.5,  -2.5,  -1.5,  -0.5,
             0.5,   1.5,   2.5,   3.5,   4.5,   5.5,   6.5,   7.5,   8.5,   9.5,
            10.5,  11.5,  12.5,  13.5,  14.5,  15.5,  16.5,  17.5,  18.5,  19.5],
          dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.5 5.5 10.5 ... 345.5 350.5 355.5</div><input id='attrs-a3b688db-9b76-45cc-b2ff-de3bf8a5f555' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-a3b688db-9b76-45cc-b2ff-de3bf8a5f555' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-bee69c2e-32ec-4481-9552-60fc9b7695cd' class='xr-var-data-in' type='checkbox'><label for='data-bee69c2e-32ec-4481-9552-60fc9b7695cd' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>long_name :</span></dt><dd>longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>axis :</span></dt><dd>X</dd><dt><span>bounds :</span></dt><dd>lon_bnds</dd></dl></div><div class='xr-var-data'><pre>array([  0.5,   5.5,  10.5,  15.5,  20.5,  25.5,  30.5,  35.5,  40.5,  45.5,
            50.5,  55.5,  60.5,  65.5,  70.5,  75.5,  80.5,  85.5,  90.5,  95.5,
           100.5, 105.5, 110.5, 115.5, 120.5, 125.5, 130.5, 135.5, 140.5, 145.5,
           150.5, 155.5, 160.5, 165.5, 170.5, 175.5, 180.5, 185.5, 190.5, 195.5,
           200.5, 205.5, 210.5, 215.5, 220.5, 225.5, 230.5, 235.5, 240.5, 245.5,
           250.5, 255.5, 260.5, 265.5, 270.5, 275.5, 280.5, 285.5, 290.5, 295.5,
           300.5, 305.5, 310.5, 315.5, 320.5, 325.5, 330.5, 335.5, 340.5, 345.5,
           350.5, 355.5], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dayofyear</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-265584fe-0c2d-4e7c-99af-2a1c36b68890' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-265584fe-0c2d-4e7c-99af-2a1c36b68890' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7894febe-5044-46a8-a242-e30c24d152a9' class='xr-var-data-in' type='checkbox'><label for='data-7894febe-5044-46a8-a242-e30c24d152a9' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>time</dd><dt><span>long_name :</span></dt><dd>reference time</dd><dt><span>bounds :</span></dt><dd>time_bnds</dd><dt><span>axis :</span></dt><dd>T</dd></dl></div><div class='xr-var-data'><pre>[730 values with dtype=int64]</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-fc01da4c-cd79-4eb3-a046-fbd33c1ea13e' class='xr-section-summary-in' type='checkbox'  checked><label for='section-fc01da4c-cd79-4eb3-a046-fbd33c1ea13e' class='xr-section-summary' >Attributes: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>toa_outgoing_longwave_flux</dd><dt><span>long_name :</span></dt><dd>NOAA Climate Data Record of Daily Mean Upward Longwave Flux at Top of the Atmosphere</dd><dt><span>units :</span></dt><dd>W m-2</dd><dt><span>cell_methods :</span></dt><dd>time: mean area: mean</dd></dl></div></li></ul></div></div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 63-65

Filtering equatorial waves with ``kf_filter``


.. GENERATED FROM PYTHON SOURCE LINES 65-74

.. code-block:: Python

    lf_result = ecl.filter.kf_filter_lf_wave(olr_data_interpolated, steps_per_day = 1)
    mjo_result = ecl.filter.kf_filter_mjo_wave(olr_data_interpolated, steps_per_day = 1)
    er_result = ecl.filter.kf_filter_er_wave(olr_data_interpolated, steps_per_day = 1)
    kelvin_result = ecl.filter.kf_filter_kelvin_wave(olr_data_interpolated, steps_per_day = 1)
    mt_result = ecl.filter.kf_filter_mt_wave(olr_data_interpolated, steps_per_day = 1)
    mrg_result = ecl.filter.kf_filter_mrg_wave(olr_data_interpolated, steps_per_day = 1)
    td_result = ecl.filter.kf_filter_td_wave(olr_data_interpolated, steps_per_day = 1)
    lf_result





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    /home/runner/work/easyclimate/easyclimate/src/easyclimate/filter/kf_filter.py:212: RuntimeWarning: invalid value encountered in sqrt
      freq = (beta * c) ** 0.5
    /home/runner/work/easyclimate/easyclimate/src/easyclimate/filter/kf_filter.py:215: RuntimeWarning: invalid value encountered in sqrt
      freq = k * c * (0.5 + 0.5 * (1 + 4 * beta / (k**2 * c)) ** 0.5)
    /home/runner/work/easyclimate/easyclimate/src/easyclimate/filter/kf_filter.py:217: RuntimeWarning: invalid value encountered in sqrt
      freq = k * c * (0.5 - 0.5 * (1 + 4 * beta / (k**2 * c)) ** 0.5)


.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
    <defs>
    <symbol id="icon-database" viewBox="0 0 32 32">
    <path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
    <path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    <path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    </symbol>
    <symbol id="icon-file-text2" viewBox="0 0 32 32">
    <path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
    <path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    </symbol>
    </defs>
    </svg>
    <style>/* CSS stylesheet for displaying xarray objects in notebooks */

    :root {
      --xr-font-color0: var(
        --jp-content-font-color0,
        var(--pst-color-text-base rgba(0, 0, 0, 1))
      );
      --xr-font-color2: var(
        --jp-content-font-color2,
        var(--pst-color-text-base, rgba(0, 0, 0, 0.54))
      );
      --xr-font-color3: var(
        --jp-content-font-color3,
        var(--pst-color-text-base, rgba(0, 0, 0, 0.38))
      );
      --xr-border-color: var(
        --jp-border-color2,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 10))
      );
      --xr-disabled-color: var(
        --jp-layout-color3,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 40))
      );
      --xr-background-color: var(
        --jp-layout-color0,
        var(--pst-color-on-background, white)
      );
      --xr-background-color-row-even: var(
        --jp-layout-color1,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 5))
      );
      --xr-background-color-row-odd: var(
        --jp-layout-color2,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 15))
      );
    }

    html[theme="dark"],
    html[data-theme="dark"],
    body[data-theme="dark"],
    body.vscode-dark {
      --xr-font-color0: var(
        --jp-content-font-color0,
        var(--pst-color-text-base, rgba(255, 255, 255, 1))
      );
      --xr-font-color2: var(
        --jp-content-font-color2,
        var(--pst-color-text-base, rgba(255, 255, 255, 0.54))
      );
      --xr-font-color3: var(
        --jp-content-font-color3,
        var(--pst-color-text-base, rgba(255, 255, 255, 0.38))
      );
      --xr-border-color: var(
        --jp-border-color2,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))
      );
      --xr-disabled-color: var(
        --jp-layout-color3,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))
      );
      --xr-background-color: var(
        --jp-layout-color0,
        var(--pst-color-on-background, #111111)
      );
      --xr-background-color-row-even: var(
        --jp-layout-color1,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))
      );
      --xr-background-color-row-odd: var(
        --jp-layout-color2,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))
      );
    }

    .xr-wrap {
      display: block !important;
      min-width: 300px;
      max-width: 700px;
      line-height: 1.6;
    }

    .xr-text-repr-fallback {
      /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
      display: none;
    }

    .xr-header {
      padding-top: 6px;
      padding-bottom: 6px;
      margin-bottom: 4px;
      border-bottom: solid 1px var(--xr-border-color);
    }

    .xr-header > div,
    .xr-header > ul {
      display: inline;
      margin-top: 0;
      margin-bottom: 0;
    }

    .xr-obj-type,
    .xr-obj-name,
    .xr-group-name {
      margin-left: 2px;
      margin-right: 10px;
    }

    .xr-group-name::before {
      content: "üìÅ";
      padding-right: 0.3em;
    }

    .xr-group-name,
    .xr-obj-type {
      color: var(--xr-font-color2);
    }

    .xr-sections {
      padding-left: 0 !important;
      display: grid;
      grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
      margin-block-start: 0;
      margin-block-end: 0;
    }

    .xr-section-item {
      display: contents;
    }

    .xr-section-item input {
      display: inline-block;
      opacity: 0;
      height: 0;
      margin: 0;
    }

    .xr-section-item input + label {
      color: var(--xr-disabled-color);
      border: 2px solid transparent !important;
    }

    .xr-section-item input:enabled + label {
      cursor: pointer;
      color: var(--xr-font-color2);
    }

    .xr-section-item input:focus + label {
      border: 2px solid var(--xr-font-color0) !important;
    }

    .xr-section-item input:enabled + label:hover {
      color: var(--xr-font-color0);
    }

    .xr-section-summary {
      grid-column: 1;
      color: var(--xr-font-color2);
      font-weight: 500;
    }

    .xr-section-summary > span {
      display: inline-block;
      padding-left: 0.5em;
    }

    .xr-section-summary-in:disabled + label {
      color: var(--xr-font-color2);
    }

    .xr-section-summary-in + label:before {
      display: inline-block;
      content: "‚ñ∫";
      font-size: 11px;
      width: 15px;
      text-align: center;
    }

    .xr-section-summary-in:disabled + label:before {
      color: var(--xr-disabled-color);
    }

    .xr-section-summary-in:checked + label:before {
      content: "‚ñº";
    }

    .xr-section-summary-in:checked + label > span {
      display: none;
    }

    .xr-section-summary,
    .xr-section-inline-details {
      padding-top: 4px;
    }

    .xr-section-inline-details {
      grid-column: 2 / -1;
    }

    .xr-section-details {
      display: none;
      grid-column: 1 / -1;
      margin-top: 4px;
      margin-bottom: 5px;
    }

    .xr-section-summary-in:checked ~ .xr-section-details {
      display: contents;
    }

    .xr-group-box {
      display: inline-grid;
      grid-template-columns: 0px 20px auto;
      width: 100%;
    }

    .xr-group-box-vline {
      grid-column-start: 1;
      border-right: 0.2em solid;
      border-color: var(--xr-border-color);
      width: 0px;
    }

    .xr-group-box-hline {
      grid-column-start: 2;
      grid-row-start: 1;
      height: 1em;
      width: 20px;
      border-bottom: 0.2em solid;
      border-color: var(--xr-border-color);
    }

    .xr-group-box-contents {
      grid-column-start: 3;
    }

    .xr-array-wrap {
      grid-column: 1 / -1;
      display: grid;
      grid-template-columns: 20px auto;
    }

    .xr-array-wrap > label {
      grid-column: 1;
      vertical-align: top;
    }

    .xr-preview {
      color: var(--xr-font-color3);
    }

    .xr-array-preview,
    .xr-array-data {
      padding: 0 5px !important;
      grid-column: 2;
    }

    .xr-array-data,
    .xr-array-in:checked ~ .xr-array-preview {
      display: none;
    }

    .xr-array-in:checked ~ .xr-array-data,
    .xr-array-preview {
      display: inline-block;
    }

    .xr-dim-list {
      display: inline-block !important;
      list-style: none;
      padding: 0 !important;
      margin: 0;
    }

    .xr-dim-list li {
      display: inline-block;
      padding: 0;
      margin: 0;
    }

    .xr-dim-list:before {
      content: "(";
    }

    .xr-dim-list:after {
      content: ")";
    }

    .xr-dim-list li:not(:last-child):after {
      content: ",";
      padding-right: 5px;
    }

    .xr-has-index {
      font-weight: bold;
    }

    .xr-var-list,
    .xr-var-item {
      display: contents;
    }

    .xr-var-item > div,
    .xr-var-item label,
    .xr-var-item > .xr-var-name span {
      background-color: var(--xr-background-color-row-even);
      border-color: var(--xr-background-color-row-odd);
      margin-bottom: 0;
      padding-top: 2px;
    }

    .xr-var-item > .xr-var-name:hover span {
      padding-right: 5px;
    }

    .xr-var-list > li:nth-child(odd) > div,
    .xr-var-list > li:nth-child(odd) > label,
    .xr-var-list > li:nth-child(odd) > .xr-var-name span {
      background-color: var(--xr-background-color-row-odd);
      border-color: var(--xr-background-color-row-even);
    }

    .xr-var-name {
      grid-column: 1;
    }

    .xr-var-dims {
      grid-column: 2;
    }

    .xr-var-dtype {
      grid-column: 3;
      text-align: right;
      color: var(--xr-font-color2);
    }

    .xr-var-preview {
      grid-column: 4;
    }

    .xr-index-preview {
      grid-column: 2 / 5;
      color: var(--xr-font-color2);
    }

    .xr-var-name,
    .xr-var-dims,
    .xr-var-dtype,
    .xr-preview,
    .xr-attrs dt {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      padding-right: 10px;
    }

    .xr-var-name:hover,
    .xr-var-dims:hover,
    .xr-var-dtype:hover,
    .xr-attrs dt:hover {
      overflow: visible;
      width: auto;
      z-index: 1;
    }

    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      display: none;
      border-top: 2px dotted var(--xr-background-color);
      padding-bottom: 20px !important;
      padding-top: 10px !important;
    }

    .xr-var-attrs-in + label,
    .xr-var-data-in + label,
    .xr-index-data-in + label {
      padding: 0 1px;
    }

    .xr-var-attrs-in:checked ~ .xr-var-attrs,
    .xr-var-data-in:checked ~ .xr-var-data,
    .xr-index-data-in:checked ~ .xr-index-data {
      display: block;
    }

    .xr-var-data > table {
      float: right;
    }

    .xr-var-data > pre,
    .xr-index-data > pre,
    .xr-var-data > table > tbody > tr {
      background-color: transparent !important;
    }

    .xr-var-name span,
    .xr-var-data,
    .xr-index-name div,
    .xr-index-data,
    .xr-attrs {
      padding-left: 25px !important;
    }

    .xr-attrs,
    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      grid-column: 1 / -1;
    }

    dl.xr-attrs {
      padding: 0;
      margin: 0;
      display: grid;
      grid-template-columns: 125px auto;
    }

    .xr-attrs dt,
    .xr-attrs dd {
      padding: 0;
      margin: 0;
      float: left;
      padding-right: 10px;
      width: auto;
    }

    .xr-attrs dt {
      font-weight: normal;
      grid-column: 1;
    }

    .xr-attrs dt:hover span {
      display: inline-block;
      background: var(--xr-background-color);
      padding-right: 10px;
    }

    .xr-attrs dd {
      grid-column: 2;
      white-space: pre-wrap;
      word-break: break-all;
    }

    .xr-icon-database,
    .xr-icon-file-text2,
    .xr-no-icon {
      display: inline-block;
      vertical-align: middle;
      width: 1em;
      height: 1.5em !important;
      stroke-width: 0;
      stroke: currentColor;
      fill: currentColor;
    }

    .xr-var-attrs-in:checked + label > .xr-icon-file-text2,
    .xr-var-data-in:checked + label > .xr-icon-database,
    .xr-index-data-in:checked + label > .xr-icon-database {
      color: var(--xr-font-color0);
      filter: drop-shadow(1px 1px 5px var(--xr-font-color2));
      stroke-width: 0.8px;
    }
    </style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;olr&#x27; (lat: 40, time: 730, lon: 72)&gt; Size: 17MB
    array([[[-2.32703094, -1.08666594, -2.40137572, ..., -2.88243589,
             -4.13795167, -3.8134417 ],
            [-2.44853239, -1.2718925 , -2.66297486, ..., -2.70843669,
             -3.98720919, -3.78270101],
            [-2.565229  , -1.45492335, -2.92488144, ..., -2.53113294,
             -3.8338216 , -3.74859289],
            ...,
            [-1.93592457, -0.52137343, -1.62279677, ..., -3.38149611,
             -4.57130514, -3.88459657],
            [-2.0704913 , -0.71104366, -1.88085224, ..., -3.21926823,
             -4.43029342, -3.86446764],
            [-2.20094079, -0.89959644, -2.1405228 , ..., -3.0528154 ,
             -4.2857455 , -3.84072468]],

           [[-2.85782587, -1.80721499, -2.43663707, ..., -3.89285024,
             -4.22983105, -3.13060803],
            [-3.00070127, -2.02241915, -2.74226962, ..., -3.70570675,
             -4.10835948, -3.14111651],
            [-3.13839696, -2.23468586, -3.04888902, ..., -3.51420666,
             -3.98473684, -3.1493203 ],
    ...
            [ 3.39455852, -1.33271312, -6.04567993, ...,  8.37708092,
              5.79219709,  2.71448836],
            [ 3.45290232, -1.43679532, -5.97934496, ...,  8.61588977,
              5.90021046,  2.77505596],
            [ 3.51140973, -1.53658624, -5.90499781, ...,  8.84323732,
              5.99844567,  2.82998422]],

           [[ 3.3085757 ,  0.76006205, -4.75053671, ..., 11.91868516,
              7.7514486 ,  4.53965341],
            [ 3.38972171,  0.68563329, -4.74060982, ..., 12.10472066,
              7.78897082,  4.52123228],
            [ 3.47230554,  0.61598577, -4.72311547, ..., 12.27653838,
              7.81478878,  4.49610418],
            ...,
            [ 3.07241953,  1.00717408, -4.73601331, ..., 11.27983002,
              7.56891284,  4.55223323],
            [ 3.15006811,  0.92133144, -4.74811349, ..., 11.50576357,
              7.64137377,  4.55538473],
            [ 3.22873756,  0.83879243, -4.75299874, ..., 11.71887733,
              7.70223766,  4.5511168 ]]], shape=(40, 730, 72))
    Coordinates:
      * lat        (lat) float32 160B -19.5 -18.5 -17.5 -16.5 ... 17.5 18.5 19.5
      * time       (time) datetime64[ns] 6kB 2017-01-01T12:00:00 ... 2018-12-31T1...
      * lon        (lon) float32 288B 0.5 5.5 10.5 15.5 ... 340.5 345.5 350.5 355.5
        dayofyear  (time) int64 6kB ...
    Attributes:
        wavenumber:  [-999, -999]
        period:      [120, -999]
        depth:       [-999, -999] m
        waveName:    None</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-obj-name'>&#x27;olr&#x27;</div><ul class='xr-dim-list'><li><span class='xr-has-index'>lat</span>: 40</li><li><span class='xr-has-index'>time</span>: 730</li><li><span class='xr-has-index'>lon</span>: 72</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-be5b5cfb-bd6a-4933-bf7c-2428c5eba8ca' class='xr-array-in' type='checkbox' checked><label for='section-be5b5cfb-bd6a-4933-bf7c-2428c5eba8ca' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>-2.327 -1.087 -2.401 -0.5945 1.091 ... 7.959 10.47 11.72 7.702 4.551</span></div><div class='xr-array-data'><pre>array([[[-2.32703094, -1.08666594, -2.40137572, ..., -2.88243589,
             -4.13795167, -3.8134417 ],
            [-2.44853239, -1.2718925 , -2.66297486, ..., -2.70843669,
             -3.98720919, -3.78270101],
            [-2.565229  , -1.45492335, -2.92488144, ..., -2.53113294,
             -3.8338216 , -3.74859289],
            ...,
            [-1.93592457, -0.52137343, -1.62279677, ..., -3.38149611,
             -4.57130514, -3.88459657],
            [-2.0704913 , -0.71104366, -1.88085224, ..., -3.21926823,
             -4.43029342, -3.86446764],
            [-2.20094079, -0.89959644, -2.1405228 , ..., -3.0528154 ,
             -4.2857455 , -3.84072468]],

           [[-2.85782587, -1.80721499, -2.43663707, ..., -3.89285024,
             -4.22983105, -3.13060803],
            [-3.00070127, -2.02241915, -2.74226962, ..., -3.70570675,
             -4.10835948, -3.14111651],
            [-3.13839696, -2.23468586, -3.04888902, ..., -3.51420666,
             -3.98473684, -3.1493203 ],
    ...
            [ 3.39455852, -1.33271312, -6.04567993, ...,  8.37708092,
              5.79219709,  2.71448836],
            [ 3.45290232, -1.43679532, -5.97934496, ...,  8.61588977,
              5.90021046,  2.77505596],
            [ 3.51140973, -1.53658624, -5.90499781, ...,  8.84323732,
              5.99844567,  2.82998422]],

           [[ 3.3085757 ,  0.76006205, -4.75053671, ..., 11.91868516,
              7.7514486 ,  4.53965341],
            [ 3.38972171,  0.68563329, -4.74060982, ..., 12.10472066,
              7.78897082,  4.52123228],
            [ 3.47230554,  0.61598577, -4.72311547, ..., 12.27653838,
              7.81478878,  4.49610418],
            ...,
            [ 3.07241953,  1.00717408, -4.73601331, ..., 11.27983002,
              7.56891284,  4.55223323],
            [ 3.15006811,  0.92133144, -4.74811349, ..., 11.50576357,
              7.64137377,  4.55538473],
            [ 3.22873756,  0.83879243, -4.75299874, ..., 11.71887733,
              7.70223766,  4.5511168 ]]], shape=(40, 730, 72))</pre></div></div></li><li class='xr-section-item'><input id='section-6181790b-9eeb-432d-a58e-73244c5a0cb4' class='xr-section-summary-in' type='checkbox'  checked><label for='section-6181790b-9eeb-432d-a58e-73244c5a0cb4' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-19.5 -18.5 -17.5 ... 18.5 19.5</div><input id='attrs-8d941d86-300d-427b-99f1-b98eae1eddc5' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-8d941d86-300d-427b-99f1-b98eae1eddc5' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-301a0399-66ef-4ba3-bfcc-026558b7c89d' class='xr-var-data-in' type='checkbox'><label for='data-301a0399-66ef-4ba3-bfcc-026558b7c89d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>long_name :</span></dt><dd>latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>axis :</span></dt><dd>Y</dd><dt><span>bounds :</span></dt><dd>lat_bnds</dd></dl></div><div class='xr-var-data'><pre>array([-19.5, -18.5, -17.5, -16.5, -15.5, -14.5, -13.5, -12.5, -11.5, -10.5,
            -9.5,  -8.5,  -7.5,  -6.5,  -5.5,  -4.5,  -3.5,  -2.5,  -1.5,  -0.5,
             0.5,   1.5,   2.5,   3.5,   4.5,   5.5,   6.5,   7.5,   8.5,   9.5,
            10.5,  11.5,  12.5,  13.5,  14.5,  15.5,  16.5,  17.5,  18.5,  19.5],
          dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2017-01-01T12:00:00 ... 2018-12-...</div><input id='attrs-9a0be67f-b144-40fd-be6e-e4b74af04d3a' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-9a0be67f-b144-40fd-be6e-e4b74af04d3a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0e9e6e11-3fa1-4910-b9fb-a0a1e8283be0' class='xr-var-data-in' type='checkbox'><label for='data-0e9e6e11-3fa1-4910-b9fb-a0a1e8283be0' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>time</dd><dt><span>long_name :</span></dt><dd>reference time</dd><dt><span>bounds :</span></dt><dd>time_bnds</dd><dt><span>axis :</span></dt><dd>T</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;2017-01-01T12:00:00.000000000&#x27;, &#x27;2017-01-02T12:00:00.000000000&#x27;,
           &#x27;2017-01-03T12:00:00.000000000&#x27;, ..., &#x27;2018-12-29T12:00:00.000000000&#x27;,
           &#x27;2018-12-30T12:00:00.000000000&#x27;, &#x27;2018-12-31T12:00:00.000000000&#x27;],
          shape=(730,), dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.5 5.5 10.5 ... 345.5 350.5 355.5</div><input id='attrs-c9d24ec7-54f3-4abc-87a8-2062d87af8d4' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-c9d24ec7-54f3-4abc-87a8-2062d87af8d4' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-db5bdf58-507b-4812-b8c0-f83b22f72770' class='xr-var-data-in' type='checkbox'><label for='data-db5bdf58-507b-4812-b8c0-f83b22f72770' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>long_name :</span></dt><dd>longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>axis :</span></dt><dd>X</dd><dt><span>bounds :</span></dt><dd>lon_bnds</dd></dl></div><div class='xr-var-data'><pre>array([  0.5,   5.5,  10.5,  15.5,  20.5,  25.5,  30.5,  35.5,  40.5,  45.5,
            50.5,  55.5,  60.5,  65.5,  70.5,  75.5,  80.5,  85.5,  90.5,  95.5,
           100.5, 105.5, 110.5, 115.5, 120.5, 125.5, 130.5, 135.5, 140.5, 145.5,
           150.5, 155.5, 160.5, 165.5, 170.5, 175.5, 180.5, 185.5, 190.5, 195.5,
           200.5, 205.5, 210.5, 215.5, 220.5, 225.5, 230.5, 235.5, 240.5, 245.5,
           250.5, 255.5, 260.5, 265.5, 270.5, 275.5, 280.5, 285.5, 290.5, 295.5,
           300.5, 305.5, 310.5, 315.5, 320.5, 325.5, 330.5, 335.5, 340.5, 345.5,
           350.5, 355.5], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dayofyear</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-d57d06fc-2a3e-49b6-990a-04b28db4d7b1' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-d57d06fc-2a3e-49b6-990a-04b28db4d7b1' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-bbbec586-7406-40b6-8941-fc77e43590b2' class='xr-var-data-in' type='checkbox'><label for='data-bbbec586-7406-40b6-8941-fc77e43590b2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>time</dd><dt><span>long_name :</span></dt><dd>reference time</dd><dt><span>bounds :</span></dt><dd>time_bnds</dd><dt><span>axis :</span></dt><dd>T</dd></dl></div><div class='xr-var-data'><pre>[730 values with dtype=int64]</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-5d2fc87c-8901-4e3f-b020-0ed1559a3ef5' class='xr-section-summary-in' type='checkbox'  checked><label for='section-5d2fc87c-8901-4e3f-b020-0ed1559a3ef5' class='xr-section-summary' >Attributes: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>wavenumber :</span></dt><dd>[-999, -999]</dd><dt><span>period :</span></dt><dd>[120, -999]</dd><dt><span>depth :</span></dt><dd>[-999, -999] m</dd><dt><span>waveName :</span></dt><dd>None</dd></dl></div></li></ul></div></div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 75-76

Extract data in a specified time range

.. GENERATED FROM PYTHON SOURCE LINES 76-85

.. code-block:: Python

    time1, time2 = '2017-12-01', '2018-02-28'
    lon1, lon2, lats, latn = 39, 181, 5, 15

    mjo_result_ave = mjo_result.sel(time=slice(time1,time2),lat=slice(lats,latn),lon=slice(lon1,lon2)).mean(dim = 'lat')
    mrg_result_ave = mrg_result.sel(time=slice(time1,time2),lat=slice(lats,latn),lon=slice(lon1,lon2)).mean(dim = 'lat')
    td_result_ave = td_result.sel(time=slice(time1,time2),lat=slice(lats,latn),lon=slice(lon1,lon2)).mean(dim = 'lat')
    lf_result_ave = lf_result.sel(time=slice(time1,time2),lat=slice(lats,latn),lon=slice(lon1,lon2)).mean(dim = 'lat')
    lf_result_ave






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
    <defs>
    <symbol id="icon-database" viewBox="0 0 32 32">
    <path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
    <path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    <path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    </symbol>
    <symbol id="icon-file-text2" viewBox="0 0 32 32">
    <path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
    <path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    </symbol>
    </defs>
    </svg>
    <style>/* CSS stylesheet for displaying xarray objects in notebooks */

    :root {
      --xr-font-color0: var(
        --jp-content-font-color0,
        var(--pst-color-text-base rgba(0, 0, 0, 1))
      );
      --xr-font-color2: var(
        --jp-content-font-color2,
        var(--pst-color-text-base, rgba(0, 0, 0, 0.54))
      );
      --xr-font-color3: var(
        --jp-content-font-color3,
        var(--pst-color-text-base, rgba(0, 0, 0, 0.38))
      );
      --xr-border-color: var(
        --jp-border-color2,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 10))
      );
      --xr-disabled-color: var(
        --jp-layout-color3,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 40))
      );
      --xr-background-color: var(
        --jp-layout-color0,
        var(--pst-color-on-background, white)
      );
      --xr-background-color-row-even: var(
        --jp-layout-color1,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 5))
      );
      --xr-background-color-row-odd: var(
        --jp-layout-color2,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 15))
      );
    }

    html[theme="dark"],
    html[data-theme="dark"],
    body[data-theme="dark"],
    body.vscode-dark {
      --xr-font-color0: var(
        --jp-content-font-color0,
        var(--pst-color-text-base, rgba(255, 255, 255, 1))
      );
      --xr-font-color2: var(
        --jp-content-font-color2,
        var(--pst-color-text-base, rgba(255, 255, 255, 0.54))
      );
      --xr-font-color3: var(
        --jp-content-font-color3,
        var(--pst-color-text-base, rgba(255, 255, 255, 0.38))
      );
      --xr-border-color: var(
        --jp-border-color2,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))
      );
      --xr-disabled-color: var(
        --jp-layout-color3,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))
      );
      --xr-background-color: var(
        --jp-layout-color0,
        var(--pst-color-on-background, #111111)
      );
      --xr-background-color-row-even: var(
        --jp-layout-color1,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))
      );
      --xr-background-color-row-odd: var(
        --jp-layout-color2,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))
      );
    }

    .xr-wrap {
      display: block !important;
      min-width: 300px;
      max-width: 700px;
      line-height: 1.6;
    }

    .xr-text-repr-fallback {
      /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
      display: none;
    }

    .xr-header {
      padding-top: 6px;
      padding-bottom: 6px;
      margin-bottom: 4px;
      border-bottom: solid 1px var(--xr-border-color);
    }

    .xr-header > div,
    .xr-header > ul {
      display: inline;
      margin-top: 0;
      margin-bottom: 0;
    }

    .xr-obj-type,
    .xr-obj-name,
    .xr-group-name {
      margin-left: 2px;
      margin-right: 10px;
    }

    .xr-group-name::before {
      content: "üìÅ";
      padding-right: 0.3em;
    }

    .xr-group-name,
    .xr-obj-type {
      color: var(--xr-font-color2);
    }

    .xr-sections {
      padding-left: 0 !important;
      display: grid;
      grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
      margin-block-start: 0;
      margin-block-end: 0;
    }

    .xr-section-item {
      display: contents;
    }

    .xr-section-item input {
      display: inline-block;
      opacity: 0;
      height: 0;
      margin: 0;
    }

    .xr-section-item input + label {
      color: var(--xr-disabled-color);
      border: 2px solid transparent !important;
    }

    .xr-section-item input:enabled + label {
      cursor: pointer;
      color: var(--xr-font-color2);
    }

    .xr-section-item input:focus + label {
      border: 2px solid var(--xr-font-color0) !important;
    }

    .xr-section-item input:enabled + label:hover {
      color: var(--xr-font-color0);
    }

    .xr-section-summary {
      grid-column: 1;
      color: var(--xr-font-color2);
      font-weight: 500;
    }

    .xr-section-summary > span {
      display: inline-block;
      padding-left: 0.5em;
    }

    .xr-section-summary-in:disabled + label {
      color: var(--xr-font-color2);
    }

    .xr-section-summary-in + label:before {
      display: inline-block;
      content: "‚ñ∫";
      font-size: 11px;
      width: 15px;
      text-align: center;
    }

    .xr-section-summary-in:disabled + label:before {
      color: var(--xr-disabled-color);
    }

    .xr-section-summary-in:checked + label:before {
      content: "‚ñº";
    }

    .xr-section-summary-in:checked + label > span {
      display: none;
    }

    .xr-section-summary,
    .xr-section-inline-details {
      padding-top: 4px;
    }

    .xr-section-inline-details {
      grid-column: 2 / -1;
    }

    .xr-section-details {
      display: none;
      grid-column: 1 / -1;
      margin-top: 4px;
      margin-bottom: 5px;
    }

    .xr-section-summary-in:checked ~ .xr-section-details {
      display: contents;
    }

    .xr-group-box {
      display: inline-grid;
      grid-template-columns: 0px 20px auto;
      width: 100%;
    }

    .xr-group-box-vline {
      grid-column-start: 1;
      border-right: 0.2em solid;
      border-color: var(--xr-border-color);
      width: 0px;
    }

    .xr-group-box-hline {
      grid-column-start: 2;
      grid-row-start: 1;
      height: 1em;
      width: 20px;
      border-bottom: 0.2em solid;
      border-color: var(--xr-border-color);
    }

    .xr-group-box-contents {
      grid-column-start: 3;
    }

    .xr-array-wrap {
      grid-column: 1 / -1;
      display: grid;
      grid-template-columns: 20px auto;
    }

    .xr-array-wrap > label {
      grid-column: 1;
      vertical-align: top;
    }

    .xr-preview {
      color: var(--xr-font-color3);
    }

    .xr-array-preview,
    .xr-array-data {
      padding: 0 5px !important;
      grid-column: 2;
    }

    .xr-array-data,
    .xr-array-in:checked ~ .xr-array-preview {
      display: none;
    }

    .xr-array-in:checked ~ .xr-array-data,
    .xr-array-preview {
      display: inline-block;
    }

    .xr-dim-list {
      display: inline-block !important;
      list-style: none;
      padding: 0 !important;
      margin: 0;
    }

    .xr-dim-list li {
      display: inline-block;
      padding: 0;
      margin: 0;
    }

    .xr-dim-list:before {
      content: "(";
    }

    .xr-dim-list:after {
      content: ")";
    }

    .xr-dim-list li:not(:last-child):after {
      content: ",";
      padding-right: 5px;
    }

    .xr-has-index {
      font-weight: bold;
    }

    .xr-var-list,
    .xr-var-item {
      display: contents;
    }

    .xr-var-item > div,
    .xr-var-item label,
    .xr-var-item > .xr-var-name span {
      background-color: var(--xr-background-color-row-even);
      border-color: var(--xr-background-color-row-odd);
      margin-bottom: 0;
      padding-top: 2px;
    }

    .xr-var-item > .xr-var-name:hover span {
      padding-right: 5px;
    }

    .xr-var-list > li:nth-child(odd) > div,
    .xr-var-list > li:nth-child(odd) > label,
    .xr-var-list > li:nth-child(odd) > .xr-var-name span {
      background-color: var(--xr-background-color-row-odd);
      border-color: var(--xr-background-color-row-even);
    }

    .xr-var-name {
      grid-column: 1;
    }

    .xr-var-dims {
      grid-column: 2;
    }

    .xr-var-dtype {
      grid-column: 3;
      text-align: right;
      color: var(--xr-font-color2);
    }

    .xr-var-preview {
      grid-column: 4;
    }

    .xr-index-preview {
      grid-column: 2 / 5;
      color: var(--xr-font-color2);
    }

    .xr-var-name,
    .xr-var-dims,
    .xr-var-dtype,
    .xr-preview,
    .xr-attrs dt {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      padding-right: 10px;
    }

    .xr-var-name:hover,
    .xr-var-dims:hover,
    .xr-var-dtype:hover,
    .xr-attrs dt:hover {
      overflow: visible;
      width: auto;
      z-index: 1;
    }

    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      display: none;
      border-top: 2px dotted var(--xr-background-color);
      padding-bottom: 20px !important;
      padding-top: 10px !important;
    }

    .xr-var-attrs-in + label,
    .xr-var-data-in + label,
    .xr-index-data-in + label {
      padding: 0 1px;
    }

    .xr-var-attrs-in:checked ~ .xr-var-attrs,
    .xr-var-data-in:checked ~ .xr-var-data,
    .xr-index-data-in:checked ~ .xr-index-data {
      display: block;
    }

    .xr-var-data > table {
      float: right;
    }

    .xr-var-data > pre,
    .xr-index-data > pre,
    .xr-var-data > table > tbody > tr {
      background-color: transparent !important;
    }

    .xr-var-name span,
    .xr-var-data,
    .xr-index-name div,
    .xr-index-data,
    .xr-attrs {
      padding-left: 25px !important;
    }

    .xr-attrs,
    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      grid-column: 1 / -1;
    }

    dl.xr-attrs {
      padding: 0;
      margin: 0;
      display: grid;
      grid-template-columns: 125px auto;
    }

    .xr-attrs dt,
    .xr-attrs dd {
      padding: 0;
      margin: 0;
      float: left;
      padding-right: 10px;
      width: auto;
    }

    .xr-attrs dt {
      font-weight: normal;
      grid-column: 1;
    }

    .xr-attrs dt:hover span {
      display: inline-block;
      background: var(--xr-background-color);
      padding-right: 10px;
    }

    .xr-attrs dd {
      grid-column: 2;
      white-space: pre-wrap;
      word-break: break-all;
    }

    .xr-icon-database,
    .xr-icon-file-text2,
    .xr-no-icon {
      display: inline-block;
      vertical-align: middle;
      width: 1em;
      height: 1.5em !important;
      stroke-width: 0;
      stroke: currentColor;
      fill: currentColor;
    }

    .xr-var-attrs-in:checked + label > .xr-icon-file-text2,
    .xr-var-data-in:checked + label > .xr-icon-database,
    .xr-index-data-in:checked + label > .xr-icon-database {
      color: var(--xr-font-color0);
      filter: drop-shadow(1px 1px 5px var(--xr-font-color2));
      stroke-width: 0.8px;
    }
    </style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;olr&#x27; (time: 90, lon: 29)&gt; Size: 21kB
    array([[ 7.00596819,  4.20734533,  9.81327741, ...,  3.08308952,
             6.43874229,  7.21068365],
           [ 7.19987092,  4.34243567,  9.8258908 , ...,  3.17001833,
             6.49791331,  7.32667326],
           [ 7.38688198,  4.47578285,  9.82823522, ...,  3.25575246,
             6.55230979,  7.4364893 ],
           ...,
           [-1.72686133, -0.97142549, -0.15921378, ..., -6.98142383,
            -5.79331014, -4.62624251],
           [-2.0120113 , -1.33091801, -0.33071156, ..., -7.25684753,
            -5.98326832, -4.84648253],
           [-2.29662459, -1.69610103, -0.50888872, ..., -7.53098335,
            -6.17071102, -5.06496685]], shape=(90, 29))
    Coordinates:
      * time       (time) datetime64[ns] 720B 2017-12-01T12:00:00 ... 2018-02-28T...
      * lon        (lon) float32 116B 40.5 45.5 50.5 55.5 ... 170.5 175.5 180.5
        dayofyear  (time) int64 720B ...
    Attributes:
        wavenumber:  [-999, -999]
        period:      [120, -999]
        depth:       [-999, -999] m
        waveName:    None</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-obj-name'>&#x27;olr&#x27;</div><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 90</li><li><span class='xr-has-index'>lon</span>: 29</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-b96ae73d-54c0-4015-a526-90d52f61e4e4' class='xr-array-in' type='checkbox' checked><label for='section-b96ae73d-54c0-4015-a526-90d52f61e4e4' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>7.006 4.207 9.813 12.84 10.77 ... -11.21 -7.464 -7.531 -6.171 -5.065</span></div><div class='xr-array-data'><pre>array([[ 7.00596819,  4.20734533,  9.81327741, ...,  3.08308952,
             6.43874229,  7.21068365],
           [ 7.19987092,  4.34243567,  9.8258908 , ...,  3.17001833,
             6.49791331,  7.32667326],
           [ 7.38688198,  4.47578285,  9.82823522, ...,  3.25575246,
             6.55230979,  7.4364893 ],
           ...,
           [-1.72686133, -0.97142549, -0.15921378, ..., -6.98142383,
            -5.79331014, -4.62624251],
           [-2.0120113 , -1.33091801, -0.33071156, ..., -7.25684753,
            -5.98326832, -4.84648253],
           [-2.29662459, -1.69610103, -0.50888872, ..., -7.53098335,
            -6.17071102, -5.06496685]], shape=(90, 29))</pre></div></div></li><li class='xr-section-item'><input id='section-e27c573d-7047-4fac-9974-0b1830b87443' class='xr-section-summary-in' type='checkbox'  checked><label for='section-e27c573d-7047-4fac-9974-0b1830b87443' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2017-12-01T12:00:00 ... 2018-02-...</div><input id='attrs-bdd31448-a5c7-4685-ad79-288eed079356' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-bdd31448-a5c7-4685-ad79-288eed079356' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3a347f03-a436-446d-ad06-7c92995c89f7' class='xr-var-data-in' type='checkbox'><label for='data-3a347f03-a436-446d-ad06-7c92995c89f7' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>time</dd><dt><span>long_name :</span></dt><dd>reference time</dd><dt><span>bounds :</span></dt><dd>time_bnds</dd><dt><span>axis :</span></dt><dd>T</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;2017-12-01T12:00:00.000000000&#x27;, &#x27;2017-12-02T12:00:00.000000000&#x27;,
           &#x27;2017-12-03T12:00:00.000000000&#x27;, &#x27;2017-12-04T12:00:00.000000000&#x27;,
           &#x27;2017-12-05T12:00:00.000000000&#x27;, &#x27;2017-12-06T12:00:00.000000000&#x27;,
           &#x27;2017-12-07T12:00:00.000000000&#x27;, &#x27;2017-12-08T12:00:00.000000000&#x27;,
           &#x27;2017-12-09T12:00:00.000000000&#x27;, &#x27;2017-12-10T12:00:00.000000000&#x27;,
           &#x27;2017-12-11T12:00:00.000000000&#x27;, &#x27;2017-12-12T12:00:00.000000000&#x27;,
           &#x27;2017-12-13T12:00:00.000000000&#x27;, &#x27;2017-12-14T12:00:00.000000000&#x27;,
           &#x27;2017-12-15T12:00:00.000000000&#x27;, &#x27;2017-12-16T12:00:00.000000000&#x27;,
           &#x27;2017-12-17T12:00:00.000000000&#x27;, &#x27;2017-12-18T12:00:00.000000000&#x27;,
           &#x27;2017-12-19T12:00:00.000000000&#x27;, &#x27;2017-12-20T12:00:00.000000000&#x27;,
           &#x27;2017-12-21T12:00:00.000000000&#x27;, &#x27;2017-12-22T12:00:00.000000000&#x27;,
           &#x27;2017-12-23T12:00:00.000000000&#x27;, &#x27;2017-12-24T12:00:00.000000000&#x27;,
           &#x27;2017-12-25T12:00:00.000000000&#x27;, &#x27;2017-12-26T12:00:00.000000000&#x27;,
           &#x27;2017-12-27T12:00:00.000000000&#x27;, &#x27;2017-12-28T12:00:00.000000000&#x27;,
           &#x27;2017-12-29T12:00:00.000000000&#x27;, &#x27;2017-12-30T12:00:00.000000000&#x27;,
           &#x27;2017-12-31T12:00:00.000000000&#x27;, &#x27;2018-01-01T12:00:00.000000000&#x27;,
           &#x27;2018-01-02T12:00:00.000000000&#x27;, &#x27;2018-01-03T12:00:00.000000000&#x27;,
           &#x27;2018-01-04T12:00:00.000000000&#x27;, &#x27;2018-01-05T12:00:00.000000000&#x27;,
           &#x27;2018-01-06T12:00:00.000000000&#x27;, &#x27;2018-01-07T12:00:00.000000000&#x27;,
           &#x27;2018-01-08T12:00:00.000000000&#x27;, &#x27;2018-01-09T12:00:00.000000000&#x27;,
           &#x27;2018-01-10T12:00:00.000000000&#x27;, &#x27;2018-01-11T12:00:00.000000000&#x27;,
           &#x27;2018-01-12T12:00:00.000000000&#x27;, &#x27;2018-01-13T12:00:00.000000000&#x27;,
           &#x27;2018-01-14T12:00:00.000000000&#x27;, &#x27;2018-01-15T12:00:00.000000000&#x27;,
           &#x27;2018-01-16T12:00:00.000000000&#x27;, &#x27;2018-01-17T12:00:00.000000000&#x27;,
           &#x27;2018-01-18T12:00:00.000000000&#x27;, &#x27;2018-01-19T12:00:00.000000000&#x27;,
           &#x27;2018-01-20T12:00:00.000000000&#x27;, &#x27;2018-01-21T12:00:00.000000000&#x27;,
           &#x27;2018-01-22T12:00:00.000000000&#x27;, &#x27;2018-01-23T12:00:00.000000000&#x27;,
           &#x27;2018-01-24T12:00:00.000000000&#x27;, &#x27;2018-01-25T12:00:00.000000000&#x27;,
           &#x27;2018-01-26T12:00:00.000000000&#x27;, &#x27;2018-01-27T12:00:00.000000000&#x27;,
           &#x27;2018-01-28T12:00:00.000000000&#x27;, &#x27;2018-01-29T12:00:00.000000000&#x27;,
           &#x27;2018-01-30T12:00:00.000000000&#x27;, &#x27;2018-01-31T12:00:00.000000000&#x27;,
           &#x27;2018-02-01T12:00:00.000000000&#x27;, &#x27;2018-02-02T12:00:00.000000000&#x27;,
           &#x27;2018-02-03T12:00:00.000000000&#x27;, &#x27;2018-02-04T12:00:00.000000000&#x27;,
           &#x27;2018-02-05T12:00:00.000000000&#x27;, &#x27;2018-02-06T12:00:00.000000000&#x27;,
           &#x27;2018-02-07T12:00:00.000000000&#x27;, &#x27;2018-02-08T12:00:00.000000000&#x27;,
           &#x27;2018-02-09T12:00:00.000000000&#x27;, &#x27;2018-02-10T12:00:00.000000000&#x27;,
           &#x27;2018-02-11T12:00:00.000000000&#x27;, &#x27;2018-02-12T12:00:00.000000000&#x27;,
           &#x27;2018-02-13T12:00:00.000000000&#x27;, &#x27;2018-02-14T12:00:00.000000000&#x27;,
           &#x27;2018-02-15T12:00:00.000000000&#x27;, &#x27;2018-02-16T12:00:00.000000000&#x27;,
           &#x27;2018-02-17T12:00:00.000000000&#x27;, &#x27;2018-02-18T12:00:00.000000000&#x27;,
           &#x27;2018-02-19T12:00:00.000000000&#x27;, &#x27;2018-02-20T12:00:00.000000000&#x27;,
           &#x27;2018-02-21T12:00:00.000000000&#x27;, &#x27;2018-02-22T12:00:00.000000000&#x27;,
           &#x27;2018-02-23T12:00:00.000000000&#x27;, &#x27;2018-02-24T12:00:00.000000000&#x27;,
           &#x27;2018-02-25T12:00:00.000000000&#x27;, &#x27;2018-02-26T12:00:00.000000000&#x27;,
           &#x27;2018-02-27T12:00:00.000000000&#x27;, &#x27;2018-02-28T12:00:00.000000000&#x27;],
          dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>40.5 45.5 50.5 ... 175.5 180.5</div><input id='attrs-c49e82e9-3852-429b-bc1d-e61430a815aa' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-c49e82e9-3852-429b-bc1d-e61430a815aa' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2b94a748-342e-46da-aec9-586842131d52' class='xr-var-data-in' type='checkbox'><label for='data-2b94a748-342e-46da-aec9-586842131d52' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>long_name :</span></dt><dd>longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>axis :</span></dt><dd>X</dd><dt><span>bounds :</span></dt><dd>lon_bnds</dd></dl></div><div class='xr-var-data'><pre>array([ 40.5,  45.5,  50.5,  55.5,  60.5,  65.5,  70.5,  75.5,  80.5,  85.5,
            90.5,  95.5, 100.5, 105.5, 110.5, 115.5, 120.5, 125.5, 130.5, 135.5,
           140.5, 145.5, 150.5, 155.5, 160.5, 165.5, 170.5, 175.5, 180.5],
          dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dayofyear</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-48f93986-780c-4717-a6d5-36d3c9500d33' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-48f93986-780c-4717-a6d5-36d3c9500d33' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4cddfced-6fe0-49fb-8ea1-f24b25c1f0b2' class='xr-var-data-in' type='checkbox'><label for='data-4cddfced-6fe0-49fb-8ea1-f24b25c1f0b2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>time</dd><dt><span>long_name :</span></dt><dd>reference time</dd><dt><span>bounds :</span></dt><dd>time_bnds</dd><dt><span>axis :</span></dt><dd>T</dd></dl></div><div class='xr-var-data'><pre>[90 values with dtype=int64]</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-ece2a427-074f-4c5a-a803-8bec70f59c7d' class='xr-section-summary-in' type='checkbox'  checked><label for='section-ece2a427-074f-4c5a-a803-8bec70f59c7d' class='xr-section-summary' >Attributes: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>wavenumber :</span></dt><dd>[-999, -999]</dd><dt><span>period :</span></dt><dd>[120, -999]</dd><dt><span>depth :</span></dt><dd>[-999, -999] m</dd><dt><span>waveName :</span></dt><dd>None</dd></dl></div></li></ul></div></div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 86-101

The **Hovm√∂ller Diagram** is a powerful visualization tool that plots atmospheric or oceanic variables along one spatial axis
(e.g., longitude or latitude) against time, revealing propagating wave patterns and persistent anomalies.
By compressing spatiotemporal data into a single image, it allows meteorologists to track the phase speed, direction,
and life cycle of large-scale waves, such as equatorial Kelvin waves or extratropical Rossby wave trains.
In tropical meteorology, Hovm√∂ller diagrams are frequently used to study the **eastward progression of the MJO**
or the **westward movement of tropical cyclones**, while in climate science,
they help diagnose teleconnections like the **El Ni√±o-Southern Oscillation (ENSO)** influence
on global weather. This method is essential for validating model simulations and understanding
the organization of atmospheric disturbances over time.

.. seealso::

      Persson, Anders. "The Story of the Hovm√∂ller Diagram: An (Almost) Eyewitness Account". Bulletin of the American Meteorological Society 98.5 (2017): 949-957. https://doi.org/10.1175/BAMS-D-15-00234.1 Web.

The first is given for equatorial waves with a frequency greater than 120 days of slow variation

.. GENERATED FROM PYTHON SOURCE LINES 102-111

.. code-block:: Python

    fig, ax = plt.subplots(figsize = (8, 5))

    lf_result_ave.plot.contourf(
        yincrease = False,
        levels = np.linspace(-15, 15, 21),
        cbar_kwargs={"location": "right", "aspect": 30},
    )
    ecl.plot.set_lon_format_axis()




.. image-sg:: /auto_gallery/images/sphx_glr_plot_kf_filter_001.png
   :alt: plot kf filter
   :srcset: /auto_gallery/images/sphx_glr_plot_kf_filter_001.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 112-117

The MJO wave is extracted here.

The Madden‚ÄìJulian Oscillation (MJO) is the major fluctuation in tropical weather on weekly to monthly timescales.
It can be characterised as an eastward moving pulse or wave of cloud and rainfall near
the equator that typically recurs every 30 to 60 days.

.. GENERATED FROM PYTHON SOURCE LINES 117-128

.. code-block:: Python


    fig, ax = plt.subplots(figsize = (8, 5))

    mjo_result_ave.plot.contourf(
        yincrease = False,
        levels = np.linspace(-15, 15, 21),
        cbar_kwargs={"location": "right", "aspect": 30},
    )
    ecl.plot.set_lon_format_axis()





.. image-sg:: /auto_gallery/images/sphx_glr_plot_kf_filter_002.png
   :alt: plot kf filter
   :srcset: /auto_gallery/images/sphx_glr_plot_kf_filter_002.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 130-137

The mixed Rossby-Gravity (MRG) waves are extracted here.

The MRG waves move towards the west, but MRG waves have their pressure centres arranged anti-symmetrically
on either side of the equator. This means a low pressure centre on one side of the equator will be opposite
a high pressure centre in the other hemisphere. Satellite analysis of mixed Rossby-Gravity waves shows
favoured zones for deep convection, often with thunderstorm clusters, in an antisymmetric arrangement
about the equator. Their speed of movement to the west is faster than that of an ER wave.

.. GENERATED FROM PYTHON SOURCE LINES 137-147

.. code-block:: Python


    fig, ax = plt.subplots(figsize = (8, 5))

    mrg_result_ave.plot.contourf(
        yincrease = False,
        levels = np.linspace(-15, 15, 21),
        cbar_kwargs={"location": "right", "aspect": 30},
    )
    ecl.plot.set_lon_format_axis()




.. image-sg:: /auto_gallery/images/sphx_glr_plot_kf_filter_003.png
   :alt: plot kf filter
   :srcset: /auto_gallery/images/sphx_glr_plot_kf_filter_003.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 148-149

The tropical depression (TD) waves are extracted here

.. GENERATED FROM PYTHON SOURCE LINES 149-158

.. code-block:: Python

    fig, ax = plt.subplots(figsize = (8, 5))

    td_result_ave.plot.contourf(
        yincrease = False,
        levels = np.linspace(-15, 15, 21),
        cbar_kwargs={"location": "right", "aspect": 30},
    )
    ecl.plot.set_lon_format_axis()




.. image-sg:: /auto_gallery/images/sphx_glr_plot_kf_filter_004.png
   :alt: plot kf filter
   :srcset: /auto_gallery/images/sphx_glr_plot_kf_filter_004.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 159-160

Finally we give the spatial planes of various equatorial waves

.. GENERATED FROM PYTHON SOURCE LINES 160-232

.. code-block:: Python

    fig, ax = plt.subplots(
        nrows=5,
        figsize = (10, 12),
        subplot_kw={
            "projection": ccrs.PlateCarree(central_longitude=180)
        },
    )
    for axi in ax.flat:
        axi.gridlines(draw_labels=["bottom", "left"], color = "grey", alpha = 0.5, linestyle = "--")
        axi.coastlines(edgecolor='k', linewidths=0.5)

    def get_date_str(data):
        return str(data['time'].data)[:10]

    axi = ax[0]
    data = mjo_result.isel(time = 18)
    data.sel(lat = slice(-20, 20)).plot.contourf(
        ax = axi,
        levels = np.linspace(-30, 30, 21),
        transform = ccrs.PlateCarree(),
        add_colorbar = False,
    )
    axi.set_title("MJO")
    axi.set_title(get_date_str(data), loc = 'right')

    axi = ax[1]
    data = mrg_result.isel(time = 18)
    data.sel(lat = slice(-20, 20)).plot.contourf(
        ax = axi,
        levels = np.linspace(-30, 30, 21),
        transform = ccrs.PlateCarree(),
        add_colorbar = False,
    )
    axi.set_title("MRG")
    axi.set_title(get_date_str(data), loc = 'right')

    axi = ax[2]
    data = td_result.isel(time = 18)
    data.sel(lat = slice(-20, 20)).plot.contourf(
        ax = axi,
        levels = np.linspace(-30, 30, 21),
        transform = ccrs.PlateCarree(),
        add_colorbar = False,
    )
    axi.set_title("TD")
    axi.set_title(get_date_str(data), loc = 'right')

    axi = ax[3]
    data = kelvin_result.isel(time = 18)
    data.sel(lat = slice(-20, 20)).plot.contourf(
        ax = axi,
        levels = np.linspace(-30, 30, 21),
        transform = ccrs.PlateCarree(),
        add_colorbar = False,
    )
    axi.set_title("Kelvin")
    axi.set_title(get_date_str(data), loc = 'right')

    axi = ax[4]
    data = lf_result.isel(time = 18)
    bar_sample = data.sel(lat = slice(-20, 20)).plot.contourf(
        ax = axi,
        levels = np.linspace(-30, 30, 21),
        transform = ccrs.PlateCarree(),
        add_colorbar = False,
    )
    axi.set_title("Low")
    axi.set_title(get_date_str(data), loc = 'right')

    axi_item = ax.flatten()
    cb1 = fig.colorbar(bar_sample, ax = axi_item, orientation = 'horizontal', pad = 0.08, aspect = 50, shrink = 0.8, extendrect = False)
    cb1.set_label('OLR (W/$\\mathrm{m^2}$)')



.. image-sg:: /auto_gallery/images/sphx_glr_plot_kf_filter_005.png
   :alt: MJO, 2017-01-19, MRG, 2017-01-19, TD, 2017-01-19, Kelvin, 2017-01-19, Low, 2017-01-19
   :srcset: /auto_gallery/images/sphx_glr_plot_kf_filter_005.png
   :class: sphx-glr-single-img






.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (0 minutes 9.594 seconds)


.. _sphx_glr_download_auto_gallery_plot_kf_filter.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: plot_kf_filter.ipynb <plot_kf_filter.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: plot_kf_filter.py <plot_kf_filter.py>`

    .. container:: sphx-glr-download sphx-glr-download-zip

      :download:`Download zipped: plot_kf_filter.zip <plot_kf_filter.zip>`
