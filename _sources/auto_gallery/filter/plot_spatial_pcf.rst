
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_gallery/filter/plot_spatial_pcf.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_auto_gallery_filter_plot_spatial_pcf.py>`
        to download the full example code.

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_gallery_filter_plot_spatial_pcf.py:


.. _2D_spatial_parabolic_cylinder_function_example:

2D Spatial Parabolic Cylinder Function
=================================================================================

Ever wondered how atmospheric waves boogie along the equator? Let's explore how to isolate these fascinating dancers (Kelvin waves, Rossby waves, and friends) using parabolic cylinder functions!

Before proceeding with all the steps, first import some necessary libraries and packages

.. GENERATED FROM PYTHON SOURCE LINES 12-16

.. code-block:: Python

    import xarray as xr
    import cartopy.crs as ccrs
    import easyclimate as ecl








.. GENERATED FROM PYTHON SOURCE LINES 17-24

Loading the Data
-------------------------------
First, we need some atmospheric data to work with - think of this as setting up the dance floor for our waves:

.. tip::

  You can download following datasets here: :download:`Download uwnd_vwnd_hgt_equtorial_2021_2024.nc <https://raw.githubusercontent.com/shenyulu/easyclimate/refs/heads/main/docs/source/dynamic_docs/uwnd_vwnd_hgt_equtorial_2021_2024.nc>`

.. GENERATED FROM PYTHON SOURCE LINES 24-28

.. code-block:: Python


    uvz_data = ecl.open_tutorial_dataset("uwnd_vwnd_hgt_equtorial_2021_2024")
    uvz_data





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    uwnd_vwnd_hgt_equtorial_2021_2024.nc ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ 100.0% ‚Ä¢ 14.5/‚Ä¶ ‚Ä¢ 210.0   ‚Ä¢ 0:00:00
                                                          MB       MB/s             


.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
    <defs>
    <symbol id="icon-database" viewBox="0 0 32 32">
    <path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
    <path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    <path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    </symbol>
    <symbol id="icon-file-text2" viewBox="0 0 32 32">
    <path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
    <path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    </symbol>
    </defs>
    </svg>
    <style>/* CSS stylesheet for displaying xarray objects in notebooks */

    :root {
      --xr-font-color0: var(
        --jp-content-font-color0,
        var(--pst-color-text-base rgba(0, 0, 0, 1))
      );
      --xr-font-color2: var(
        --jp-content-font-color2,
        var(--pst-color-text-base, rgba(0, 0, 0, 0.54))
      );
      --xr-font-color3: var(
        --jp-content-font-color3,
        var(--pst-color-text-base, rgba(0, 0, 0, 0.38))
      );
      --xr-border-color: var(
        --jp-border-color2,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 10))
      );
      --xr-disabled-color: var(
        --jp-layout-color3,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 40))
      );
      --xr-background-color: var(
        --jp-layout-color0,
        var(--pst-color-on-background, white)
      );
      --xr-background-color-row-even: var(
        --jp-layout-color1,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 5))
      );
      --xr-background-color-row-odd: var(
        --jp-layout-color2,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 15))
      );
    }

    html[theme="dark"],
    html[data-theme="dark"],
    body[data-theme="dark"],
    body.vscode-dark {
      --xr-font-color0: var(
        --jp-content-font-color0,
        var(--pst-color-text-base, rgba(255, 255, 255, 1))
      );
      --xr-font-color2: var(
        --jp-content-font-color2,
        var(--pst-color-text-base, rgba(255, 255, 255, 0.54))
      );
      --xr-font-color3: var(
        --jp-content-font-color3,
        var(--pst-color-text-base, rgba(255, 255, 255, 0.38))
      );
      --xr-border-color: var(
        --jp-border-color2,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))
      );
      --xr-disabled-color: var(
        --jp-layout-color3,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))
      );
      --xr-background-color: var(
        --jp-layout-color0,
        var(--pst-color-on-background, #111111)
      );
      --xr-background-color-row-even: var(
        --jp-layout-color1,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))
      );
      --xr-background-color-row-odd: var(
        --jp-layout-color2,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))
      );
    }

    .xr-wrap {
      display: block !important;
      min-width: 300px;
      max-width: 700px;
      line-height: 1.6;
      padding-bottom: 4px;
    }

    .xr-text-repr-fallback {
      /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
      display: none;
    }

    .xr-header {
      padding-top: 6px;
      padding-bottom: 6px;
    }

    .xr-header {
      border-bottom: solid 1px var(--xr-border-color);
      margin-bottom: 4px;
    }

    .xr-header > div,
    .xr-header > ul {
      display: inline;
      margin-top: 0;
      margin-bottom: 0;
    }

    .xr-obj-type,
    .xr-obj-name {
      margin-left: 2px;
      margin-right: 10px;
    }

    .xr-obj-type,
    .xr-group-box-contents > label {
      color: var(--xr-font-color2);
      display: block;
    }

    .xr-sections {
      padding-left: 0 !important;
      display: grid;
      grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
      margin-block-start: 0;
      margin-block-end: 0;
    }

    .xr-section-item {
      display: contents;
    }

    .xr-section-item > input,
    .xr-group-box-contents > input,
    .xr-array-wrap > input {
      display: block;
      opacity: 0;
      height: 0;
      margin: 0;
    }

    .xr-section-item > input + label,
    .xr-var-item > input + label {
      color: var(--xr-disabled-color);
    }

    .xr-section-item > input:enabled + label,
    .xr-var-item > input:enabled + label,
    .xr-array-wrap > input:enabled + label,
    .xr-group-box-contents > input:enabled + label {
      cursor: pointer;
      color: var(--xr-font-color2);
    }

    .xr-section-item > input:focus-visible + label,
    .xr-var-item > input:focus-visible + label,
    .xr-array-wrap > input:focus-visible + label,
    .xr-group-box-contents > input:focus-visible + label {
      outline: auto;
    }

    .xr-section-item > input:enabled + label:hover,
    .xr-var-item > input:enabled + label:hover,
    .xr-array-wrap > input:enabled + label:hover,
    .xr-group-box-contents > input:enabled + label:hover {
      color: var(--xr-font-color0);
    }

    .xr-section-summary {
      grid-column: 1;
      color: var(--xr-font-color2);
      font-weight: 500;
      white-space: nowrap;
    }

    .xr-section-summary > em {
      font-weight: normal;
    }

    .xr-span-grid {
      grid-column-end: -1;
    }

    .xr-section-summary > span {
      display: inline-block;
      padding-left: 0.3em;
    }

    .xr-group-box-contents > input:checked + label > span {
      display: inline-block;
      padding-left: 0.6em;
    }

    .xr-section-summary-in:disabled + label {
      color: var(--xr-font-color2);
    }

    .xr-section-summary-in + label:before {
      display: inline-block;
      content: "‚ñ∫";
      font-size: 11px;
      width: 15px;
      text-align: center;
    }

    .xr-section-summary-in:disabled + label:before {
      color: var(--xr-disabled-color);
    }

    .xr-section-summary-in:checked + label:before {
      content: "‚ñº";
    }

    .xr-section-summary-in:checked + label > span {
      display: none;
    }

    .xr-section-summary,
    .xr-section-inline-details,
    .xr-group-box-contents > label {
      padding-top: 4px;
    }

    .xr-section-inline-details {
      grid-column: 2 / -1;
    }

    .xr-section-details {
      grid-column: 1 / -1;
      margin-top: 4px;
      margin-bottom: 5px;
    }

    .xr-section-summary-in ~ .xr-section-details {
      display: none;
    }

    .xr-section-summary-in:checked ~ .xr-section-details {
      display: contents;
    }

    .xr-children {
      display: inline-grid;
      grid-template-columns: 100%;
      grid-column: 1 / -1;
      padding-top: 4px;
    }

    .xr-group-box {
      display: inline-grid;
      grid-template-columns: 0px 30px auto;
    }

    .xr-group-box-vline {
      grid-column-start: 1;
      border-right: 0.2em solid;
      border-color: var(--xr-border-color);
      width: 0px;
    }

    .xr-group-box-hline {
      grid-column-start: 2;
      grid-row-start: 1;
      height: 1em;
      width: 26px;
      border-bottom: 0.2em solid;
      border-color: var(--xr-border-color);
    }

    .xr-group-box-contents {
      grid-column-start: 3;
      padding-bottom: 4px;
    }

    .xr-group-box-contents > label::before {
      content: "üìÇ";
      padding-right: 0.3em;
    }

    .xr-group-box-contents > input:checked + label::before {
      content: "üìÅ";
    }

    .xr-group-box-contents > input:checked + label {
      padding-bottom: 0px;
    }

    .xr-group-box-contents > input:checked ~ .xr-sections {
      display: none;
    }

    .xr-group-box-contents > input + label > span {
      display: none;
    }

    .xr-group-box-ellipsis {
      font-size: 1.4em;
      font-weight: 900;
      color: var(--xr-font-color2);
      letter-spacing: 0.15em;
      cursor: default;
    }

    .xr-array-wrap {
      grid-column: 1 / -1;
      display: grid;
      grid-template-columns: 20px auto;
    }

    .xr-array-wrap > label {
      grid-column: 1;
      vertical-align: top;
    }

    .xr-preview {
      color: var(--xr-font-color3);
    }

    .xr-array-preview,
    .xr-array-data {
      padding: 0 5px !important;
      grid-column: 2;
    }

    .xr-array-data,
    .xr-array-in:checked ~ .xr-array-preview {
      display: none;
    }

    .xr-array-in:checked ~ .xr-array-data,
    .xr-array-preview {
      display: inline-block;
    }

    .xr-dim-list {
      display: inline-block !important;
      list-style: none;
      padding: 0 !important;
      margin: 0;
    }

    .xr-dim-list li {
      display: inline-block;
      padding: 0;
      margin: 0;
    }

    .xr-dim-list:before {
      content: "(";
    }

    .xr-dim-list:after {
      content: ")";
    }

    .xr-dim-list li:not(:last-child):after {
      content: ",";
      padding-right: 5px;
    }

    .xr-has-index {
      font-weight: bold;
    }

    .xr-var-list,
    .xr-var-item {
      display: contents;
    }

    .xr-var-item > div,
    .xr-var-item label,
    .xr-var-item > .xr-var-name span {
      background-color: var(--xr-background-color-row-even);
      border-color: var(--xr-background-color-row-odd);
      margin-bottom: 0;
      padding-top: 2px;
    }

    .xr-var-item > .xr-var-name:hover span {
      padding-right: 5px;
    }

    .xr-var-list > li:nth-child(odd) > div,
    .xr-var-list > li:nth-child(odd) > label,
    .xr-var-list > li:nth-child(odd) > .xr-var-name span {
      background-color: var(--xr-background-color-row-odd);
      border-color: var(--xr-background-color-row-even);
    }

    .xr-var-name {
      grid-column: 1;
    }

    .xr-var-dims {
      grid-column: 2;
    }

    .xr-var-dtype {
      grid-column: 3;
      text-align: right;
      color: var(--xr-font-color2);
    }

    .xr-var-preview {
      grid-column: 4;
    }

    .xr-index-preview {
      grid-column: 2 / 5;
      color: var(--xr-font-color2);
    }

    .xr-var-name,
    .xr-var-dims,
    .xr-var-dtype,
    .xr-preview,
    .xr-attrs dt {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      padding-right: 10px;
    }

    .xr-var-name:hover,
    .xr-var-dims:hover,
    .xr-var-dtype:hover,
    .xr-attrs dt:hover {
      overflow: visible;
      width: auto;
      z-index: 1;
    }

    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      display: none;
      border-top: 2px dotted var(--xr-background-color);
      padding-bottom: 20px !important;
      padding-top: 10px !important;
    }

    .xr-var-attrs-in + label,
    .xr-var-data-in + label,
    .xr-index-data-in + label {
      padding: 0 1px;
    }

    .xr-var-attrs-in:checked ~ .xr-var-attrs,
    .xr-var-data-in:checked ~ .xr-var-data,
    .xr-index-data-in:checked ~ .xr-index-data {
      display: block;
    }

    .xr-var-data > table {
      float: right;
    }

    .xr-var-data > pre,
    .xr-index-data > pre,
    .xr-var-data > table > tbody > tr {
      background-color: transparent !important;
    }

    .xr-var-name span,
    .xr-var-data,
    .xr-index-name div,
    .xr-index-data,
    .xr-attrs {
      padding-left: 25px !important;
    }

    .xr-attrs,
    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      grid-column: 1 / -1;
    }

    dl.xr-attrs {
      padding: 0;
      margin: 0;
      display: grid;
      grid-template-columns: 125px auto;
    }

    .xr-attrs dt,
    .xr-attrs dd {
      padding: 0;
      margin: 0;
      float: left;
      padding-right: 10px;
      width: auto;
    }

    .xr-attrs dt {
      font-weight: normal;
      grid-column: 1;
    }

    .xr-attrs dt:hover span {
      display: inline-block;
      background: var(--xr-background-color);
      padding-right: 10px;
    }

    .xr-attrs dd {
      grid-column: 2;
      white-space: pre-wrap;
      word-break: break-all;
    }

    .xr-icon-database,
    .xr-icon-file-text2,
    .xr-no-icon {
      display: inline-block;
      vertical-align: middle;
      width: 1em;
      height: 1.5em !important;
      stroke-width: 0;
      stroke: currentColor;
      fill: currentColor;
    }

    .xr-var-attrs-in:checked + label > .xr-icon-file-text2,
    .xr-var-data-in:checked + label > .xr-icon-database,
    .xr-index-data-in:checked + label > .xr-icon-database {
      color: var(--xr-font-color0);
      filter: drop-shadow(1px 1px 5px var(--xr-font-color2));
      stroke-width: 0.8px;
    }
    </style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 43MB
    Dimensions:  (time: 1461, lat: 17, lon: 144)
    Coordinates:
      * time     (time) datetime64[ns] 12kB 2021-01-01 2021-01-02 ... 2024-12-31
      * lat      (lat) float32 68B -20.0 -17.5 -15.0 -12.5 ... 12.5 15.0 17.5 20.0
      * lon      (lon) float32 576B 0.0 2.5 5.0 7.5 10.0 ... 350.0 352.5 355.0 357.5
        level    float32 4B ...
    Data variables:
        hgt      (time, lat, lon) float32 14MB ...
        uwnd     (time, lat, lon) float32 14MB ...
        vwnd     (time, lat, lon) float32 14MB ...</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-5aeed55a-b8a1-47ee-a9f6-fb8e82a68736' class='xr-section-summary-in' type='checkbox' disabled /><label for='section-5aeed55a-b8a1-47ee-a9f6-fb8e82a68736' class='xr-section-summary'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 1461</li><li><span class='xr-has-index'>lat</span>: 17</li><li><span class='xr-has-index'>lon</span>: 144</li></ul></div></li><li class='xr-section-item'><input id='section-0a443e89-8d41-47b3-8765-48078abf68df' class='xr-section-summary-in' type='checkbox' checked /><label for='section-0a443e89-8d41-47b3-8765-48078abf68df' class='xr-section-summary' title='Expand/collapse section'>Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2021-01-01 ... 2024-12-31</div><input id='attrs-e6a9694e-7152-4665-9bc0-628c972b04c0' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-e6a9694e-7152-4665-9bc0-628c972b04c0' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9c37cdd9-7f87-42e9-8a58-5c3067129f78' class='xr-var-data-in' type='checkbox'><label for='data-9c37cdd9-7f87-42e9-8a58-5c3067129f78' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>time</dd><dt><span>long_name :</span></dt><dd>Time</dd><dt><span>axis :</span></dt><dd>T</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;2021-01-01T00:00:00.000000000&#x27;, &#x27;2021-01-02T00:00:00.000000000&#x27;,
           &#x27;2021-01-03T00:00:00.000000000&#x27;, ..., &#x27;2024-12-29T00:00:00.000000000&#x27;,
           &#x27;2024-12-30T00:00:00.000000000&#x27;, &#x27;2024-12-31T00:00:00.000000000&#x27;],
          shape=(1461,), dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-20.0 -17.5 -15.0 ... 17.5 20.0</div><input id='attrs-234050a3-3ffe-4d37-912a-9618f4a5860c' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-234050a3-3ffe-4d37-912a-9618f4a5860c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b1fad230-6ebb-42d3-992b-d41cc7455fe9' class='xr-var-data-in' type='checkbox'><label for='data-b1fad230-6ebb-42d3-992b-d41cc7455fe9' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>long_name :</span></dt><dd>Latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>axis :</span></dt><dd>Y</dd></dl></div><div class='xr-var-data'><pre>array([-20. , -17.5, -15. , -12.5, -10. ,  -7.5,  -5. ,  -2.5,   0. ,   2.5,
             5. ,   7.5,  10. ,  12.5,  15. ,  17.5,  20. ], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.0 2.5 5.0 ... 352.5 355.0 357.5</div><input id='attrs-b3f3f6f7-8303-4e95-8315-481eb2444ca4' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-b3f3f6f7-8303-4e95-8315-481eb2444ca4' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d8d50691-fbe5-42f7-a915-ba9d7c90b28f' class='xr-var-data-in' type='checkbox'><label for='data-d8d50691-fbe5-42f7-a915-ba9d7c90b28f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>long_name :</span></dt><dd>Longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>axis :</span></dt><dd>X</dd></dl></div><div class='xr-var-data'><pre>array([  0. ,   2.5,   5. ,   7.5,  10. ,  12.5,  15. ,  17.5,  20. ,  22.5,
            25. ,  27.5,  30. ,  32.5,  35. ,  37.5,  40. ,  42.5,  45. ,  47.5,
            50. ,  52.5,  55. ,  57.5,  60. ,  62.5,  65. ,  67.5,  70. ,  72.5,
            75. ,  77.5,  80. ,  82.5,  85. ,  87.5,  90. ,  92.5,  95. ,  97.5,
           100. , 102.5, 105. , 107.5, 110. , 112.5, 115. , 117.5, 120. , 122.5,
           125. , 127.5, 130. , 132.5, 135. , 137.5, 140. , 142.5, 145. , 147.5,
           150. , 152.5, 155. , 157.5, 160. , 162.5, 165. , 167.5, 170. , 172.5,
           175. , 177.5, 180. , 182.5, 185. , 187.5, 190. , 192.5, 195. , 197.5,
           200. , 202.5, 205. , 207.5, 210. , 212.5, 215. , 217.5, 220. , 222.5,
           225. , 227.5, 230. , 232.5, 235. , 237.5, 240. , 242.5, 245. , 247.5,
           250. , 252.5, 255. , 257.5, 260. , 262.5, 265. , 267.5, 270. , 272.5,
           275. , 277.5, 280. , 282.5, 285. , 287.5, 290. , 292.5, 295. , 297.5,
           300. , 302.5, 305. , 307.5, 310. , 312.5, 315. , 317.5, 320. , 322.5,
           325. , 327.5, 330. , 332.5, 335. , 337.5, 340. , 342.5, 345. , 347.5,
           350. , 352.5, 355. , 357.5], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>level</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-44ccc63f-340f-4779-b2ca-8b3b425bf95a' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-44ccc63f-340f-4779-b2ca-8b3b425bf95a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0ab40d83-9326-4020-a9ef-653d845aea85' class='xr-var-data-in' type='checkbox'><label for='data-0ab40d83-9326-4020-a9ef-653d845aea85' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>air_pressure</dd><dt><span>long_name :</span></dt><dd>Level</dd><dt><span>units :</span></dt><dd>millibar</dd><dt><span>positive :</span></dt><dd>down</dd><dt><span>axis :</span></dt><dd>Z</dd><dt><span>actual_range :</span></dt><dd>[1000.   10.]</dd><dt><span>GRIB_id :</span></dt><dd>100</dd><dt><span>GRIB_name :</span></dt><dd>hPa</dd></dl></div><div class='xr-var-data'><pre>[1 values with dtype=float32]</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-10ec4c27-2840-412b-b062-96360f3728ed' class='xr-section-summary-in' type='checkbox' checked /><label for='section-10ec4c27-2840-412b-b062-96360f3728ed' class='xr-section-summary' title='Expand/collapse section'>Data variables: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>hgt</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-aabfb106-81ee-473f-934b-4e0d7af67e5d' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-aabfb106-81ee-473f-934b-4e0d7af67e5d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4fdd8691-77ce-48cf-a3fc-0ea8232088f5' class='xr-var-data-in' type='checkbox'><label for='data-4fdd8691-77ce-48cf-a3fc-0ea8232088f5' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>mean Daily Geopotential height</dd><dt><span>units :</span></dt><dd>m</dd><dt><span>precision :</span></dt><dd>0</dd><dt><span>GRIB_id :</span></dt><dd>7</dd><dt><span>GRIB_name :</span></dt><dd>HGT</dd><dt><span>var_desc :</span></dt><dd>Geopotential height</dd><dt><span>level_desc :</span></dt><dd>Pressure Levels</dd><dt><span>statistic :</span></dt><dd>Mean</dd><dt><span>parent_stat :</span></dt><dd>Individual Obs</dd><dt><span>dataset :</span></dt><dd>NCEP Reanalysis Daily Averages</dd><dt><span>actual_range :</span></dt><dd>[ -551.25 32247.5 ]</dd></dl></div><div class='xr-var-data'><pre>[3576528 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>uwnd</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-510c7026-d5ca-465c-a280-28c41776938f' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-510c7026-d5ca-465c-a280-28c41776938f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d560236c-3d3d-4a00-b1a6-a7b853e2e1b9' class='xr-var-data-in' type='checkbox'><label for='data-d560236c-3d3d-4a00-b1a6-a7b853e2e1b9' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>mean Daily U-wind</dd><dt><span>units :</span></dt><dd>m/s</dd><dt><span>precision :</span></dt><dd>2</dd><dt><span>GRIB_id :</span></dt><dd>33</dd><dt><span>GRIB_name :</span></dt><dd>UGRD</dd><dt><span>var_desc :</span></dt><dd>u-wind</dd><dt><span>level_desc :</span></dt><dd>Pressure Levels</dd><dt><span>statistic :</span></dt><dd>Mean</dd><dt><span>parent_stat :</span></dt><dd>Individual Obs</dd><dt><span>dataset :</span></dt><dd>NCEP Reanalysis Daily Averages</dd><dt><span>actual_range :</span></dt><dd>[-88.299995 124.799995]</dd></dl></div><div class='xr-var-data'><pre>[3576528 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>vwnd</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-2c0d8c5d-6502-4279-b3f7-e2194baec14e' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-2c0d8c5d-6502-4279-b3f7-e2194baec14e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-17a955cf-9296-437a-8730-c0adcae40f8b' class='xr-var-data-in' type='checkbox'><label for='data-17a955cf-9296-437a-8730-c0adcae40f8b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>mean Daily V wind</dd><dt><span>units :</span></dt><dd>m/s</dd><dt><span>precision :</span></dt><dd>2</dd><dt><span>GRIB_id :</span></dt><dd>34</dd><dt><span>GRIB_name :</span></dt><dd>VGRD</dd><dt><span>var_desc :</span></dt><dd>v-wind</dd><dt><span>level_desc :</span></dt><dd>Pressure Levels</dd><dt><span>statistic :</span></dt><dd>Mean</dd><dt><span>parent_stat :</span></dt><dd>Individual Obs</dd><dt><span>dataset :</span></dt><dd>NCEP Reanalysis Daily Averages</dd><dt><span>actual_range :</span></dt><dd>[-93.424995  88.299995]</dd></dl></div><div class='xr-var-data'><pre>[3576528 values with dtype=float32]</pre></div></li></ul></div></li></ul></div></div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 29-33

Isolating Wave Types
-------------------------------------------
Now for the star of our show: the 2D spatial parabolic cylinder function filter :py:func:`easyclimate.filter.filter_2D_spatial_parabolic_cylinder_function <easyclimate.filter.filter_2D_spatial_parabolic_cylinder_function>`! This function works like a talented bouncer, only letting specific wave types into our analysis:


.. GENERATED FROM PYTHON SOURCE LINES 33-37

.. code-block:: Python


    result = ecl.filter.filter_2D_spatial_parabolic_cylinder_function(uvz_data.uwnd, uvz_data.vwnd, uvz_data.hgt)
    result






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
    <defs>
    <symbol id="icon-database" viewBox="0 0 32 32">
    <path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
    <path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    <path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    </symbol>
    <symbol id="icon-file-text2" viewBox="0 0 32 32">
    <path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
    <path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    </symbol>
    </defs>
    </svg>
    <style>/* CSS stylesheet for displaying xarray objects in notebooks */

    :root {
      --xr-font-color0: var(
        --jp-content-font-color0,
        var(--pst-color-text-base rgba(0, 0, 0, 1))
      );
      --xr-font-color2: var(
        --jp-content-font-color2,
        var(--pst-color-text-base, rgba(0, 0, 0, 0.54))
      );
      --xr-font-color3: var(
        --jp-content-font-color3,
        var(--pst-color-text-base, rgba(0, 0, 0, 0.38))
      );
      --xr-border-color: var(
        --jp-border-color2,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 10))
      );
      --xr-disabled-color: var(
        --jp-layout-color3,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 40))
      );
      --xr-background-color: var(
        --jp-layout-color0,
        var(--pst-color-on-background, white)
      );
      --xr-background-color-row-even: var(
        --jp-layout-color1,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 5))
      );
      --xr-background-color-row-odd: var(
        --jp-layout-color2,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 15))
      );
    }

    html[theme="dark"],
    html[data-theme="dark"],
    body[data-theme="dark"],
    body.vscode-dark {
      --xr-font-color0: var(
        --jp-content-font-color0,
        var(--pst-color-text-base, rgba(255, 255, 255, 1))
      );
      --xr-font-color2: var(
        --jp-content-font-color2,
        var(--pst-color-text-base, rgba(255, 255, 255, 0.54))
      );
      --xr-font-color3: var(
        --jp-content-font-color3,
        var(--pst-color-text-base, rgba(255, 255, 255, 0.38))
      );
      --xr-border-color: var(
        --jp-border-color2,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))
      );
      --xr-disabled-color: var(
        --jp-layout-color3,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))
      );
      --xr-background-color: var(
        --jp-layout-color0,
        var(--pst-color-on-background, #111111)
      );
      --xr-background-color-row-even: var(
        --jp-layout-color1,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))
      );
      --xr-background-color-row-odd: var(
        --jp-layout-color2,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))
      );
    }

    .xr-wrap {
      display: block !important;
      min-width: 300px;
      max-width: 700px;
      line-height: 1.6;
      padding-bottom: 4px;
    }

    .xr-text-repr-fallback {
      /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
      display: none;
    }

    .xr-header {
      padding-top: 6px;
      padding-bottom: 6px;
    }

    .xr-header {
      border-bottom: solid 1px var(--xr-border-color);
      margin-bottom: 4px;
    }

    .xr-header > div,
    .xr-header > ul {
      display: inline;
      margin-top: 0;
      margin-bottom: 0;
    }

    .xr-obj-type,
    .xr-obj-name {
      margin-left: 2px;
      margin-right: 10px;
    }

    .xr-obj-type,
    .xr-group-box-contents > label {
      color: var(--xr-font-color2);
      display: block;
    }

    .xr-sections {
      padding-left: 0 !important;
      display: grid;
      grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
      margin-block-start: 0;
      margin-block-end: 0;
    }

    .xr-section-item {
      display: contents;
    }

    .xr-section-item > input,
    .xr-group-box-contents > input,
    .xr-array-wrap > input {
      display: block;
      opacity: 0;
      height: 0;
      margin: 0;
    }

    .xr-section-item > input + label,
    .xr-var-item > input + label {
      color: var(--xr-disabled-color);
    }

    .xr-section-item > input:enabled + label,
    .xr-var-item > input:enabled + label,
    .xr-array-wrap > input:enabled + label,
    .xr-group-box-contents > input:enabled + label {
      cursor: pointer;
      color: var(--xr-font-color2);
    }

    .xr-section-item > input:focus-visible + label,
    .xr-var-item > input:focus-visible + label,
    .xr-array-wrap > input:focus-visible + label,
    .xr-group-box-contents > input:focus-visible + label {
      outline: auto;
    }

    .xr-section-item > input:enabled + label:hover,
    .xr-var-item > input:enabled + label:hover,
    .xr-array-wrap > input:enabled + label:hover,
    .xr-group-box-contents > input:enabled + label:hover {
      color: var(--xr-font-color0);
    }

    .xr-section-summary {
      grid-column: 1;
      color: var(--xr-font-color2);
      font-weight: 500;
      white-space: nowrap;
    }

    .xr-section-summary > em {
      font-weight: normal;
    }

    .xr-span-grid {
      grid-column-end: -1;
    }

    .xr-section-summary > span {
      display: inline-block;
      padding-left: 0.3em;
    }

    .xr-group-box-contents > input:checked + label > span {
      display: inline-block;
      padding-left: 0.6em;
    }

    .xr-section-summary-in:disabled + label {
      color: var(--xr-font-color2);
    }

    .xr-section-summary-in + label:before {
      display: inline-block;
      content: "‚ñ∫";
      font-size: 11px;
      width: 15px;
      text-align: center;
    }

    .xr-section-summary-in:disabled + label:before {
      color: var(--xr-disabled-color);
    }

    .xr-section-summary-in:checked + label:before {
      content: "‚ñº";
    }

    .xr-section-summary-in:checked + label > span {
      display: none;
    }

    .xr-section-summary,
    .xr-section-inline-details,
    .xr-group-box-contents > label {
      padding-top: 4px;
    }

    .xr-section-inline-details {
      grid-column: 2 / -1;
    }

    .xr-section-details {
      grid-column: 1 / -1;
      margin-top: 4px;
      margin-bottom: 5px;
    }

    .xr-section-summary-in ~ .xr-section-details {
      display: none;
    }

    .xr-section-summary-in:checked ~ .xr-section-details {
      display: contents;
    }

    .xr-children {
      display: inline-grid;
      grid-template-columns: 100%;
      grid-column: 1 / -1;
      padding-top: 4px;
    }

    .xr-group-box {
      display: inline-grid;
      grid-template-columns: 0px 30px auto;
    }

    .xr-group-box-vline {
      grid-column-start: 1;
      border-right: 0.2em solid;
      border-color: var(--xr-border-color);
      width: 0px;
    }

    .xr-group-box-hline {
      grid-column-start: 2;
      grid-row-start: 1;
      height: 1em;
      width: 26px;
      border-bottom: 0.2em solid;
      border-color: var(--xr-border-color);
    }

    .xr-group-box-contents {
      grid-column-start: 3;
      padding-bottom: 4px;
    }

    .xr-group-box-contents > label::before {
      content: "üìÇ";
      padding-right: 0.3em;
    }

    .xr-group-box-contents > input:checked + label::before {
      content: "üìÅ";
    }

    .xr-group-box-contents > input:checked + label {
      padding-bottom: 0px;
    }

    .xr-group-box-contents > input:checked ~ .xr-sections {
      display: none;
    }

    .xr-group-box-contents > input + label > span {
      display: none;
    }

    .xr-group-box-ellipsis {
      font-size: 1.4em;
      font-weight: 900;
      color: var(--xr-font-color2);
      letter-spacing: 0.15em;
      cursor: default;
    }

    .xr-array-wrap {
      grid-column: 1 / -1;
      display: grid;
      grid-template-columns: 20px auto;
    }

    .xr-array-wrap > label {
      grid-column: 1;
      vertical-align: top;
    }

    .xr-preview {
      color: var(--xr-font-color3);
    }

    .xr-array-preview,
    .xr-array-data {
      padding: 0 5px !important;
      grid-column: 2;
    }

    .xr-array-data,
    .xr-array-in:checked ~ .xr-array-preview {
      display: none;
    }

    .xr-array-in:checked ~ .xr-array-data,
    .xr-array-preview {
      display: inline-block;
    }

    .xr-dim-list {
      display: inline-block !important;
      list-style: none;
      padding: 0 !important;
      margin: 0;
    }

    .xr-dim-list li {
      display: inline-block;
      padding: 0;
      margin: 0;
    }

    .xr-dim-list:before {
      content: "(";
    }

    .xr-dim-list:after {
      content: ")";
    }

    .xr-dim-list li:not(:last-child):after {
      content: ",";
      padding-right: 5px;
    }

    .xr-has-index {
      font-weight: bold;
    }

    .xr-var-list,
    .xr-var-item {
      display: contents;
    }

    .xr-var-item > div,
    .xr-var-item label,
    .xr-var-item > .xr-var-name span {
      background-color: var(--xr-background-color-row-even);
      border-color: var(--xr-background-color-row-odd);
      margin-bottom: 0;
      padding-top: 2px;
    }

    .xr-var-item > .xr-var-name:hover span {
      padding-right: 5px;
    }

    .xr-var-list > li:nth-child(odd) > div,
    .xr-var-list > li:nth-child(odd) > label,
    .xr-var-list > li:nth-child(odd) > .xr-var-name span {
      background-color: var(--xr-background-color-row-odd);
      border-color: var(--xr-background-color-row-even);
    }

    .xr-var-name {
      grid-column: 1;
    }

    .xr-var-dims {
      grid-column: 2;
    }

    .xr-var-dtype {
      grid-column: 3;
      text-align: right;
      color: var(--xr-font-color2);
    }

    .xr-var-preview {
      grid-column: 4;
    }

    .xr-index-preview {
      grid-column: 2 / 5;
      color: var(--xr-font-color2);
    }

    .xr-var-name,
    .xr-var-dims,
    .xr-var-dtype,
    .xr-preview,
    .xr-attrs dt {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      padding-right: 10px;
    }

    .xr-var-name:hover,
    .xr-var-dims:hover,
    .xr-var-dtype:hover,
    .xr-attrs dt:hover {
      overflow: visible;
      width: auto;
      z-index: 1;
    }

    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      display: none;
      border-top: 2px dotted var(--xr-background-color);
      padding-bottom: 20px !important;
      padding-top: 10px !important;
    }

    .xr-var-attrs-in + label,
    .xr-var-data-in + label,
    .xr-index-data-in + label {
      padding: 0 1px;
    }

    .xr-var-attrs-in:checked ~ .xr-var-attrs,
    .xr-var-data-in:checked ~ .xr-var-data,
    .xr-index-data-in:checked ~ .xr-index-data {
      display: block;
    }

    .xr-var-data > table {
      float: right;
    }

    .xr-var-data > pre,
    .xr-index-data > pre,
    .xr-var-data > table > tbody > tr {
      background-color: transparent !important;
    }

    .xr-var-name span,
    .xr-var-data,
    .xr-index-name div,
    .xr-index-data,
    .xr-attrs {
      padding-left: 25px !important;
    }

    .xr-attrs,
    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      grid-column: 1 / -1;
    }

    dl.xr-attrs {
      padding: 0;
      margin: 0;
      display: grid;
      grid-template-columns: 125px auto;
    }

    .xr-attrs dt,
    .xr-attrs dd {
      padding: 0;
      margin: 0;
      float: left;
      padding-right: 10px;
      width: auto;
    }

    .xr-attrs dt {
      font-weight: normal;
      grid-column: 1;
    }

    .xr-attrs dt:hover span {
      display: inline-block;
      background: var(--xr-background-color);
      padding-right: 10px;
    }

    .xr-attrs dd {
      grid-column: 2;
      white-space: pre-wrap;
      word-break: break-all;
    }

    .xr-icon-database,
    .xr-icon-file-text2,
    .xr-no-icon {
      display: inline-block;
      vertical-align: middle;
      width: 1em;
      height: 1.5em !important;
      stroke-width: 0;
      stroke: currentColor;
      fill: currentColor;
    }

    .xr-var-attrs-in:checked + label > .xr-icon-file-text2,
    .xr-var-data-in:checked + label > .xr-icon-database,
    .xr-index-data-in:checked + label > .xr-icon-database {
      color: var(--xr-font-color0);
      filter: drop-shadow(1px 1px 5px var(--xr-font-color2));
      stroke-width: 0.8px;
    }
    </style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 343MB
    Dimensions:    (wave_type: 4, lat: 17, lon: 144, time: 1461)
    Coordinates:
      * wave_type  (wave_type) &lt;U6 96B &#x27;kelvin&#x27; &#x27;wmrg&#x27; &#x27;r1&#x27; &#x27;r2&#x27;
      * lat        (lat) float32 68B -20.0 -17.5 -15.0 -12.5 ... 12.5 15.0 17.5 20.0
      * lon        (lon) float32 576B 0.0 2.5 5.0 7.5 ... 350.0 352.5 355.0 357.5
      * time       (time) datetime64[ns] 12kB 2021-01-01 2021-01-02 ... 2024-12-31
        level      float32 4B 850.0
    Data variables:
        u          (wave_type, time, lat, lon) float64 114MB -0.001955 ... 0.0107
        v          (wave_type, time, lat, lon) float64 114MB 0.0 0.0 ... 0.01983
        z          (wave_type, time, lat, lon) float64 114MB -0.004085 ... 0.0642</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-4cfcac05-a954-4af6-96f2-644b944cdcaf' class='xr-section-summary-in' type='checkbox' disabled /><label for='section-4cfcac05-a954-4af6-96f2-644b944cdcaf' class='xr-section-summary'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>wave_type</span>: 4</li><li><span class='xr-has-index'>lat</span>: 17</li><li><span class='xr-has-index'>lon</span>: 144</li><li><span class='xr-has-index'>time</span>: 1461</li></ul></div></li><li class='xr-section-item'><input id='section-92f34ab0-dce4-47e4-b23b-797de1499ddc' class='xr-section-summary-in' type='checkbox' checked /><label for='section-92f34ab0-dce4-47e4-b23b-797de1499ddc' class='xr-section-summary' title='Expand/collapse section'>Coordinates: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>wave_type</span></div><div class='xr-var-dims'>(wave_type)</div><div class='xr-var-dtype'>&lt;U6</div><div class='xr-var-preview xr-preview'>&#x27;kelvin&#x27; &#x27;wmrg&#x27; &#x27;r1&#x27; &#x27;r2&#x27;</div><input id='attrs-0dc64fba-8977-4b0c-92b6-e1d9186d9f9d' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-0dc64fba-8977-4b0c-92b6-e1d9186d9f9d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-11c60003-4df6-431e-abef-d06a57f033e7' class='xr-var-data-in' type='checkbox'><label for='data-11c60003-4df6-431e-abef-d06a57f033e7' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;kelvin&#x27;, &#x27;wmrg&#x27;, &#x27;r1&#x27;, &#x27;r2&#x27;], dtype=&#x27;&lt;U6&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-20.0 -17.5 -15.0 ... 17.5 20.0</div><input id='attrs-5bbc5dbf-d78a-482b-aa6a-a9903632177f' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-5bbc5dbf-d78a-482b-aa6a-a9903632177f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-81d7b283-318d-4d75-a89a-0361171ec66a' class='xr-var-data-in' type='checkbox'><label for='data-81d7b283-318d-4d75-a89a-0361171ec66a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>long_name :</span></dt><dd>Latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>axis :</span></dt><dd>Y</dd></dl></div><div class='xr-var-data'><pre>array([-20. , -17.5, -15. , -12.5, -10. ,  -7.5,  -5. ,  -2.5,   0. ,   2.5,
             5. ,   7.5,  10. ,  12.5,  15. ,  17.5,  20. ], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.0 2.5 5.0 ... 352.5 355.0 357.5</div><input id='attrs-03e4abf6-460c-4c24-84a8-d6f806ac262c' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-03e4abf6-460c-4c24-84a8-d6f806ac262c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2e6c7b5b-5fb1-4f7c-a151-f098561d03aa' class='xr-var-data-in' type='checkbox'><label for='data-2e6c7b5b-5fb1-4f7c-a151-f098561d03aa' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>long_name :</span></dt><dd>Longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>axis :</span></dt><dd>X</dd></dl></div><div class='xr-var-data'><pre>array([  0. ,   2.5,   5. ,   7.5,  10. ,  12.5,  15. ,  17.5,  20. ,  22.5,
            25. ,  27.5,  30. ,  32.5,  35. ,  37.5,  40. ,  42.5,  45. ,  47.5,
            50. ,  52.5,  55. ,  57.5,  60. ,  62.5,  65. ,  67.5,  70. ,  72.5,
            75. ,  77.5,  80. ,  82.5,  85. ,  87.5,  90. ,  92.5,  95. ,  97.5,
           100. , 102.5, 105. , 107.5, 110. , 112.5, 115. , 117.5, 120. , 122.5,
           125. , 127.5, 130. , 132.5, 135. , 137.5, 140. , 142.5, 145. , 147.5,
           150. , 152.5, 155. , 157.5, 160. , 162.5, 165. , 167.5, 170. , 172.5,
           175. , 177.5, 180. , 182.5, 185. , 187.5, 190. , 192.5, 195. , 197.5,
           200. , 202.5, 205. , 207.5, 210. , 212.5, 215. , 217.5, 220. , 222.5,
           225. , 227.5, 230. , 232.5, 235. , 237.5, 240. , 242.5, 245. , 247.5,
           250. , 252.5, 255. , 257.5, 260. , 262.5, 265. , 267.5, 270. , 272.5,
           275. , 277.5, 280. , 282.5, 285. , 287.5, 290. , 292.5, 295. , 297.5,
           300. , 302.5, 305. , 307.5, 310. , 312.5, 315. , 317.5, 320. , 322.5,
           325. , 327.5, 330. , 332.5, 335. , 337.5, 340. , 342.5, 345. , 347.5,
           350. , 352.5, 355. , 357.5], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2021-01-01 ... 2024-12-31</div><input id='attrs-59f6196f-d535-41e6-92bc-e6e8da654a0e' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-59f6196f-d535-41e6-92bc-e6e8da654a0e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-58c7eafb-3f38-44db-b04e-8e45e9de10a0' class='xr-var-data-in' type='checkbox'><label for='data-58c7eafb-3f38-44db-b04e-8e45e9de10a0' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>time</dd><dt><span>long_name :</span></dt><dd>Time</dd><dt><span>axis :</span></dt><dd>T</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;2021-01-01T00:00:00.000000000&#x27;, &#x27;2021-01-02T00:00:00.000000000&#x27;,
           &#x27;2021-01-03T00:00:00.000000000&#x27;, ..., &#x27;2024-12-29T00:00:00.000000000&#x27;,
           &#x27;2024-12-30T00:00:00.000000000&#x27;, &#x27;2024-12-31T00:00:00.000000000&#x27;],
          shape=(1461,), dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>level</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>850.0</div><input id='attrs-863b443d-cded-41c5-b568-af8dc65666c7' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-863b443d-cded-41c5-b568-af8dc65666c7' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6723bd9f-ceed-467e-aca1-a1ba7b5ff657' class='xr-var-data-in' type='checkbox'><label for='data-6723bd9f-ceed-467e-aca1-a1ba7b5ff657' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>air_pressure</dd><dt><span>long_name :</span></dt><dd>Level</dd><dt><span>units :</span></dt><dd>millibar</dd><dt><span>positive :</span></dt><dd>down</dd><dt><span>axis :</span></dt><dd>Z</dd><dt><span>actual_range :</span></dt><dd>[1000.   10.]</dd><dt><span>GRIB_id :</span></dt><dd>100</dd><dt><span>GRIB_name :</span></dt><dd>hPa</dd></dl></div><div class='xr-var-data'><pre>array(850., dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-f20aa605-2107-4e71-acbd-3e50a58b536b' class='xr-section-summary-in' type='checkbox' checked /><label for='section-f20aa605-2107-4e71-acbd-3e50a58b536b' class='xr-section-summary' title='Expand/collapse section'>Data variables: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>u</span></div><div class='xr-var-dims'>(wave_type, time, lat, lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-0.001955 -0.002106 ... 0.0107</div><input id='attrs-680a221b-e684-45ad-b4d7-bf969dcc614f' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-680a221b-e684-45ad-b4d7-bf969dcc614f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-513be0bf-bda9-4471-bf97-adb3d7783bac' class='xr-var-data-in' type='checkbox'><label for='data-513be0bf-bda9-4471-bf97-adb3d7783bac' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>zonal wind</dd><dt><span>units :</span></dt><dd>m/s</dd></dl></div><div class='xr-var-data'><pre>array([[[[-1.95498509e-03, -2.10621787e-03, -1.78770700e-03, ...,
               1.24413225e-04, -6.12496327e-04, -1.39463583e-03],
             [-3.74875592e-03, -4.03875034e-03, -3.42799402e-03, ...,
               2.38566942e-04, -1.17448427e-03, -2.67426556e-03],
             [-6.59070455e-03, -7.10054504e-03, -6.02677162e-03, ...,
               4.19425608e-04, -2.06486604e-03, -4.70163825e-03],
             ...,
             [-6.59070455e-03, -7.10054504e-03, -6.02677162e-03, ...,
               4.19425608e-04, -2.06486604e-03, -4.70163825e-03],
             [-3.74875592e-03, -4.03875034e-03, -3.42799402e-03, ...,
               2.38566942e-04, -1.17448427e-03, -2.67426556e-03],
             [-1.95498509e-03, -2.10621787e-03, -1.78770700e-03, ...,
               1.24413225e-04, -6.12496327e-04, -1.39463583e-03]],

            [[-2.35741537e-03, -2.68701437e-03, -2.76377258e-03, ...,
              -1.54207546e-03, -1.65656953e-03, -1.95487690e-03],
             [-4.52043081e-03, -5.15244903e-03, -5.29963572e-03, ...,
              -2.95698649e-03, -3.17653309e-03, -3.74854846e-03],
             [-7.94738963e-03, -9.05854368e-03, -9.31731326e-03, ...,
              -5.19869118e-03, -5.58467703e-03, -6.59033981e-03],
    ...
               3.22359004e-02,  1.87244443e-02,  3.03025627e-03],
             [-5.39510897e-03, -6.90273294e-03, -1.36407631e-03, ...,
               1.48473088e-02,  9.68106845e-03,  1.52149306e-03],
             [-2.47439442e-03, -1.54350582e-03,  5.19750580e-03, ...,
               4.34860599e-03,  3.88266689e-03,  5.70279976e-04]],

            [[-3.24842491e-03, -3.19311458e-03, -1.17953741e-02, ...,
              -2.27582712e-02, -1.95851447e-02, -1.06972350e-02],
             [ 3.96170311e-03,  5.91248006e-03, -1.84535125e-03, ...,
              -2.89262633e-02, -2.03619266e-02, -6.79118932e-03],
             [ 1.82624207e-02,  2.36286923e-02,  2.06563004e-02, ...,
              -3.14984323e-02, -1.43605023e-02,  4.33746286e-03],
             ...,
             [-1.82624207e-02, -2.36286923e-02, -2.06563004e-02, ...,
               3.14984323e-02,  1.43605023e-02, -4.33746286e-03],
             [-3.96170311e-03, -5.91248006e-03,  1.84535125e-03, ...,
               2.89262633e-02,  2.03619266e-02,  6.79118932e-03],
             [ 3.24842491e-03,  3.19311458e-03,  1.17953741e-02, ...,
               2.27582712e-02,  1.95851447e-02,  1.06972350e-02]]]],
          shape=(4, 1461, 17, 144))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>v</span></div><div class='xr-var-dims'>(wave_type, time, lat, lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 0.0 0.0 ... 0.02962 0.01983</div><input id='attrs-54773d3d-9e8c-4031-9a51-e9a7e437856a' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-54773d3d-9e8c-4031-9a51-e9a7e437856a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3b42356f-bc26-41b4-9db7-ed3e84d1f652' class='xr-var-data-in' type='checkbox'><label for='data-3b42356f-bc26-41b4-9db7-ed3e84d1f652' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>zonal wind</dd><dt><span>units :</span></dt><dd>m/s</dd></dl></div><div class='xr-var-data'><pre>array([[[[ 0.00000000e+00,  0.00000000e+00,  0.00000000e+00, ...,
               0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
             [ 0.00000000e+00,  0.00000000e+00,  0.00000000e+00, ...,
               0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
             [ 0.00000000e+00,  0.00000000e+00,  0.00000000e+00, ...,
               0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
             ...,
             [ 0.00000000e+00,  0.00000000e+00,  0.00000000e+00, ...,
               0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
             [ 0.00000000e+00,  0.00000000e+00,  0.00000000e+00, ...,
               0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
             [ 0.00000000e+00,  0.00000000e+00,  0.00000000e+00, ...,
               0.00000000e+00,  0.00000000e+00,  0.00000000e+00]],

            [[ 0.00000000e+00,  0.00000000e+00,  0.00000000e+00, ...,
               0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
             [ 0.00000000e+00,  0.00000000e+00,  0.00000000e+00, ...,
               0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
             [ 0.00000000e+00,  0.00000000e+00,  0.00000000e+00, ...,
               0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
    ...
               4.61743283e-02,  4.86535998e-02,  4.38924688e-02],
             [ 3.09038701e-02,  2.86219256e-02,  2.83966933e-02, ...,
               3.75543118e-02,  3.95707425e-02,  3.56984394e-02],
             [ 2.17072504e-02,  2.01043851e-02,  1.99461793e-02, ...,
               2.63786007e-02,  2.77949659e-02,  2.50750136e-02]],

            [[ 1.40708502e-02,  1.37288316e-02,  1.58601224e-02, ...,
               3.81008140e-02,  2.96218402e-02,  1.98261343e-02],
             [ 2.00321883e-02,  1.95452681e-02,  2.25795139e-02, ...,
               5.42428260e-02,  4.21716009e-02,  2.82257895e-02],
             [ 2.46302699e-02,  2.40315847e-02,  2.77622952e-02, ...,
               6.66934351e-02,  5.18514453e-02,  3.47045867e-02],
             ...,
             [ 2.46302699e-02,  2.40315847e-02,  2.77622952e-02, ...,
               6.66934351e-02,  5.18514453e-02,  3.47045867e-02],
             [ 2.00321883e-02,  1.95452681e-02,  2.25795139e-02, ...,
               5.42428260e-02,  4.21716009e-02,  2.82257895e-02],
             [ 1.40708502e-02,  1.37288316e-02,  1.58601224e-02, ...,
               3.81008140e-02,  2.96218402e-02,  1.98261343e-02]]]],
          shape=(4, 1461, 17, 144))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>z</span></div><div class='xr-var-dims'>(wave_type, time, lat, lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-0.004085 -0.004401 ... 0.0642</div><input id='attrs-f928d928-8375-4fe7-8589-f96d62785d7e' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-f928d928-8375-4fe7-8589-f96d62785d7e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7ff1360c-9218-46e7-b020-7f91613d21cb' class='xr-var-data-in' type='checkbox'><label for='data-7ff1360c-9218-46e7-b020-7f91613d21cb' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>geopotential height</dd><dt><span>units :</span></dt><dd>m</dd></dl></div><div class='xr-var-data'><pre>array([[[[-4.08458231e-03, -4.40055542e-03, -3.73508546e-03, ...,
               2.59938585e-04, -1.27969859e-03, -2.91383543e-03],
             [-7.83233702e-03, -8.43822711e-03, -7.16216395e-03, ...,
               4.98441811e-04, -2.45386918e-03, -5.58738676e-03],
             [-1.37700667e-02, -1.48352848e-02, -1.25918325e-02, ...,
               8.76312778e-04, -4.31415837e-03, -9.82320965e-03],
             ...,
             [-1.37700667e-02, -1.48352848e-02, -1.25918325e-02, ...,
               8.76312778e-04, -4.31415837e-03, -9.82320965e-03],
             [-7.83233702e-03, -8.43822711e-03, -7.16216395e-03, ...,
               4.98441811e-04, -2.45386918e-03, -5.58738676e-03],
             [-4.08458231e-03, -4.40055542e-03, -3.73508546e-03, ...,
               2.59938585e-04, -1.27969859e-03, -2.91383543e-03]],

            [[-4.92538648e-03, -5.61402305e-03, -5.77439523e-03, ...,
              -3.22188347e-03, -3.46109780e-03, -4.08435626e-03],
             [-9.44460999e-03, -1.07650960e-02, -1.10726155e-02, ...,
              -6.17808022e-03, -6.63678251e-03, -7.83190357e-03],
             [-1.66046111e-02, -1.89261634e-02, -1.94668149e-02, ...,
              -1.08617105e-02, -1.16681570e-02, -1.37693047e-02],
    ...
              -1.26691685e-01, -6.40060789e-02, -1.07685531e-02],
             [ 2.22598164e-02,  5.25332003e-02,  9.19624788e-02, ...,
              -9.77447272e-02, -4.82078314e-02, -8.16838009e-03],
             [ 1.48153137e-02,  3.66806040e-02,  6.73677196e-02, ...,
              -6.76589438e-02, -3.26751145e-02, -5.57150258e-03]],

            [[-6.62223843e-02, -8.07502665e-02, -1.14558733e-01, ...,
              -2.42696502e-02, -5.60345197e-02, -6.41958615e-02],
             [-9.14461174e-02, -1.11939751e-01, -1.54718035e-01, ...,
              -2.13765974e-02, -6.79030569e-02, -8.43999559e-02],
             [-1.12121831e-01, -1.37934805e-01, -1.84184225e-01, ...,
              -6.94957739e-03, -6.82206317e-02, -9.67419251e-02],
             ...,
             [ 1.12121831e-01,  1.37934805e-01,  1.84184225e-01, ...,
               6.94957739e-03,  6.82206317e-02,  9.67419251e-02],
             [ 9.14461174e-02,  1.11939751e-01,  1.54718035e-01, ...,
               2.13765974e-02,  6.79030569e-02,  8.43999559e-02],
             [ 6.62223843e-02,  8.07502665e-02,  1.14558733e-01, ...,
               2.42696502e-02,  5.60345197e-02,  6.41958615e-02]]]],
          shape=(4, 1461, 17, 144))</pre></div></li></ul></div></li></ul></div></div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 38-46

Visualizing the Waves
-------------------------------
Let's meet our wave dancers one by one and see their unique moves!

The Graceful Kelvin Wave
~~~~~~~~~~~~~~~~~~~~~~~~~~~
Kelvin waves move eastward with elegant symmetry, like ballet dancers:


.. GENERATED FROM PYTHON SOURCE LINES 46-71

.. code-block:: Python


    fig, ax = ecl.plot.quick_draw_spatial_basemap(figsize=(9, 4), central_longitude=180)
    ax.set_extent([20, 180, -20, 20], crs = ccrs.PlateCarree())

    # Contour plot for height field
    result.sel(wave_type = "kelvin").z.sel(time = "2023-12-15").plot.contourf(
        ax = ax,
        levels=21,
        transform = ccrs.PlateCarree(),
        cbar_kwargs={"location": "bottom", "aspect": 50, "shrink": 0.5},
    )

    # Quiver plot for wind vectors
    result.sel(wave_type = "kelvin")[["u", "v"]].sel(time = "2023-12-15").thin(lon=1, lat=1).plot.quiver(
        x = "lon", y = 'lat',
        u = "u", v = "v",
        ax = ax,
        scale = 30,
        headlength = 5,
        minlength = 1.5,
        transform = ccrs.PlateCarree()
    )

    ax.set_title("Kelvin Waves")




.. image-sg:: /auto_gallery/filter/images/sphx_glr_plot_spatial_pcf_001.png
   :alt: Kelvin Waves
   :srcset: /auto_gallery/filter/images/sphx_glr_plot_spatial_pcf_001.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    Text(0.5, 1.0, 'Kelvin Waves')



.. GENERATED FROM PYTHON SOURCE LINES 72-76

The WMRG Wave
~~~~~~~~~~~~~~~~~~~~~~~~~~
Westward-moving Mixed Rossby-Gravity waves have more complex moves, like contemporary dancers:


.. GENERATED FROM PYTHON SOURCE LINES 76-98

.. code-block:: Python


    fig, ax = ecl.plot.quick_draw_spatial_basemap(figsize=(9, 4), central_longitude=180)
    ax.set_extent([20, 180, -20, 20], crs = ccrs.PlateCarree())

    result.sel(wave_type = "wmrg").z.sel(time = "2023-12-15").plot.contourf(
        ax = ax,
        levels=21,
        transform = ccrs.PlateCarree(),
        cbar_kwargs={"location": "bottom", "aspect": 50, "shrink": 0.5},
    )
    result.sel(wave_type = "wmrg")[["u", "v"]].sel(time = "2023-12-15").thin(lon=1, lat=1).plot.quiver(
        x = "lon", y = 'lat',
        u = "u", v = "v",
        ax = ax,
        scale = 30,
        headlength = 5,
        minlength = 1.5,
        transform = ccrs.PlateCarree()
    )

    ax.set_title("Westward Mixed Rossby-Gravity Waves")




.. image-sg:: /auto_gallery/filter/images/sphx_glr_plot_spatial_pcf_002.png
   :alt: Westward Mixed Rossby-Gravity Waves
   :srcset: /auto_gallery/filter/images/sphx_glr_plot_spatial_pcf_002.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    Text(0.5, 1.0, 'Westward Mixed Rossby-Gravity Waves')



.. GENERATED FROM PYTHON SOURCE LINES 99-106

The Rossby Waves
~~~~~~~~~~~~~~~~~~~~~~~~~~~
Rossby waves come in different "generations", let's meet the first two:

:math:`[n=1]` Rossby Wave
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^


.. GENERATED FROM PYTHON SOURCE LINES 106-128

.. code-block:: Python


    fig, ax = ecl.plot.quick_draw_spatial_basemap(figsize=(9, 4), central_longitude=180)
    ax.set_extent([20, 180, -20, 20], crs = ccrs.PlateCarree())

    result.sel(wave_type = "r1").z.sel(time = "2023-12-15").plot.contourf(
        ax = ax,
        levels=21,
        transform = ccrs.PlateCarree(),
        cbar_kwargs={"location": "bottom", "aspect": 50, "shrink": 0.5},
    )
    result.sel(wave_type = "r1")[["u", "v"]].sel(time = "2023-12-15").thin(lon=1, lat=1).plot.quiver(
        x = "lon", y = 'lat',
        u = "u", v = "v",
        ax = ax,
        scale = 70,
        headlength = 5,
        minlength = 1.5,
        transform = ccrs.PlateCarree()
    )

    ax.set_title("$n = 1$ Equatorial Rossby Waves")




.. image-sg:: /auto_gallery/filter/images/sphx_glr_plot_spatial_pcf_003.png
   :alt: $n = 1$ Equatorial Rossby Waves
   :srcset: /auto_gallery/filter/images/sphx_glr_plot_spatial_pcf_003.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    Text(0.5, 1.0, '$n = 1$ Equatorial Rossby Waves')



.. GENERATED FROM PYTHON SOURCE LINES 129-132

:math:`[n=2]` Rossby Wave
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^


.. GENERATED FROM PYTHON SOURCE LINES 132-154

.. code-block:: Python


    fig, ax = ecl.plot.quick_draw_spatial_basemap(figsize=(9, 4), central_longitude=180)
    ax.set_extent([20, 180, -20, 20], crs = ccrs.PlateCarree())

    result.sel(wave_type = "r2").z.sel(time = "2023-12-15").plot.contourf(
        ax = ax,
        levels=21,
        transform = ccrs.PlateCarree(),
        cbar_kwargs={"location": "bottom", "aspect": 50, "shrink": 0.5},
    )
    result.sel(wave_type = "r2")[["u", "v"]].sel(time = "2023-12-15").thin(lon=1, lat=1).plot.quiver(
        x = "lon", y = 'lat',
        u = "u", v = "v",
        ax = ax,
        scale = 40,
        headlength = 5,
        minlength = 1.5,
        transform = ccrs.PlateCarree()
    )

    ax.set_title("$n = 2$ Equatorial Rossby Waves")




.. image-sg:: /auto_gallery/filter/images/sphx_glr_plot_spatial_pcf_004.png
   :alt: $n = 2$ Equatorial Rossby Waves
   :srcset: /auto_gallery/filter/images/sphx_glr_plot_spatial_pcf_004.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    Text(0.5, 1.0, '$n = 2$ Equatorial Rossby Waves')



.. GENERATED FROM PYTHON SOURCE LINES 155-171

Behind the Scenes: How the Magic Works
----------------------------------------------
The :py:func:`easyclimate.filter.filter_2D_spatial_parabolic_cylinder_function <easyclimate.filter.filter_2D_spatial_parabolic_cylinder_function>` performs some serious atmospheric wizardry:

1. Detrending and Windowing: Prepares the data by removing trends and applying spectral windows
2. Variable Transformation: Creates new variables that better represent wave structures
3. Fourier Analysis: Identifies frequency and wavenumber components
4. Projection: Maps the data onto parabolic cylinder functions that match equatorial wave structures
5. Filtering: Isolates specific wave types based on their characteristic patterns
6. Reconstruction: Brings everything back to physical space for visualization

Each wave type has its own signature moves:
  - Kelvin Waves: Eastward-moving, symmetric about the equator (:math:`n=0` mode)
  - WMRG Waves: Westward-moving with mixed characteristics (:math:`n=1` mode)
  - Rossby Waves: Westward-moving with more complex structures (:math:`n=2`, :math:`n=3` modes)



.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (0 minutes 8.447 seconds)


.. _sphx_glr_download_auto_gallery_filter_plot_spatial_pcf.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: plot_spatial_pcf.ipynb <plot_spatial_pcf.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: plot_spatial_pcf.py <plot_spatial_pcf.py>`

    .. container:: sphx-glr-download sphx-glr-download-zip

      :download:`Download zipped: plot_spatial_pcf.zip <plot_spatial_pcf.zip>`
