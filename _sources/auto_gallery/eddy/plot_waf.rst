
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_gallery/eddy/plot_waf.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_auto_gallery_eddy_plot_waf.py>`
        to download the full example code.

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_gallery_eddy_plot_waf.py:


.. _max_waf_example:

Wave Activity Horizontal Flux
============================================

In this tutorial, we'll explore how to visualize and analyze Rossby waves - those giant meanders in high-altitude winds that shape our weather patterns.
Think of them as the "weather rivers" flowing through our atmosphere!

.. GENERATED FROM PYTHON SOURCE LINES 11-21

.. code-block:: Python

    import xarray as xr
    import numpy as np
    import cartopy.crs as ccrs
    import matplotlib.pyplot as plt
    import easyclimate as ecl
    import matplotlib.ticker as ticker

    formatter = ticker.ScalarFormatter(useMathText=True, useOffset=True)
    formatter.set_powerlimits((0, 0))








.. GENERATED FROM PYTHON SOURCE LINES 22-27

.. code-block:: Python

    z500_prime_data1 = ecl.open_tutorial_dataset("era5_daily_z500_prime_201411_N15.nc").z /9.8
    z500_prime_data2 = ecl.open_tutorial_dataset("era5_daily_z500_prime_202411_N15.nc").z /9.8
    u500_climatology_data = ecl.open_tutorial_dataset("era5_ymean_monthly_u500_199101_202012_N15.nc").u
    v500_climatology_data = ecl.open_tutorial_dataset("era5_ymean_monthly_v500_199101_202012_N15.nc").v





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    era5_daily_z500_prime_201411_N15.nc ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ 100.0% ‚Ä¢ 229.2/‚Ä¶ ‚Ä¢ 14.1    ‚Ä¢ 0:00:00
                                                         kB        MB/s             
    era5_daily_z500_prime_202411_N15.nc ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ 100.0% ‚Ä¢ 227.9/‚Ä¶ ‚Ä¢ 13.1    ‚Ä¢ 0:00:00
                                                         kB        MB/s             
    era5_ymean_monthly_u500_199101_202012_N15.nc ‚îÅ‚îÅ‚îÅ‚îÅ 100.0% ‚Ä¢ 125.‚Ä¶ ‚Ä¢ 7.8  ‚Ä¢ 0:00:‚Ä¶
                                                               kB      MB/s         
    era5_ymean_monthly_v500_199101_202012_N15.nc ‚îÅ‚îÅ‚îÅ‚îÅ 100.0% ‚Ä¢ 126.‚Ä¶ ‚Ä¢ 9.4  ‚Ä¢ 0:00:‚Ä¶
                                                               kB      MB/s         




.. GENERATED FROM PYTHON SOURCE LINES 28-30

TN01 Wave Activity Horizontal Flux
-----------------------------------------

.. GENERATED FROM PYTHON SOURCE LINES 30-39

.. code-block:: Python

    tn01_result1 = ecl.calc_TN_wave_activity_horizontal_flux(
        z_prime_data = z500_prime_data1,
        u_climatology_data = u500_climatology_data,
        v_climatology_data = v500_climatology_data,
        vertical_dim = "level",
        vertical_dim_units = "hPa",
    )
    tn01_result1






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
    <defs>
    <symbol id="icon-database" viewBox="0 0 32 32">
    <path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
    <path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    <path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    </symbol>
    <symbol id="icon-file-text2" viewBox="0 0 32 32">
    <path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
    <path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    </symbol>
    </defs>
    </svg>
    <style>/* CSS stylesheet for displaying xarray objects in notebooks */

    :root {
      --xr-font-color0: var(
        --jp-content-font-color0,
        var(--pst-color-text-base rgba(0, 0, 0, 1))
      );
      --xr-font-color2: var(
        --jp-content-font-color2,
        var(--pst-color-text-base, rgba(0, 0, 0, 0.54))
      );
      --xr-font-color3: var(
        --jp-content-font-color3,
        var(--pst-color-text-base, rgba(0, 0, 0, 0.38))
      );
      --xr-border-color: var(
        --jp-border-color2,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 10))
      );
      --xr-disabled-color: var(
        --jp-layout-color3,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 40))
      );
      --xr-background-color: var(
        --jp-layout-color0,
        var(--pst-color-on-background, white)
      );
      --xr-background-color-row-even: var(
        --jp-layout-color1,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 5))
      );
      --xr-background-color-row-odd: var(
        --jp-layout-color2,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 15))
      );
    }

    html[theme="dark"],
    html[data-theme="dark"],
    body[data-theme="dark"],
    body.vscode-dark {
      --xr-font-color0: var(
        --jp-content-font-color0,
        var(--pst-color-text-base, rgba(255, 255, 255, 1))
      );
      --xr-font-color2: var(
        --jp-content-font-color2,
        var(--pst-color-text-base, rgba(255, 255, 255, 0.54))
      );
      --xr-font-color3: var(
        --jp-content-font-color3,
        var(--pst-color-text-base, rgba(255, 255, 255, 0.38))
      );
      --xr-border-color: var(
        --jp-border-color2,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))
      );
      --xr-disabled-color: var(
        --jp-layout-color3,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))
      );
      --xr-background-color: var(
        --jp-layout-color0,
        var(--pst-color-on-background, #111111)
      );
      --xr-background-color-row-even: var(
        --jp-layout-color1,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))
      );
      --xr-background-color-row-odd: var(
        --jp-layout-color2,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))
      );
    }

    .xr-wrap {
      display: block !important;
      min-width: 300px;
      max-width: 700px;
      line-height: 1.6;
      padding-bottom: 4px;
    }

    .xr-text-repr-fallback {
      /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
      display: none;
    }

    .xr-header {
      padding-top: 6px;
      padding-bottom: 6px;
    }

    .xr-header {
      border-bottom: solid 1px var(--xr-border-color);
      margin-bottom: 4px;
    }

    .xr-header > div,
    .xr-header > ul {
      display: inline;
      margin-top: 0;
      margin-bottom: 0;
    }

    .xr-obj-type,
    .xr-obj-name {
      margin-left: 2px;
      margin-right: 10px;
    }

    .xr-obj-type,
    .xr-group-box-contents > label {
      color: var(--xr-font-color2);
      display: block;
    }

    .xr-sections {
      padding-left: 0 !important;
      display: grid;
      grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
      margin-block-start: 0;
      margin-block-end: 0;
    }

    .xr-section-item {
      display: contents;
    }

    .xr-section-item > input,
    .xr-group-box-contents > input,
    .xr-array-wrap > input {
      display: block;
      opacity: 0;
      height: 0;
      margin: 0;
    }

    .xr-section-item > input + label,
    .xr-var-item > input + label {
      color: var(--xr-disabled-color);
    }

    .xr-section-item > input:enabled + label,
    .xr-var-item > input:enabled + label,
    .xr-array-wrap > input:enabled + label,
    .xr-group-box-contents > input:enabled + label {
      cursor: pointer;
      color: var(--xr-font-color2);
    }

    .xr-section-item > input:focus-visible + label,
    .xr-var-item > input:focus-visible + label,
    .xr-array-wrap > input:focus-visible + label,
    .xr-group-box-contents > input:focus-visible + label {
      outline: auto;
    }

    .xr-section-item > input:enabled + label:hover,
    .xr-var-item > input:enabled + label:hover,
    .xr-array-wrap > input:enabled + label:hover,
    .xr-group-box-contents > input:enabled + label:hover {
      color: var(--xr-font-color0);
    }

    .xr-section-summary {
      grid-column: 1;
      color: var(--xr-font-color2);
      font-weight: 500;
      white-space: nowrap;
    }

    .xr-section-summary > em {
      font-weight: normal;
    }

    .xr-span-grid {
      grid-column-end: -1;
    }

    .xr-section-summary > span {
      display: inline-block;
      padding-left: 0.3em;
    }

    .xr-group-box-contents > input:checked + label > span {
      display: inline-block;
      padding-left: 0.6em;
    }

    .xr-section-summary-in:disabled + label {
      color: var(--xr-font-color2);
    }

    .xr-section-summary-in + label:before {
      display: inline-block;
      content: "‚ñ∫";
      font-size: 11px;
      width: 15px;
      text-align: center;
    }

    .xr-section-summary-in:disabled + label:before {
      color: var(--xr-disabled-color);
    }

    .xr-section-summary-in:checked + label:before {
      content: "‚ñº";
    }

    .xr-section-summary-in:checked + label > span {
      display: none;
    }

    .xr-section-summary,
    .xr-section-inline-details,
    .xr-group-box-contents > label {
      padding-top: 4px;
    }

    .xr-section-inline-details {
      grid-column: 2 / -1;
    }

    .xr-section-details {
      grid-column: 1 / -1;
      margin-top: 4px;
      margin-bottom: 5px;
    }

    .xr-section-summary-in ~ .xr-section-details {
      display: none;
    }

    .xr-section-summary-in:checked ~ .xr-section-details {
      display: contents;
    }

    .xr-children {
      display: inline-grid;
      grid-template-columns: 100%;
      grid-column: 1 / -1;
      padding-top: 4px;
    }

    .xr-group-box {
      display: inline-grid;
      grid-template-columns: 0px 30px auto;
    }

    .xr-group-box-vline {
      grid-column-start: 1;
      border-right: 0.2em solid;
      border-color: var(--xr-border-color);
      width: 0px;
    }

    .xr-group-box-hline {
      grid-column-start: 2;
      grid-row-start: 1;
      height: 1em;
      width: 26px;
      border-bottom: 0.2em solid;
      border-color: var(--xr-border-color);
    }

    .xr-group-box-contents {
      grid-column-start: 3;
      padding-bottom: 4px;
    }

    .xr-group-box-contents > label::before {
      content: "üìÇ";
      padding-right: 0.3em;
    }

    .xr-group-box-contents > input:checked + label::before {
      content: "üìÅ";
    }

    .xr-group-box-contents > input:checked + label {
      padding-bottom: 0px;
    }

    .xr-group-box-contents > input:checked ~ .xr-sections {
      display: none;
    }

    .xr-group-box-contents > input + label > span {
      display: none;
    }

    .xr-group-box-ellipsis {
      font-size: 1.4em;
      font-weight: 900;
      color: var(--xr-font-color2);
      letter-spacing: 0.15em;
      cursor: default;
    }

    .xr-array-wrap {
      grid-column: 1 / -1;
      display: grid;
      grid-template-columns: 20px auto;
    }

    .xr-array-wrap > label {
      grid-column: 1;
      vertical-align: top;
    }

    .xr-preview {
      color: var(--xr-font-color3);
    }

    .xr-array-preview,
    .xr-array-data {
      padding: 0 5px !important;
      grid-column: 2;
    }

    .xr-array-data,
    .xr-array-in:checked ~ .xr-array-preview {
      display: none;
    }

    .xr-array-in:checked ~ .xr-array-data,
    .xr-array-preview {
      display: inline-block;
    }

    .xr-dim-list {
      display: inline-block !important;
      list-style: none;
      padding: 0 !important;
      margin: 0;
    }

    .xr-dim-list li {
      display: inline-block;
      padding: 0;
      margin: 0;
    }

    .xr-dim-list:before {
      content: "(";
    }

    .xr-dim-list:after {
      content: ")";
    }

    .xr-dim-list li:not(:last-child):after {
      content: ",";
      padding-right: 5px;
    }

    .xr-has-index {
      font-weight: bold;
    }

    .xr-var-list,
    .xr-var-item {
      display: contents;
    }

    .xr-var-item > div,
    .xr-var-item label,
    .xr-var-item > .xr-var-name span {
      background-color: var(--xr-background-color-row-even);
      border-color: var(--xr-background-color-row-odd);
      margin-bottom: 0;
      padding-top: 2px;
    }

    .xr-var-item > .xr-var-name:hover span {
      padding-right: 5px;
    }

    .xr-var-list > li:nth-child(odd) > div,
    .xr-var-list > li:nth-child(odd) > label,
    .xr-var-list > li:nth-child(odd) > .xr-var-name span {
      background-color: var(--xr-background-color-row-odd);
      border-color: var(--xr-background-color-row-even);
    }

    .xr-var-name {
      grid-column: 1;
    }

    .xr-var-dims {
      grid-column: 2;
    }

    .xr-var-dtype {
      grid-column: 3;
      text-align: right;
      color: var(--xr-font-color2);
    }

    .xr-var-preview {
      grid-column: 4;
    }

    .xr-index-preview {
      grid-column: 2 / 5;
      color: var(--xr-font-color2);
    }

    .xr-var-name,
    .xr-var-dims,
    .xr-var-dtype,
    .xr-preview,
    .xr-attrs dt {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      padding-right: 10px;
    }

    .xr-var-name:hover,
    .xr-var-dims:hover,
    .xr-var-dtype:hover,
    .xr-attrs dt:hover {
      overflow: visible;
      width: auto;
      z-index: 1;
    }

    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      display: none;
      border-top: 2px dotted var(--xr-background-color);
      padding-bottom: 20px !important;
      padding-top: 10px !important;
    }

    .xr-var-attrs-in + label,
    .xr-var-data-in + label,
    .xr-index-data-in + label {
      padding: 0 1px;
    }

    .xr-var-attrs-in:checked ~ .xr-var-attrs,
    .xr-var-data-in:checked ~ .xr-var-data,
    .xr-index-data-in:checked ~ .xr-index-data {
      display: block;
    }

    .xr-var-data > table {
      float: right;
    }

    .xr-var-data > pre,
    .xr-index-data > pre,
    .xr-var-data > table > tbody > tr {
      background-color: transparent !important;
    }

    .xr-var-name span,
    .xr-var-data,
    .xr-index-name div,
    .xr-index-data,
    .xr-attrs {
      padding-left: 25px !important;
    }

    .xr-attrs,
    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      grid-column: 1 / -1;
    }

    dl.xr-attrs {
      padding: 0;
      margin: 0;
      display: grid;
      grid-template-columns: 125px auto;
    }

    .xr-attrs dt,
    .xr-attrs dd {
      padding: 0;
      margin: 0;
      float: left;
      padding-right: 10px;
      width: auto;
    }

    .xr-attrs dt {
      font-weight: normal;
      grid-column: 1;
    }

    .xr-attrs dt:hover span {
      display: inline-block;
      background: var(--xr-background-color);
      padding-right: 10px;
    }

    .xr-attrs dd {
      grid-column: 2;
      white-space: pre-wrap;
      word-break: break-all;
    }

    .xr-icon-database,
    .xr-icon-file-text2,
    .xr-no-icon {
      display: inline-block;
      vertical-align: middle;
      width: 1em;
      height: 1.5em !important;
      stroke-width: 0;
      stroke: currentColor;
      fill: currentColor;
    }

    .xr-var-attrs-in:checked + label > .xr-icon-file-text2,
    .xr-var-data-in:checked + label > .xr-icon-database,
    .xr-index-data-in:checked + label > .xr-icon-database {
      color: var(--xr-font-color0);
      filter: drop-shadow(1px 1px 5px var(--xr-font-color2));
      stroke-width: 0.8px;
    }
    </style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 649kB
    Dimensions:  (time: 30, lat: 30, lon: 60)
    Coordinates:
      * time     (time) datetime64[ns] 240B 2014-11-01T09:00:00 ... 2014-11-30T09...
      * lat      (lat) float64 240B 85.48 79.63 73.74 67.85 ... -73.74 -79.63 -85.48
      * lon      (lon) float64 480B 0.0 6.0 12.0 18.0 ... 336.0 342.0 348.0 354.0
        level    int32 4B 500
    Data variables:
        psi_p    (time, lat, lon) float32 216kB -1.907e+06 -2.313e+06 ... 4.293e+06
        fx       (time, lat, lon) float32 216kB 1.344 1.145 1.086 ... 0.1729 -1.051
        fy       (time, lat, lon) float32 216kB 0.1822 -0.1877 ... -0.5843 -0.8524
    Attributes:
        title:         Takaya and Nakamura Wave Activity Flux
        description:   Horizontal components of quasi-geostrophic wave activity f...
        reference:     Takaya, K. and H. Nakamura, 2001: A Formulation of a Phase...
        created_with:  easyclimate: calc_TN_wave_activity_horizontal_flux function</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-a0c5b738-8913-4c6e-85c2-bbc686583559' class='xr-section-summary-in' type='checkbox' disabled /><label for='section-a0c5b738-8913-4c6e-85c2-bbc686583559' class='xr-section-summary'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 30</li><li><span class='xr-has-index'>lat</span>: 30</li><li><span class='xr-has-index'>lon</span>: 60</li></ul></div></li><li class='xr-section-item'><input id='section-9d1a4d04-0645-4179-8ffd-504f19bd9c75' class='xr-section-summary-in' type='checkbox' checked /><label for='section-9d1a4d04-0645-4179-8ffd-504f19bd9c75' class='xr-section-summary' title='Expand/collapse section'>Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2014-11-01T09:00:00 ... 2014-11-...</div><input id='attrs-35267670-7ad5-45ba-8cdb-e179c324051b' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-35267670-7ad5-45ba-8cdb-e179c324051b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a6bc5927-84a7-433d-af05-e9f8b2714623' class='xr-var-data-in' type='checkbox'><label for='data-a6bc5927-84a7-433d-af05-e9f8b2714623' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>time</dd><dt><span>long_name :</span></dt><dd>time</dd><dt><span>axis :</span></dt><dd>T</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;2014-11-01T09:00:00.000000000&#x27;, &#x27;2014-11-02T09:00:00.000000000&#x27;,
           &#x27;2014-11-03T09:00:00.000000000&#x27;, &#x27;2014-11-04T09:00:00.000000000&#x27;,
           &#x27;2014-11-05T09:00:00.000000000&#x27;, &#x27;2014-11-06T09:00:00.000000000&#x27;,
           &#x27;2014-11-07T09:00:00.000000000&#x27;, &#x27;2014-11-08T09:00:00.000000000&#x27;,
           &#x27;2014-11-09T09:00:00.000000000&#x27;, &#x27;2014-11-10T09:00:00.000000000&#x27;,
           &#x27;2014-11-11T09:00:00.000000000&#x27;, &#x27;2014-11-12T09:00:00.000000000&#x27;,
           &#x27;2014-11-13T09:00:00.000000000&#x27;, &#x27;2014-11-14T09:00:00.000000000&#x27;,
           &#x27;2014-11-15T09:00:00.000000000&#x27;, &#x27;2014-11-16T09:00:00.000000000&#x27;,
           &#x27;2014-11-17T09:00:00.000000000&#x27;, &#x27;2014-11-18T09:00:00.000000000&#x27;,
           &#x27;2014-11-19T09:00:00.000000000&#x27;, &#x27;2014-11-20T09:00:00.000000000&#x27;,
           &#x27;2014-11-21T09:00:00.000000000&#x27;, &#x27;2014-11-22T09:00:00.000000000&#x27;,
           &#x27;2014-11-23T09:00:00.000000000&#x27;, &#x27;2014-11-24T09:00:00.000000000&#x27;,
           &#x27;2014-11-25T09:00:00.000000000&#x27;, &#x27;2014-11-26T09:00:00.000000000&#x27;,
           &#x27;2014-11-27T09:00:00.000000000&#x27;, &#x27;2014-11-28T09:00:00.000000000&#x27;,
           &#x27;2014-11-29T09:00:00.000000000&#x27;, &#x27;2014-11-30T09:00:00.000000000&#x27;],
          dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>85.48 79.63 73.74 ... -79.63 -85.48</div><input id='attrs-01253513-62c0-4736-9814-dbd982bd6877' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-01253513-62c0-4736-9814-dbd982bd6877' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b5196291-6814-4863-8bda-b273d73454ef' class='xr-var-data-in' type='checkbox'><label for='data-b5196291-6814-4863-8bda-b273d73454ef' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>long_name :</span></dt><dd>latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>axis :</span></dt><dd>Y</dd></dl></div><div class='xr-var-data'><pre>array([ 85.482617,  79.630722,  73.74427 ,  67.850013,  61.952799,  56.054157,
            50.154722,  44.254802,  38.354569,  32.454124,  26.553532,  20.652838,
            14.752072,   8.851261,   2.950423,  -2.950423,  -8.851261, -14.752072,
           -20.652838, -26.553532, -32.454124, -38.354569, -44.254802, -50.154722,
           -56.054157, -61.952799, -67.850013, -73.74427 , -79.630722, -85.482617])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 6.0 12.0 ... 342.0 348.0 354.0</div><input id='attrs-f541df38-3434-49e7-b289-19a45199b63a' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-f541df38-3434-49e7-b289-19a45199b63a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1f77475e-3d31-4569-ae32-77cddcaf4735' class='xr-var-data-in' type='checkbox'><label for='data-1f77475e-3d31-4569-ae32-77cddcaf4735' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>long_name :</span></dt><dd>longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>axis :</span></dt><dd>X</dd></dl></div><div class='xr-var-data'><pre>array([  0.,   6.,  12.,  18.,  24.,  30.,  36.,  42.,  48.,  54.,  60.,  66.,
            72.,  78.,  84.,  90.,  96., 102., 108., 114., 120., 126., 132., 138.,
           144., 150., 156., 162., 168., 174., 180., 186., 192., 198., 204., 210.,
           216., 222., 228., 234., 240., 246., 252., 258., 264., 270., 276., 282.,
           288., 294., 300., 306., 312., 318., 324., 330., 336., 342., 348., 354.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>level</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>500</div><input id='attrs-238738f7-9cd3-419f-b00d-e493b68ee164' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-238738f7-9cd3-419f-b00d-e493b68ee164' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5625d011-0791-4125-aecf-4446f6525e0e' class='xr-var-data-in' type='checkbox'><label for='data-5625d011-0791-4125-aecf-4446f6525e0e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>air_pressure</dd><dt><span>long_name :</span></dt><dd>pressure_level</dd><dt><span>units :</span></dt><dd>millibars</dd><dt><span>positive :</span></dt><dd>down</dd><dt><span>axis :</span></dt><dd>Z</dd></dl></div><div class='xr-var-data'><pre>array(500, dtype=int32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-087b7ac0-a8c7-4a2a-9541-0c5ab0d17219' class='xr-section-summary-in' type='checkbox' checked /><label for='section-087b7ac0-a8c7-4a2a-9541-0c5ab0d17219' class='xr-section-summary' title='Expand/collapse section'>Data variables: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>psi_p</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-1.907e+06 -2.313e+06 ... 4.293e+06</div><input id='attrs-8bb42e78-139a-4898-9db7-33542f2de105' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-8bb42e78-139a-4898-9db7-33542f2de105' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7062a032-7251-481d-a11e-982a615016ff' class='xr-var-data-in' type='checkbox'><label for='data-7062a032-7251-481d-a11e-982a615016ff' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Perturbation stream function</dd><dt><span>units :</span></dt><dd>m^2/s</dd><dt><span>description :</span></dt><dd>Geostrophic stream function perturbation calculated from geopotential height anomaly</dd></dl></div><div class='xr-var-data'><pre>array([[[-1.90720900e+06, -2.31338625e+06, -2.69185650e+06, ...,
             -7.08054750e+05, -1.09821388e+06, -1.49898962e+06],
            [ 2.96850375e+05, -4.54123008e+04, -3.05834406e+05, ...,
              2.70315175e+06,  1.68521388e+06,  8.38461500e+05],
            [ 8.16334050e+06,  7.54222700e+06,  6.61060550e+06, ...,
              9.17798000e+06,  8.86286000e+06,  8.55343500e+06],
            ...,
            [ 3.70620625e+06,  1.67576225e+06, -3.42585000e+05, ...,
              9.12193100e+06,  7.64613850e+06,  5.69692850e+06],
            [ 1.14794375e+06,  6.12344938e+05,  3.68297383e+04, ...,
              3.56009450e+06,  2.62367650e+06,  1.79726150e+06],
            [ 1.76298412e+06,  1.38865950e+06,  1.02669031e+06, ...,
              3.01684200e+06,  2.58131700e+06,  2.16111200e+06]],

           [[-5.72491500e+06, -6.28798900e+06, -6.82511550e+06, ...,
             -4.18055650e+06, -4.69219450e+06, -5.19787850e+06],
            [-5.22107950e+06, -6.65674400e+06, -7.76716900e+06, ...,
              2.14177125e+06, -6.66573875e+05, -3.31750100e+06],
            [-3.16307275e+06, -4.24561350e+06, -4.75879300e+06, ...,
              4.39627700e+06,  2.01747200e+06, -6.12686125e+05],
    ...
             -2.89416125e+05,  1.66728988e+06,  2.42813625e+06],
            [ 1.71888500e+06,  1.80305400e+06,  1.70237875e+06, ...,
              9.37945938e+05,  1.16079812e+06,  1.45982788e+06],
            [ 1.02475725e+06,  9.24317062e+05,  8.10245500e+05, ...,
              1.32246475e+06,  1.22855150e+06,  1.13331450e+06]],

           [[ 1.86941120e+07,  1.91987500e+07,  1.96029380e+07, ...,
              1.65789160e+07,  1.73752860e+07,  1.80829920e+07],
            [ 1.91650460e+07,  2.07838300e+07,  2.16150140e+07, ...,
              1.26606850e+07,  1.49801200e+07,  1.72003940e+07],
            [ 1.45662650e+07,  1.71665460e+07,  1.92578700e+07, ...,
              3.89251025e+06,  8.41122400e+06,  1.16778840e+07],
            ...,
            [ 1.64955512e+06,  1.22508138e+06, -1.42590953e+05, ...,
             -5.05698594e+05, -8.32617625e+05,  1.71772922e+05],
            [ 3.31589700e+06,  3.23510975e+06,  2.79191825e+06, ...,
              3.40501675e+06,  3.31231275e+06,  3.28767700e+06],
            [ 4.13147375e+06,  3.95393825e+06,  3.73407950e+06, ...,
              4.66497900e+06,  4.46615800e+06,  4.29292300e+06]]],
          shape=(30, 30, 60), dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>fx</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>1.344 1.145 1.086 ... 0.1729 -1.051</div><input id='attrs-d286d72b-df4d-4250-8240-6a497ccaaed8' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-d286d72b-df4d-4250-8240-6a497ccaaed8' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-71fc90bb-d3c4-44be-9095-fa6df2c4cf79' class='xr-var-data-in' type='checkbox'><label for='data-71fc90bb-d3c4-44be-9095-fa6df2c4cf79' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Zonal component of TN wave activity horizontal flux</dd><dt><span>units :</span></dt><dd>m^2/s^2</dd><dt><span>description :</span></dt><dd>Eastward component of Takaya and Nakamura wave activity flux</dd><dt><span>standard_name :</span></dt><dd>tn_wave_activity_flux_x</dd></dl></div><div class='xr-var-data'><pre>array([[[ 1.34373438e+00,  1.14466798e+00,  1.08612776e+00, ...,
              1.36000514e+00,  1.31464207e+00,  1.22799563e+00],
            [ 6.12278998e-01,  4.49711859e-01,  2.89822340e-01, ...,
              3.48513508e+00,  2.47630787e+00,  1.86892951e+00],
            [ 7.63243341e+00,  6.53607893e+00,  6.16761208e+00, ...,
             -1.18713784e+00,  7.21637249e-01,  2.94371629e+00],
            ...,
            [-4.04469109e+00, -5.12799358e+00, -5.47349977e+00, ...,
              4.97165442e+00,  1.44529891e+00,  2.42181134e+00],
            [ 1.34883836e-01,  2.10460365e-01,  2.81236589e-01, ...,
              2.35068083e+00,  1.10700595e+00,  5.12933671e-01],
            [-1.38768941e-01, -1.09133340e-01, -1.91300213e-01, ...,
             -2.43460941e+00, -1.38742077e+00, -6.76846266e-01]],

           [[ 5.52824306e+00,  4.80328941e+00,  5.48182011e+00, ...,
              9.64371300e+00,  8.45391464e+00,  6.73904371e+00],
            [ 1.41116505e+01,  1.10021439e+01,  8.49975586e+00, ...,
              2.43390102e+01,  2.40545197e+01,  2.37508526e+01],
            [ 7.49130726e+00,  5.03081226e+00,  3.02424669e+00, ...,
              1.14002705e+01,  1.30305347e+01,  1.44888067e+01],
    ...
              2.60482717e+00, -3.25640410e-01, -2.73880315e+00],
            [-2.06200093e-01, -1.50703683e-01, -7.46561959e-02, ...,
              7.83822238e-01,  4.06080961e-01, -9.14880782e-02],
            [ 7.46902823e-01,  5.13037205e-01,  2.82073766e-01, ...,
             -4.60449129e-01, -9.76375267e-02,  4.52063292e-01]],

           [[ 2.15148754e+01,  1.70668049e+01,  1.52735891e+01, ...,
              1.75658283e+01,  2.09505959e+01,  2.35891457e+01],
            [ 6.36505547e+01,  5.47557869e+01,  4.86169128e+01, ...,
              2.72354355e+01,  2.50436401e+01,  2.30469360e+01],
            [ 2.34823036e+01,  3.92265930e+01,  5.84213028e+01, ...,
              5.35875397e+01,  5.14053383e+01,  4.79362526e+01],
            ...,
            [-1.51650405e+00, -2.82144427e+00, -3.56999779e+00, ...,
             -2.94275665e+00, -2.51753509e-01,  1.61856890e+00],
            [ 1.73773921e+00,  8.54089379e-01,  1.71714023e-01, ...,
             -8.82047117e-01,  3.62093300e-02,  1.08484733e+00],
            [ 5.29922903e-01,  3.15487474e-01, -7.18056619e-01, ...,
              1.30907345e+00,  1.72897562e-01, -1.05103433e+00]]],
          shape=(30, 30, 60), dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>fy</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.1822 -0.1877 ... -0.5843 -0.8524</div><input id='attrs-f11622ef-4426-4e21-883b-f01ce561d629' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-f11622ef-4426-4e21-883b-f01ce561d629' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7fc8eb80-cad0-43bf-a5a7-3bc0c1aef22d' class='xr-var-data-in' type='checkbox'><label for='data-7fc8eb80-cad0-43bf-a5a7-3bc0c1aef22d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Meridional component of TN wave activity horizontal flux</dd><dt><span>units :</span></dt><dd>m^2/s^2</dd><dt><span>description :</span></dt><dd>Northward component of Takaya and Nakamura wave activity flux</dd><dt><span>standard_name :</span></dt><dd>tn_wave_activity_flux_y</dd></dl></div><div class='xr-var-data'><pre>array([[[ 1.8221290e-01, -1.8768871e-01, -6.3536847e-01, ...,
              1.0141762e+00,  9.6450192e-01,  8.6341643e-01],
            [ 1.6474770e+00,  1.3239098e+00,  9.0232193e-01, ...,
              3.9373696e+00,  3.3565376e+00,  2.7847080e+00],
            [ 1.0619928e+01,  7.5191031e+00,  4.1040978e+00, ...,
              6.2588925e+00,  9.5206289e+00,  1.2568030e+01],
            ...,
            [-2.5354018e+00,  9.0483451e-01,  2.0314395e+00, ...,
             -8.1054592e+00, -5.4285364e+00, -4.8193746e+00],
            [ 5.3247893e-01,  2.8333274e-01,  6.7991808e-02, ...,
              3.8257405e-02,  5.4172939e-01,  7.1292311e-01],
            [-6.4179540e-02, -9.8514490e-02, -9.9620827e-02, ...,
             -6.0295546e-01, -2.2945644e-01, -1.3405739e-01]],

           [[ 5.0128613e+00,  4.3577509e+00,  3.8217480e+00, ...,
              9.7906837e+00,  9.0609636e+00,  8.2815790e+00],
            [ 2.4247816e+00,  1.4888042e+00,  5.9999567e-01, ...,
              6.3351789e+00,  5.6849852e+00,  5.4253221e+00],
            [-1.2988707e+00, -1.9029050e+00, -2.4306085e+00, ...,
             -7.7121222e-01, -6.6040754e-01, -1.0448523e+00],
    ...
             -1.6260296e+00, -1.7068450e-01, -8.7263376e-01],
            [-9.0307556e-03, -2.3307088e-01, -4.0392077e-01, ...,
             -6.6323406e-01, -4.1243684e-01, -2.1477377e-01],
            [ 1.6709417e-01, -2.3331353e-01, -4.5527250e-01, ...,
             -1.3828439e-01,  1.1480018e-01,  2.9989499e-01]],

           [[ 1.8850193e+01,  7.6479974e+00, -3.4962472e-01, ...,
              1.1491205e+01,  1.4578290e+01,  2.0229548e+01],
            [ 1.6331430e+01,  1.3486111e+01,  6.6320682e+00, ...,
              2.4392479e+01,  2.0231695e+01,  1.4859035e+01],
            [ 7.4478893e+00,  7.0025659e+00,  4.7311535e+00, ...,
              2.4449301e+01,  1.7889462e+01,  9.2009115e+00],
            ...,
            [ 3.2698044e-01, -8.8212684e-02, -7.7439237e-01, ...,
             -4.0914106e+00, -3.5126462e+00, -9.6738642e-01],
            [-6.3827455e-01, -4.5082714e-02,  1.5402234e-01, ...,
             -6.7179650e-01, -1.6468289e+00, -1.9469898e+00],
            [ 1.3229319e-01, -2.8435862e-01, -6.2293178e-01, ...,
              2.9360330e-01, -5.8428031e-01, -8.5235351e-01]]],
          shape=(30, 30, 60), dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-e4894ff3-1fc0-442f-9acf-b21634b15da2' class='xr-section-summary-in' type='checkbox' checked /><label for='section-e4894ff3-1fc0-442f-9acf-b21634b15da2' class='xr-section-summary' title='Expand/collapse section'>Attributes: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>title :</span></dt><dd>Takaya and Nakamura Wave Activity Flux</dd><dt><span>description :</span></dt><dd>Horizontal components of quasi-geostrophic wave activity flux following Takaya and Nakamura (2001)</dd><dt><span>reference :</span></dt><dd>Takaya, K. and H. Nakamura, 2001: A Formulation of a Phase-Independent Wave-Activity Flux for Stationary and Migratory Quasigeostrophic Eddies on a Zonally Varying Basic Flow. J. Atmos. Sci., 58, 608-627.</dd><dt><span>created_with :</span></dt><dd>easyclimate: calc_TN_wave_activity_horizontal_flux function</dd></dl></div></li></ul></div></div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 40-43

.. code-block:: Python

    tn01_mean_result1 = tn01_result1.mean(dim = "time").sortby("lat")
    tn01_mean_result1






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
    <defs>
    <symbol id="icon-database" viewBox="0 0 32 32">
    <path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
    <path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    <path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    </symbol>
    <symbol id="icon-file-text2" viewBox="0 0 32 32">
    <path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
    <path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    </symbol>
    </defs>
    </svg>
    <style>/* CSS stylesheet for displaying xarray objects in notebooks */

    :root {
      --xr-font-color0: var(
        --jp-content-font-color0,
        var(--pst-color-text-base rgba(0, 0, 0, 1))
      );
      --xr-font-color2: var(
        --jp-content-font-color2,
        var(--pst-color-text-base, rgba(0, 0, 0, 0.54))
      );
      --xr-font-color3: var(
        --jp-content-font-color3,
        var(--pst-color-text-base, rgba(0, 0, 0, 0.38))
      );
      --xr-border-color: var(
        --jp-border-color2,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 10))
      );
      --xr-disabled-color: var(
        --jp-layout-color3,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 40))
      );
      --xr-background-color: var(
        --jp-layout-color0,
        var(--pst-color-on-background, white)
      );
      --xr-background-color-row-even: var(
        --jp-layout-color1,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 5))
      );
      --xr-background-color-row-odd: var(
        --jp-layout-color2,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 15))
      );
    }

    html[theme="dark"],
    html[data-theme="dark"],
    body[data-theme="dark"],
    body.vscode-dark {
      --xr-font-color0: var(
        --jp-content-font-color0,
        var(--pst-color-text-base, rgba(255, 255, 255, 1))
      );
      --xr-font-color2: var(
        --jp-content-font-color2,
        var(--pst-color-text-base, rgba(255, 255, 255, 0.54))
      );
      --xr-font-color3: var(
        --jp-content-font-color3,
        var(--pst-color-text-base, rgba(255, 255, 255, 0.38))
      );
      --xr-border-color: var(
        --jp-border-color2,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))
      );
      --xr-disabled-color: var(
        --jp-layout-color3,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))
      );
      --xr-background-color: var(
        --jp-layout-color0,
        var(--pst-color-on-background, #111111)
      );
      --xr-background-color-row-even: var(
        --jp-layout-color1,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))
      );
      --xr-background-color-row-odd: var(
        --jp-layout-color2,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))
      );
    }

    .xr-wrap {
      display: block !important;
      min-width: 300px;
      max-width: 700px;
      line-height: 1.6;
      padding-bottom: 4px;
    }

    .xr-text-repr-fallback {
      /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
      display: none;
    }

    .xr-header {
      padding-top: 6px;
      padding-bottom: 6px;
    }

    .xr-header {
      border-bottom: solid 1px var(--xr-border-color);
      margin-bottom: 4px;
    }

    .xr-header > div,
    .xr-header > ul {
      display: inline;
      margin-top: 0;
      margin-bottom: 0;
    }

    .xr-obj-type,
    .xr-obj-name {
      margin-left: 2px;
      margin-right: 10px;
    }

    .xr-obj-type,
    .xr-group-box-contents > label {
      color: var(--xr-font-color2);
      display: block;
    }

    .xr-sections {
      padding-left: 0 !important;
      display: grid;
      grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
      margin-block-start: 0;
      margin-block-end: 0;
    }

    .xr-section-item {
      display: contents;
    }

    .xr-section-item > input,
    .xr-group-box-contents > input,
    .xr-array-wrap > input {
      display: block;
      opacity: 0;
      height: 0;
      margin: 0;
    }

    .xr-section-item > input + label,
    .xr-var-item > input + label {
      color: var(--xr-disabled-color);
    }

    .xr-section-item > input:enabled + label,
    .xr-var-item > input:enabled + label,
    .xr-array-wrap > input:enabled + label,
    .xr-group-box-contents > input:enabled + label {
      cursor: pointer;
      color: var(--xr-font-color2);
    }

    .xr-section-item > input:focus-visible + label,
    .xr-var-item > input:focus-visible + label,
    .xr-array-wrap > input:focus-visible + label,
    .xr-group-box-contents > input:focus-visible + label {
      outline: auto;
    }

    .xr-section-item > input:enabled + label:hover,
    .xr-var-item > input:enabled + label:hover,
    .xr-array-wrap > input:enabled + label:hover,
    .xr-group-box-contents > input:enabled + label:hover {
      color: var(--xr-font-color0);
    }

    .xr-section-summary {
      grid-column: 1;
      color: var(--xr-font-color2);
      font-weight: 500;
      white-space: nowrap;
    }

    .xr-section-summary > em {
      font-weight: normal;
    }

    .xr-span-grid {
      grid-column-end: -1;
    }

    .xr-section-summary > span {
      display: inline-block;
      padding-left: 0.3em;
    }

    .xr-group-box-contents > input:checked + label > span {
      display: inline-block;
      padding-left: 0.6em;
    }

    .xr-section-summary-in:disabled + label {
      color: var(--xr-font-color2);
    }

    .xr-section-summary-in + label:before {
      display: inline-block;
      content: "‚ñ∫";
      font-size: 11px;
      width: 15px;
      text-align: center;
    }

    .xr-section-summary-in:disabled + label:before {
      color: var(--xr-disabled-color);
    }

    .xr-section-summary-in:checked + label:before {
      content: "‚ñº";
    }

    .xr-section-summary-in:checked + label > span {
      display: none;
    }

    .xr-section-summary,
    .xr-section-inline-details,
    .xr-group-box-contents > label {
      padding-top: 4px;
    }

    .xr-section-inline-details {
      grid-column: 2 / -1;
    }

    .xr-section-details {
      grid-column: 1 / -1;
      margin-top: 4px;
      margin-bottom: 5px;
    }

    .xr-section-summary-in ~ .xr-section-details {
      display: none;
    }

    .xr-section-summary-in:checked ~ .xr-section-details {
      display: contents;
    }

    .xr-children {
      display: inline-grid;
      grid-template-columns: 100%;
      grid-column: 1 / -1;
      padding-top: 4px;
    }

    .xr-group-box {
      display: inline-grid;
      grid-template-columns: 0px 30px auto;
    }

    .xr-group-box-vline {
      grid-column-start: 1;
      border-right: 0.2em solid;
      border-color: var(--xr-border-color);
      width: 0px;
    }

    .xr-group-box-hline {
      grid-column-start: 2;
      grid-row-start: 1;
      height: 1em;
      width: 26px;
      border-bottom: 0.2em solid;
      border-color: var(--xr-border-color);
    }

    .xr-group-box-contents {
      grid-column-start: 3;
      padding-bottom: 4px;
    }

    .xr-group-box-contents > label::before {
      content: "üìÇ";
      padding-right: 0.3em;
    }

    .xr-group-box-contents > input:checked + label::before {
      content: "üìÅ";
    }

    .xr-group-box-contents > input:checked + label {
      padding-bottom: 0px;
    }

    .xr-group-box-contents > input:checked ~ .xr-sections {
      display: none;
    }

    .xr-group-box-contents > input + label > span {
      display: none;
    }

    .xr-group-box-ellipsis {
      font-size: 1.4em;
      font-weight: 900;
      color: var(--xr-font-color2);
      letter-spacing: 0.15em;
      cursor: default;
    }

    .xr-array-wrap {
      grid-column: 1 / -1;
      display: grid;
      grid-template-columns: 20px auto;
    }

    .xr-array-wrap > label {
      grid-column: 1;
      vertical-align: top;
    }

    .xr-preview {
      color: var(--xr-font-color3);
    }

    .xr-array-preview,
    .xr-array-data {
      padding: 0 5px !important;
      grid-column: 2;
    }

    .xr-array-data,
    .xr-array-in:checked ~ .xr-array-preview {
      display: none;
    }

    .xr-array-in:checked ~ .xr-array-data,
    .xr-array-preview {
      display: inline-block;
    }

    .xr-dim-list {
      display: inline-block !important;
      list-style: none;
      padding: 0 !important;
      margin: 0;
    }

    .xr-dim-list li {
      display: inline-block;
      padding: 0;
      margin: 0;
    }

    .xr-dim-list:before {
      content: "(";
    }

    .xr-dim-list:after {
      content: ")";
    }

    .xr-dim-list li:not(:last-child):after {
      content: ",";
      padding-right: 5px;
    }

    .xr-has-index {
      font-weight: bold;
    }

    .xr-var-list,
    .xr-var-item {
      display: contents;
    }

    .xr-var-item > div,
    .xr-var-item label,
    .xr-var-item > .xr-var-name span {
      background-color: var(--xr-background-color-row-even);
      border-color: var(--xr-background-color-row-odd);
      margin-bottom: 0;
      padding-top: 2px;
    }

    .xr-var-item > .xr-var-name:hover span {
      padding-right: 5px;
    }

    .xr-var-list > li:nth-child(odd) > div,
    .xr-var-list > li:nth-child(odd) > label,
    .xr-var-list > li:nth-child(odd) > .xr-var-name span {
      background-color: var(--xr-background-color-row-odd);
      border-color: var(--xr-background-color-row-even);
    }

    .xr-var-name {
      grid-column: 1;
    }

    .xr-var-dims {
      grid-column: 2;
    }

    .xr-var-dtype {
      grid-column: 3;
      text-align: right;
      color: var(--xr-font-color2);
    }

    .xr-var-preview {
      grid-column: 4;
    }

    .xr-index-preview {
      grid-column: 2 / 5;
      color: var(--xr-font-color2);
    }

    .xr-var-name,
    .xr-var-dims,
    .xr-var-dtype,
    .xr-preview,
    .xr-attrs dt {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      padding-right: 10px;
    }

    .xr-var-name:hover,
    .xr-var-dims:hover,
    .xr-var-dtype:hover,
    .xr-attrs dt:hover {
      overflow: visible;
      width: auto;
      z-index: 1;
    }

    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      display: none;
      border-top: 2px dotted var(--xr-background-color);
      padding-bottom: 20px !important;
      padding-top: 10px !important;
    }

    .xr-var-attrs-in + label,
    .xr-var-data-in + label,
    .xr-index-data-in + label {
      padding: 0 1px;
    }

    .xr-var-attrs-in:checked ~ .xr-var-attrs,
    .xr-var-data-in:checked ~ .xr-var-data,
    .xr-index-data-in:checked ~ .xr-index-data {
      display: block;
    }

    .xr-var-data > table {
      float: right;
    }

    .xr-var-data > pre,
    .xr-index-data > pre,
    .xr-var-data > table > tbody > tr {
      background-color: transparent !important;
    }

    .xr-var-name span,
    .xr-var-data,
    .xr-index-name div,
    .xr-index-data,
    .xr-attrs {
      padding-left: 25px !important;
    }

    .xr-attrs,
    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      grid-column: 1 / -1;
    }

    dl.xr-attrs {
      padding: 0;
      margin: 0;
      display: grid;
      grid-template-columns: 125px auto;
    }

    .xr-attrs dt,
    .xr-attrs dd {
      padding: 0;
      margin: 0;
      float: left;
      padding-right: 10px;
      width: auto;
    }

    .xr-attrs dt {
      font-weight: normal;
      grid-column: 1;
    }

    .xr-attrs dt:hover span {
      display: inline-block;
      background: var(--xr-background-color);
      padding-right: 10px;
    }

    .xr-attrs dd {
      grid-column: 2;
      white-space: pre-wrap;
      word-break: break-all;
    }

    .xr-icon-database,
    .xr-icon-file-text2,
    .xr-no-icon {
      display: inline-block;
      vertical-align: middle;
      width: 1em;
      height: 1.5em !important;
      stroke-width: 0;
      stroke: currentColor;
      fill: currentColor;
    }

    .xr-var-attrs-in:checked + label > .xr-icon-file-text2,
    .xr-var-data-in:checked + label > .xr-icon-database,
    .xr-index-data-in:checked + label > .xr-icon-database {
      color: var(--xr-font-color0);
      filter: drop-shadow(1px 1px 5px var(--xr-font-color2));
      stroke-width: 0.8px;
    }
    </style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 22kB
    Dimensions:  (lat: 30, lon: 60)
    Coordinates:
      * lat      (lat) float64 240B -85.48 -79.63 -73.74 ... 73.74 79.63 85.48
      * lon      (lon) float64 480B 0.0 6.0 12.0 18.0 ... 336.0 342.0 348.0 354.0
        level    int32 4B 500
    Data variables:
        psi_p    (lat, lon) float32 7kB 1.838e+06 1.889e+06 ... -1.599e+06
        fx       (lat, lon) float32 7kB 0.276 0.4461 0.4728 ... 2.661 2.836 2.983
        fy       (lat, lon) float32 7kB -0.3099 -0.3664 -0.4537 ... 3.762 3.713
    Attributes:
        title:         Takaya and Nakamura Wave Activity Flux
        description:   Horizontal components of quasi-geostrophic wave activity f...
        reference:     Takaya, K. and H. Nakamura, 2001: A Formulation of a Phase...
        created_with:  easyclimate: calc_TN_wave_activity_horizontal_flux function</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-948c52e9-8575-4c13-8804-fa4a8c883be9' class='xr-section-summary-in' type='checkbox' disabled /><label for='section-948c52e9-8575-4c13-8804-fa4a8c883be9' class='xr-section-summary'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>lat</span>: 30</li><li><span class='xr-has-index'>lon</span>: 60</li></ul></div></li><li class='xr-section-item'><input id='section-f6aac63b-d4c1-4c20-9f8c-ae6c3bb3b8fb' class='xr-section-summary-in' type='checkbox' checked /><label for='section-f6aac63b-d4c1-4c20-9f8c-ae6c3bb3b8fb' class='xr-section-summary' title='Expand/collapse section'>Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-85.48 -79.63 ... 79.63 85.48</div><input id='attrs-2c5cf732-0ac7-462c-b817-cffb1116b74e' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-2c5cf732-0ac7-462c-b817-cffb1116b74e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-eb74ebbd-78c7-4ddc-bfb5-5fca448bbd41' class='xr-var-data-in' type='checkbox'><label for='data-eb74ebbd-78c7-4ddc-bfb5-5fca448bbd41' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>long_name :</span></dt><dd>latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>axis :</span></dt><dd>Y</dd></dl></div><div class='xr-var-data'><pre>array([-85.482617, -79.630722, -73.74427 , -67.850013, -61.952799, -56.054157,
           -50.154722, -44.254802, -38.354569, -32.454124, -26.553532, -20.652838,
           -14.752072,  -8.851261,  -2.950423,   2.950423,   8.851261,  14.752072,
            20.652838,  26.553532,  32.454124,  38.354569,  44.254802,  50.154722,
            56.054157,  61.952799,  67.850013,  73.74427 ,  79.630722,  85.482617])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 6.0 12.0 ... 342.0 348.0 354.0</div><input id='attrs-d47a5eda-73ee-48da-a040-6acdeb67df87' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-d47a5eda-73ee-48da-a040-6acdeb67df87' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6811acd6-e08a-4294-8d35-5050d2c4756a' class='xr-var-data-in' type='checkbox'><label for='data-6811acd6-e08a-4294-8d35-5050d2c4756a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>long_name :</span></dt><dd>longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>axis :</span></dt><dd>X</dd></dl></div><div class='xr-var-data'><pre>array([  0.,   6.,  12.,  18.,  24.,  30.,  36.,  42.,  48.,  54.,  60.,  66.,
            72.,  78.,  84.,  90.,  96., 102., 108., 114., 120., 126., 132., 138.,
           144., 150., 156., 162., 168., 174., 180., 186., 192., 198., 204., 210.,
           216., 222., 228., 234., 240., 246., 252., 258., 264., 270., 276., 282.,
           288., 294., 300., 306., 312., 318., 324., 330., 336., 342., 348., 354.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>level</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>500</div><input id='attrs-5fd528ed-2d91-46cc-b8fb-ea5aa1fa3850' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-5fd528ed-2d91-46cc-b8fb-ea5aa1fa3850' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8a095544-18f8-4e6f-83af-764bbb7b1b60' class='xr-var-data-in' type='checkbox'><label for='data-8a095544-18f8-4e6f-83af-764bbb7b1b60' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>air_pressure</dd><dt><span>long_name :</span></dt><dd>pressure_level</dd><dt><span>units :</span></dt><dd>millibars</dd><dt><span>positive :</span></dt><dd>down</dd><dt><span>axis :</span></dt><dd>Z</dd></dl></div><div class='xr-var-data'><pre>array(500, dtype=int32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-ceb62601-16eb-4e3a-9998-cbe2e3720b6e' class='xr-section-summary-in' type='checkbox' checked /><label for='section-ceb62601-16eb-4e3a-9998-cbe2e3720b6e' class='xr-section-summary' title='Expand/collapse section'>Data variables: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>psi_p</span></div><div class='xr-var-dims'>(lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>1.838e+06 1.889e+06 ... -1.599e+06</div><input id='attrs-e6b2ce93-ed17-4589-8f0a-af9efb76126a' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-e6b2ce93-ed17-4589-8f0a-af9efb76126a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-dc485870-9ac7-4288-baaa-2c941a293754' class='xr-var-data-in' type='checkbox'><label for='data-dc485870-9ac7-4288-baaa-2c941a293754' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Perturbation stream function</dd><dt><span>units :</span></dt><dd>m^2/s</dd><dt><span>description :</span></dt><dd>Geostrophic stream function perturbation calculated from geopotential height anomaly</dd></dl></div><div class='xr-var-data'><pre>array([[ 1.8378438e+06,  1.8886032e+06,  1.9416669e+06, ...,
             1.7816236e+06,  1.7871080e+06,  1.8024528e+06],
           [ 2.0428242e+06,  2.1331220e+06,  2.1836642e+06, ...,
             1.5633760e+06,  1.6760124e+06,  1.8625114e+06],
           [ 2.7391785e+06,  2.4909028e+06,  2.2601772e+06, ...,
             3.6041028e+06,  3.3403688e+06,  3.0466030e+06],
           ...,
           [ 7.7261920e+06,  7.7175270e+06,  7.4509370e+06, ...,
             5.8388135e+06,  6.7674505e+06,  7.4168450e+06],
           [ 2.8369915e+06,  2.5702968e+06,  2.0957614e+06, ...,
             2.6651400e+06,  2.8896950e+06,  2.9495275e+06],
           [-1.7226360e+06, -1.8661872e+06, -2.0294115e+06, ...,
            -1.4141409e+06, -1.4964376e+06, -1.5992725e+06]],
          shape=(30, 60), dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>fx</span></div><div class='xr-var-dims'>(lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.276 0.4461 0.4728 ... 2.836 2.983</div><input id='attrs-349c4e0e-7299-4641-8ed2-1e5623725ab4' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-349c4e0e-7299-4641-8ed2-1e5623725ab4' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-af566705-75a2-45c6-aa7e-38aaba214806' class='xr-var-data-in' type='checkbox'><label for='data-af566705-75a2-45c6-aa7e-38aaba214806' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Zonal component of TN wave activity horizontal flux</dd><dt><span>units :</span></dt><dd>m^2/s^2</dd><dt><span>description :</span></dt><dd>Eastward component of Takaya and Nakamura wave activity flux</dd><dt><span>standard_name :</span></dt><dd>tn_wave_activity_flux_x</dd></dl></div><div class='xr-var-data'><pre>array([[ 0.27600047,  0.4461126 ,  0.4728448 , ..., -0.13008517,
             0.2573934 ,  0.5911897 ],
           [ 0.91982156,  0.9112154 ,  1.0118266 , ...,  1.0080101 ,
             1.0351684 ,  1.0226277 ],
           [-1.688142  , -1.6120335 , -1.4426038 , ...,  0.02180516,
            -1.5774338 , -2.3383882 ],
           ...,
           [16.675611  , 15.994587  , 16.356846  , ..., 15.797687  ,
            16.702427  , 18.630041  ],
           [12.752863  , 11.620794  , 11.117591  , ...,  9.355316  ,
             8.806135  ,  8.352842  ],
           [ 4.4109545 ,  4.4977336 ,  4.5782576 , ...,  2.661397  ,
             2.8364904 ,  2.9825842 ]], shape=(30, 60), dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>fy</span></div><div class='xr-var-dims'>(lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-0.3099 -0.3664 ... 3.762 3.713</div><input id='attrs-a57f2c69-390c-4750-b91d-591107231330' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-a57f2c69-390c-4750-b91d-591107231330' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5d9e3855-c9c2-4889-95b2-834c44bfd61e' class='xr-var-data-in' type='checkbox'><label for='data-5d9e3855-c9c2-4889-95b2-834c44bfd61e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Meridional component of TN wave activity horizontal flux</dd><dt><span>units :</span></dt><dd>m^2/s^2</dd><dt><span>description :</span></dt><dd>Northward component of Takaya and Nakamura wave activity flux</dd><dt><span>standard_name :</span></dt><dd>tn_wave_activity_flux_y</dd></dl></div><div class='xr-var-data'><pre>array([[-0.3099176 , -0.36636227, -0.45367628, ..., -0.38670936,
            -0.21486618, -0.17004602],
           [-0.7642377 , -0.81636876, -0.8895228 , ..., -0.81999874,
            -0.71175456, -0.67053443],
           [-1.5340787 , -0.98716235, -0.4630325 , ..., -3.7072883 ,
            -2.8552306 , -2.4822497 ],
           ...,
           [ 3.1805868 ,  3.52934   ,  3.3834763 , ...,  5.2140856 ,
             4.3530354 ,  3.6976593 ],
           [ 2.9111664 ,  2.8330195 ,  2.1292312 , ...,  3.8022501 ,
             3.5630522 ,  3.2651072 ],
           [ 3.8376603 ,  3.6442008 ,  3.4250374 , ...,  3.8044498 ,
             3.7616599 ,  3.7129815 ]], shape=(30, 60), dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-286c7432-3ef5-460c-9e19-1a7c34166110' class='xr-section-summary-in' type='checkbox' checked /><label for='section-286c7432-3ef5-460c-9e19-1a7c34166110' class='xr-section-summary' title='Expand/collapse section'>Attributes: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>title :</span></dt><dd>Takaya and Nakamura Wave Activity Flux</dd><dt><span>description :</span></dt><dd>Horizontal components of quasi-geostrophic wave activity flux following Takaya and Nakamura (2001)</dd><dt><span>reference :</span></dt><dd>Takaya, K. and H. Nakamura, 2001: A Formulation of a Phase-Independent Wave-Activity Flux for Stationary and Migratory Quasigeostrophic Eddies on a Zonally Varying Basic Flow. J. Atmos. Sci., 58, 608-627.</dd><dt><span>created_with :</span></dt><dd>easyclimate: calc_TN_wave_activity_horizontal_flux function</dd></dl></div></li></ul></div></div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 44-48

.. code-block:: Python

    draw_shaded1 = tn01_mean_result1["psi_p"]
    draw_shaded1 = ecl.plot.add_lon_cyclic(draw_shaded1, 6)
    draw_quiver1 = tn01_mean_result1[["fx", "fy"]]








.. GENERATED FROM PYTHON SOURCE LINES 49-99

.. code-block:: Python

    fig, ax = plt.subplots(
        figsize = (6, 6),
        subplot_kw={"projection": ccrs.NorthPolarStereo(central_longitude=140)}
    )

    ax.coastlines(edgecolor="black", linewidths=0.5)
    ecl.plot.draw_Circlemap_PolarStereo(
        ax=ax,
        lon_step=30,
        lat_step=30,
        lat_range=[10, 90],
        draw_labels=True,
        gridlines_kwargs={"color": "grey", "alpha": 0.5, "linestyle": "--"},
    )

    fg1 = draw_shaded1.plot.contourf(
        ax = ax,
        levels = np.linspace(-1.5e7, 1.5e7, 21),
        cbar_kwargs = {'location': 'bottom', 'aspect': 40, 'format': formatter},
        transform=ccrs.PlateCarree(),
        zorder = 1
    )

    q = draw_quiver1.sel(lat = slice(10, None)).plot.quiver(
        ax = ax,
        x = "lon", y = "lat", u = "fx", v = "fy",
        transform = ccrs.PlateCarree(),
        scale = 600,
        regrid_shape = 18,
        headwidth = 5,
        width = 0.0045,
        headlength = 8,
        headaxislength = 8,
        minlength = 3,
        add_guide = False,
        zorder = 2,
    )
    qk = ax.quiverkey(
        q, 0, -0.1,
        50, "50", labelpos = "N",
        color = "k",
        coordinates = "axes",
        fontproperties = {"size": 12},
        labelsep = 0.05,
        transform = ccrs.PlateCarree(),
    )
    qk.set_zorder(3)

    ax.set_title("TN01 WAF Analysis (500hPa, Nov. 2014)")




.. image-sg:: /auto_gallery/eddy/images/sphx_glr_plot_waf_001.png
   :alt: TN01 WAF Analysis (500hPa, Nov. 2014)
   :srcset: /auto_gallery/eddy/images/sphx_glr_plot_waf_001.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    Text(0.5, 1.133850874991003, 'TN01 WAF Analysis (500hPa, Nov. 2014)')



.. GENERATED FROM PYTHON SOURCE LINES 100-110

.. code-block:: Python

    tn01_result2 = ecl.calc_TN_wave_activity_horizontal_flux(
        z_prime_data = z500_prime_data2,
        u_climatology_data = u500_climatology_data,
        v_climatology_data = v500_climatology_data,
        vertical_dim = "level",
        vertical_dim_units = "hPa",
    )
    tn01_mean_result2 = tn01_result2.mean(dim = "time").sortby("lat")
    tn01_mean_result2






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
    <defs>
    <symbol id="icon-database" viewBox="0 0 32 32">
    <path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
    <path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    <path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    </symbol>
    <symbol id="icon-file-text2" viewBox="0 0 32 32">
    <path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
    <path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    </symbol>
    </defs>
    </svg>
    <style>/* CSS stylesheet for displaying xarray objects in notebooks */

    :root {
      --xr-font-color0: var(
        --jp-content-font-color0,
        var(--pst-color-text-base rgba(0, 0, 0, 1))
      );
      --xr-font-color2: var(
        --jp-content-font-color2,
        var(--pst-color-text-base, rgba(0, 0, 0, 0.54))
      );
      --xr-font-color3: var(
        --jp-content-font-color3,
        var(--pst-color-text-base, rgba(0, 0, 0, 0.38))
      );
      --xr-border-color: var(
        --jp-border-color2,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 10))
      );
      --xr-disabled-color: var(
        --jp-layout-color3,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 40))
      );
      --xr-background-color: var(
        --jp-layout-color0,
        var(--pst-color-on-background, white)
      );
      --xr-background-color-row-even: var(
        --jp-layout-color1,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 5))
      );
      --xr-background-color-row-odd: var(
        --jp-layout-color2,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 15))
      );
    }

    html[theme="dark"],
    html[data-theme="dark"],
    body[data-theme="dark"],
    body.vscode-dark {
      --xr-font-color0: var(
        --jp-content-font-color0,
        var(--pst-color-text-base, rgba(255, 255, 255, 1))
      );
      --xr-font-color2: var(
        --jp-content-font-color2,
        var(--pst-color-text-base, rgba(255, 255, 255, 0.54))
      );
      --xr-font-color3: var(
        --jp-content-font-color3,
        var(--pst-color-text-base, rgba(255, 255, 255, 0.38))
      );
      --xr-border-color: var(
        --jp-border-color2,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))
      );
      --xr-disabled-color: var(
        --jp-layout-color3,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))
      );
      --xr-background-color: var(
        --jp-layout-color0,
        var(--pst-color-on-background, #111111)
      );
      --xr-background-color-row-even: var(
        --jp-layout-color1,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))
      );
      --xr-background-color-row-odd: var(
        --jp-layout-color2,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))
      );
    }

    .xr-wrap {
      display: block !important;
      min-width: 300px;
      max-width: 700px;
      line-height: 1.6;
      padding-bottom: 4px;
    }

    .xr-text-repr-fallback {
      /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
      display: none;
    }

    .xr-header {
      padding-top: 6px;
      padding-bottom: 6px;
    }

    .xr-header {
      border-bottom: solid 1px var(--xr-border-color);
      margin-bottom: 4px;
    }

    .xr-header > div,
    .xr-header > ul {
      display: inline;
      margin-top: 0;
      margin-bottom: 0;
    }

    .xr-obj-type,
    .xr-obj-name {
      margin-left: 2px;
      margin-right: 10px;
    }

    .xr-obj-type,
    .xr-group-box-contents > label {
      color: var(--xr-font-color2);
      display: block;
    }

    .xr-sections {
      padding-left: 0 !important;
      display: grid;
      grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
      margin-block-start: 0;
      margin-block-end: 0;
    }

    .xr-section-item {
      display: contents;
    }

    .xr-section-item > input,
    .xr-group-box-contents > input,
    .xr-array-wrap > input {
      display: block;
      opacity: 0;
      height: 0;
      margin: 0;
    }

    .xr-section-item > input + label,
    .xr-var-item > input + label {
      color: var(--xr-disabled-color);
    }

    .xr-section-item > input:enabled + label,
    .xr-var-item > input:enabled + label,
    .xr-array-wrap > input:enabled + label,
    .xr-group-box-contents > input:enabled + label {
      cursor: pointer;
      color: var(--xr-font-color2);
    }

    .xr-section-item > input:focus-visible + label,
    .xr-var-item > input:focus-visible + label,
    .xr-array-wrap > input:focus-visible + label,
    .xr-group-box-contents > input:focus-visible + label {
      outline: auto;
    }

    .xr-section-item > input:enabled + label:hover,
    .xr-var-item > input:enabled + label:hover,
    .xr-array-wrap > input:enabled + label:hover,
    .xr-group-box-contents > input:enabled + label:hover {
      color: var(--xr-font-color0);
    }

    .xr-section-summary {
      grid-column: 1;
      color: var(--xr-font-color2);
      font-weight: 500;
      white-space: nowrap;
    }

    .xr-section-summary > em {
      font-weight: normal;
    }

    .xr-span-grid {
      grid-column-end: -1;
    }

    .xr-section-summary > span {
      display: inline-block;
      padding-left: 0.3em;
    }

    .xr-group-box-contents > input:checked + label > span {
      display: inline-block;
      padding-left: 0.6em;
    }

    .xr-section-summary-in:disabled + label {
      color: var(--xr-font-color2);
    }

    .xr-section-summary-in + label:before {
      display: inline-block;
      content: "‚ñ∫";
      font-size: 11px;
      width: 15px;
      text-align: center;
    }

    .xr-section-summary-in:disabled + label:before {
      color: var(--xr-disabled-color);
    }

    .xr-section-summary-in:checked + label:before {
      content: "‚ñº";
    }

    .xr-section-summary-in:checked + label > span {
      display: none;
    }

    .xr-section-summary,
    .xr-section-inline-details,
    .xr-group-box-contents > label {
      padding-top: 4px;
    }

    .xr-section-inline-details {
      grid-column: 2 / -1;
    }

    .xr-section-details {
      grid-column: 1 / -1;
      margin-top: 4px;
      margin-bottom: 5px;
    }

    .xr-section-summary-in ~ .xr-section-details {
      display: none;
    }

    .xr-section-summary-in:checked ~ .xr-section-details {
      display: contents;
    }

    .xr-children {
      display: inline-grid;
      grid-template-columns: 100%;
      grid-column: 1 / -1;
      padding-top: 4px;
    }

    .xr-group-box {
      display: inline-grid;
      grid-template-columns: 0px 30px auto;
    }

    .xr-group-box-vline {
      grid-column-start: 1;
      border-right: 0.2em solid;
      border-color: var(--xr-border-color);
      width: 0px;
    }

    .xr-group-box-hline {
      grid-column-start: 2;
      grid-row-start: 1;
      height: 1em;
      width: 26px;
      border-bottom: 0.2em solid;
      border-color: var(--xr-border-color);
    }

    .xr-group-box-contents {
      grid-column-start: 3;
      padding-bottom: 4px;
    }

    .xr-group-box-contents > label::before {
      content: "üìÇ";
      padding-right: 0.3em;
    }

    .xr-group-box-contents > input:checked + label::before {
      content: "üìÅ";
    }

    .xr-group-box-contents > input:checked + label {
      padding-bottom: 0px;
    }

    .xr-group-box-contents > input:checked ~ .xr-sections {
      display: none;
    }

    .xr-group-box-contents > input + label > span {
      display: none;
    }

    .xr-group-box-ellipsis {
      font-size: 1.4em;
      font-weight: 900;
      color: var(--xr-font-color2);
      letter-spacing: 0.15em;
      cursor: default;
    }

    .xr-array-wrap {
      grid-column: 1 / -1;
      display: grid;
      grid-template-columns: 20px auto;
    }

    .xr-array-wrap > label {
      grid-column: 1;
      vertical-align: top;
    }

    .xr-preview {
      color: var(--xr-font-color3);
    }

    .xr-array-preview,
    .xr-array-data {
      padding: 0 5px !important;
      grid-column: 2;
    }

    .xr-array-data,
    .xr-array-in:checked ~ .xr-array-preview {
      display: none;
    }

    .xr-array-in:checked ~ .xr-array-data,
    .xr-array-preview {
      display: inline-block;
    }

    .xr-dim-list {
      display: inline-block !important;
      list-style: none;
      padding: 0 !important;
      margin: 0;
    }

    .xr-dim-list li {
      display: inline-block;
      padding: 0;
      margin: 0;
    }

    .xr-dim-list:before {
      content: "(";
    }

    .xr-dim-list:after {
      content: ")";
    }

    .xr-dim-list li:not(:last-child):after {
      content: ",";
      padding-right: 5px;
    }

    .xr-has-index {
      font-weight: bold;
    }

    .xr-var-list,
    .xr-var-item {
      display: contents;
    }

    .xr-var-item > div,
    .xr-var-item label,
    .xr-var-item > .xr-var-name span {
      background-color: var(--xr-background-color-row-even);
      border-color: var(--xr-background-color-row-odd);
      margin-bottom: 0;
      padding-top: 2px;
    }

    .xr-var-item > .xr-var-name:hover span {
      padding-right: 5px;
    }

    .xr-var-list > li:nth-child(odd) > div,
    .xr-var-list > li:nth-child(odd) > label,
    .xr-var-list > li:nth-child(odd) > .xr-var-name span {
      background-color: var(--xr-background-color-row-odd);
      border-color: var(--xr-background-color-row-even);
    }

    .xr-var-name {
      grid-column: 1;
    }

    .xr-var-dims {
      grid-column: 2;
    }

    .xr-var-dtype {
      grid-column: 3;
      text-align: right;
      color: var(--xr-font-color2);
    }

    .xr-var-preview {
      grid-column: 4;
    }

    .xr-index-preview {
      grid-column: 2 / 5;
      color: var(--xr-font-color2);
    }

    .xr-var-name,
    .xr-var-dims,
    .xr-var-dtype,
    .xr-preview,
    .xr-attrs dt {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      padding-right: 10px;
    }

    .xr-var-name:hover,
    .xr-var-dims:hover,
    .xr-var-dtype:hover,
    .xr-attrs dt:hover {
      overflow: visible;
      width: auto;
      z-index: 1;
    }

    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      display: none;
      border-top: 2px dotted var(--xr-background-color);
      padding-bottom: 20px !important;
      padding-top: 10px !important;
    }

    .xr-var-attrs-in + label,
    .xr-var-data-in + label,
    .xr-index-data-in + label {
      padding: 0 1px;
    }

    .xr-var-attrs-in:checked ~ .xr-var-attrs,
    .xr-var-data-in:checked ~ .xr-var-data,
    .xr-index-data-in:checked ~ .xr-index-data {
      display: block;
    }

    .xr-var-data > table {
      float: right;
    }

    .xr-var-data > pre,
    .xr-index-data > pre,
    .xr-var-data > table > tbody > tr {
      background-color: transparent !important;
    }

    .xr-var-name span,
    .xr-var-data,
    .xr-index-name div,
    .xr-index-data,
    .xr-attrs {
      padding-left: 25px !important;
    }

    .xr-attrs,
    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      grid-column: 1 / -1;
    }

    dl.xr-attrs {
      padding: 0;
      margin: 0;
      display: grid;
      grid-template-columns: 125px auto;
    }

    .xr-attrs dt,
    .xr-attrs dd {
      padding: 0;
      margin: 0;
      float: left;
      padding-right: 10px;
      width: auto;
    }

    .xr-attrs dt {
      font-weight: normal;
      grid-column: 1;
    }

    .xr-attrs dt:hover span {
      display: inline-block;
      background: var(--xr-background-color);
      padding-right: 10px;
    }

    .xr-attrs dd {
      grid-column: 2;
      white-space: pre-wrap;
      word-break: break-all;
    }

    .xr-icon-database,
    .xr-icon-file-text2,
    .xr-no-icon {
      display: inline-block;
      vertical-align: middle;
      width: 1em;
      height: 1.5em !important;
      stroke-width: 0;
      stroke: currentColor;
      fill: currentColor;
    }

    .xr-var-attrs-in:checked + label > .xr-icon-file-text2,
    .xr-var-data-in:checked + label > .xr-icon-database,
    .xr-index-data-in:checked + label > .xr-icon-database {
      color: var(--xr-font-color0);
      filter: drop-shadow(1px 1px 5px var(--xr-font-color2));
      stroke-width: 0.8px;
    }
    </style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 22kB
    Dimensions:  (lat: 30, lon: 60)
    Coordinates:
      * lat      (lat) float64 240B -85.48 -79.63 -73.74 ... 73.74 79.63 85.48
      * lon      (lon) float64 480B 0.0 6.0 12.0 18.0 ... 336.0 342.0 348.0 354.0
        level    int32 4B 500
    Data variables:
        psi_p    (lat, lon) float32 7kB 5.594e+06 5.615e+06 ... 7.892e+05 7.138e+05
        fx       (lat, lon) float32 7kB -0.01532 0.1764 0.399 ... 1.667 1.663 1.561
        fy       (lat, lon) float32 7kB -0.3833 -0.3339 -0.3641 ... 2.298 2.0 1.417
    Attributes:
        title:         Takaya and Nakamura Wave Activity Flux
        description:   Horizontal components of quasi-geostrophic wave activity f...
        reference:     Takaya, K. and H. Nakamura, 2001: A Formulation of a Phase...
        created_with:  easyclimate: calc_TN_wave_activity_horizontal_flux function</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-c09ab3a3-d12a-4bb8-a669-315c4ebf359a' class='xr-section-summary-in' type='checkbox' disabled /><label for='section-c09ab3a3-d12a-4bb8-a669-315c4ebf359a' class='xr-section-summary'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>lat</span>: 30</li><li><span class='xr-has-index'>lon</span>: 60</li></ul></div></li><li class='xr-section-item'><input id='section-28a16e89-43f3-4737-ae54-f422b4363762' class='xr-section-summary-in' type='checkbox' checked /><label for='section-28a16e89-43f3-4737-ae54-f422b4363762' class='xr-section-summary' title='Expand/collapse section'>Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-85.48 -79.63 ... 79.63 85.48</div><input id='attrs-788a7a2a-3cfa-4c29-a0a3-46f9505d6491' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-788a7a2a-3cfa-4c29-a0a3-46f9505d6491' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-56995953-27f4-4e59-87d0-138e58916c87' class='xr-var-data-in' type='checkbox'><label for='data-56995953-27f4-4e59-87d0-138e58916c87' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>long_name :</span></dt><dd>latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>axis :</span></dt><dd>Y</dd></dl></div><div class='xr-var-data'><pre>array([-85.482617, -79.630722, -73.74427 , -67.850013, -61.952799, -56.054157,
           -50.154722, -44.254802, -38.354569, -32.454124, -26.553532, -20.652838,
           -14.752072,  -8.851261,  -2.950423,   2.950423,   8.851261,  14.752072,
            20.652838,  26.553532,  32.454124,  38.354569,  44.254802,  50.154722,
            56.054157,  61.952799,  67.850013,  73.74427 ,  79.630722,  85.482617])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 6.0 12.0 ... 342.0 348.0 354.0</div><input id='attrs-b7f04fbe-86d3-4c4f-8463-f90e721098fb' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-b7f04fbe-86d3-4c4f-8463-f90e721098fb' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a16b87ec-11f8-4db9-8fe2-b1d14d1497b3' class='xr-var-data-in' type='checkbox'><label for='data-a16b87ec-11f8-4db9-8fe2-b1d14d1497b3' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>long_name :</span></dt><dd>longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>axis :</span></dt><dd>X</dd></dl></div><div class='xr-var-data'><pre>array([  0.,   6.,  12.,  18.,  24.,  30.,  36.,  42.,  48.,  54.,  60.,  66.,
            72.,  78.,  84.,  90.,  96., 102., 108., 114., 120., 126., 132., 138.,
           144., 150., 156., 162., 168., 174., 180., 186., 192., 198., 204., 210.,
           216., 222., 228., 234., 240., 246., 252., 258., 264., 270., 276., 282.,
           288., 294., 300., 306., 312., 318., 324., 330., 336., 342., 348., 354.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>level</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>500</div><input id='attrs-a5720df5-a2ca-4869-8451-e5736c234974' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-a5720df5-a2ca-4869-8451-e5736c234974' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-60118fe0-5805-4b2c-829e-11e59d6246da' class='xr-var-data-in' type='checkbox'><label for='data-60118fe0-5805-4b2c-829e-11e59d6246da' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>air_pressure</dd><dt><span>long_name :</span></dt><dd>pressure_level</dd><dt><span>units :</span></dt><dd>millibars</dd><dt><span>positive :</span></dt><dd>down</dd><dt><span>axis :</span></dt><dd>Z</dd></dl></div><div class='xr-var-data'><pre>array(500, dtype=int32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-bec01db2-5092-4913-9549-6288f6c8db8c' class='xr-section-summary-in' type='checkbox' checked /><label for='section-bec01db2-5092-4913-9549-6288f6c8db8c' class='xr-section-summary' title='Expand/collapse section'>Data variables: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>psi_p</span></div><div class='xr-var-dims'>(lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>5.594e+06 5.615e+06 ... 7.138e+05</div><input id='attrs-27cfd49f-da71-48fc-965d-c990079b8015' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-27cfd49f-da71-48fc-965d-c990079b8015' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0680282b-b9fc-434d-a808-56b97173ca9e' class='xr-var-data-in' type='checkbox'><label for='data-0680282b-b9fc-434d-a808-56b97173ca9e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Perturbation stream function</dd><dt><span>units :</span></dt><dd>m^2/s</dd><dt><span>description :</span></dt><dd>Geostrophic stream function perturbation calculated from geopotential height anomaly</dd></dl></div><div class='xr-var-data'><pre>array([[ 5.5938020e+06,  5.6146355e+06,  5.6498790e+06, ...,
             5.6161410e+06,  5.5980450e+06,  5.5882540e+06],
           [ 5.1080505e+06,  5.2447500e+06,  5.3889815e+06, ...,
             5.0263460e+06,  4.9858590e+06,  5.0184975e+06],
           [ 5.6851845e+06,  5.8798735e+06,  5.9037450e+06, ...,
             4.8398830e+06,  4.9754290e+06,  5.3237760e+06],
           ...,
           [-1.6486008e+06, -2.5191115e+06, -3.4225242e+06, ...,
            -4.0056731e+05, -6.2879800e+05, -1.0137227e+06],
           [-1.7253452e+06, -1.9866108e+06, -2.2160342e+06, ...,
            -8.1918544e+05, -1.1795360e+06, -1.4763795e+06],
           [ 6.4603019e+05,  5.9522512e+05,  5.6246344e+05, ...,
             8.5969088e+05,  7.8919356e+05,  7.1378669e+05]],
          shape=(30, 60), dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>fx</span></div><div class='xr-var-dims'>(lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-0.01532 0.1764 ... 1.663 1.561</div><input id='attrs-a9051131-07dd-48e3-b53d-9b007c8eb06a' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-a9051131-07dd-48e3-b53d-9b007c8eb06a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e440964c-b8ee-42ab-ae44-02a029c991bb' class='xr-var-data-in' type='checkbox'><label for='data-e440964c-b8ee-42ab-ae44-02a029c991bb' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Zonal component of TN wave activity horizontal flux</dd><dt><span>units :</span></dt><dd>m^2/s^2</dd><dt><span>description :</span></dt><dd>Eastward component of Takaya and Nakamura wave activity flux</dd><dt><span>standard_name :</span></dt><dd>tn_wave_activity_flux_x</dd></dl></div><div class='xr-var-data'><pre>array([[-1.5324190e-02,  1.7639446e-01,  3.9895377e-01, ...,
            -8.9055008e-01, -8.9628220e-01, -7.8193927e-01],
           [ 1.0498618e+00,  4.5485485e-01,  1.2934424e-01, ...,
             1.7679929e+00,  1.4661644e+00,  1.2856582e+00],
           [-4.3069382e+00, -4.2258787e+00, -3.2681661e+00, ...,
             1.3933069e+00,  5.9408468e-01,  1.5298730e-01],
           ...,
           [ 1.6097359e+01,  1.6636248e+01,  1.8783152e+01, ...,
             9.6921825e+00,  9.6207018e+00,  9.9884949e+00],
           [ 1.1627750e+01,  9.3065319e+00,  7.1896763e+00, ...,
             6.0044641e+00,  6.8815136e+00,  7.6878214e+00],
           [ 1.5397030e+00,  1.1007621e+00,  1.2194515e+00, ...,
             1.6668886e+00,  1.6630431e+00,  1.5612863e+00]],
          shape=(30, 60), dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>fy</span></div><div class='xr-var-dims'>(lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-0.3833 -0.3339 ... 2.0 1.417</div><input id='attrs-f12b3e80-0e75-49d1-bdad-5502d4442b0f' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-f12b3e80-0e75-49d1-bdad-5502d4442b0f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9a857c26-b9fc-4919-948f-72b8f76f9054' class='xr-var-data-in' type='checkbox'><label for='data-9a857c26-b9fc-4919-948f-72b8f76f9054' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Meridional component of TN wave activity horizontal flux</dd><dt><span>units :</span></dt><dd>m^2/s^2</dd><dt><span>description :</span></dt><dd>Northward component of Takaya and Nakamura wave activity flux</dd><dt><span>standard_name :</span></dt><dd>tn_wave_activity_flux_y</dd></dl></div><div class='xr-var-data'><pre>array([[-0.38331985, -0.33390382, -0.36405513, ..., -0.92202866,
            -0.87371093, -0.7019684 ],
           [-0.64679056, -0.39658502, -0.23005185, ..., -0.8501856 ,
            -0.9630834 , -1.0069782 ],
           [-0.735034  , -0.7088197 , -0.84506154, ..., -1.9515538 ,
            -1.2093978 , -1.2207261 ],
           ...,
           [ 2.499836  ,  2.955872  ,  2.7976928 , ...,  0.5444683 ,
             0.9106387 ,  1.5961461 ],
           [ 1.1317084 ,  1.0104574 ,  0.37608096, ...,  1.0190134 ,
             1.0614775 ,  1.0943542 ],
           [ 0.5663241 , -0.9487628 , -1.7273529 , ...,  2.298453  ,
             2.0001001 ,  1.417436  ]], shape=(30, 60), dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-a9a0c307-44e8-4cca-a4e9-490040fe310e' class='xr-section-summary-in' type='checkbox' checked /><label for='section-a9a0c307-44e8-4cca-a4e9-490040fe310e' class='xr-section-summary' title='Expand/collapse section'>Attributes: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>title :</span></dt><dd>Takaya and Nakamura Wave Activity Flux</dd><dt><span>description :</span></dt><dd>Horizontal components of quasi-geostrophic wave activity flux following Takaya and Nakamura (2001)</dd><dt><span>reference :</span></dt><dd>Takaya, K. and H. Nakamura, 2001: A Formulation of a Phase-Independent Wave-Activity Flux for Stationary and Migratory Quasigeostrophic Eddies on a Zonally Varying Basic Flow. J. Atmos. Sci., 58, 608-627.</dd><dt><span>created_with :</span></dt><dd>easyclimate: calc_TN_wave_activity_horizontal_flux function</dd></dl></div></li></ul></div></div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 111-115

.. code-block:: Python

    draw_shaded2 = tn01_mean_result2["psi_p"]
    draw_shaded2 = ecl.plot.add_lon_cyclic(draw_shaded2, 6)
    draw_quiver2 = tn01_mean_result2[["fx", "fy"]]








.. GENERATED FROM PYTHON SOURCE LINES 116-152

.. code-block:: Python

    fig, ax = plt.subplots(
        figsize = (12, 6),
        subplot_kw={"projection": ccrs.Mercator(central_longitude=140)}
    )
    ax.set_extent([0, 360, 10, 85], crs = ccrs.PlateCarree())
    ax.coastlines(edgecolor="black", linewidths=0.5)
    ax.gridlines(draw_labels=["bottom", "left"], alpha=0)

    fg1 = draw_shaded2.plot.contourf(
        ax = ax,
        levels = np.linspace(-1e7, 1e7, 21),
        cbar_kwargs = {'location': 'bottom', 'aspect': 80, 'shrink': 0.7, 'pad': 0.1, 'format': formatter},
        transform=ccrs.PlateCarree(),
        zorder = 1
    )

    q = draw_quiver2.sel(lat = slice(5, None)).plot.quiver(
        ax = ax,
        x = "lon", y = "lat", u = "fx", v = "fy",
        transform = ccrs.PlateCarree(),
        scale = 800,
        regrid_shape = 15,
        add_guide = False,
    )
    qk = ax.quiverkey(
        q, 0.95, 1.03,
        50, "50", labelpos = "N",
        color = "k",
        coordinates = "axes",
        fontproperties = {"size": 12},
        labelsep = 0.05,
        transform = ccrs.PlateCarree(),
    )

    ax.set_title("TN01 WAF Analysis (500hPa, Nov. 2024)")




.. image-sg:: /auto_gallery/eddy/images/sphx_glr_plot_waf_002.png
   :alt: TN01 WAF Analysis (500hPa, Nov. 2024)
   :srcset: /auto_gallery/eddy/images/sphx_glr_plot_waf_002.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    Text(0.5, 1.0, 'TN01 WAF Analysis (500hPa, Nov. 2024)')



.. GENERATED FROM PYTHON SOURCE LINES 153-155

Plumb Wave Activity Horizontal Flux
-----------------------------------------

.. GENERATED FROM PYTHON SOURCE LINES 155-163

.. code-block:: Python

    pwaf_result = ecl.calc_Plumb_wave_activity_horizontal_flux(
        z_prime_data = z500_prime_data2,
        vertical_dim = "level",
        vertical_dim_units = "hPa",
    )
    pwaf_mean_result = pwaf_result.mean(dim = "time").sortby("lat")
    pwaf_mean_result






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
    <defs>
    <symbol id="icon-database" viewBox="0 0 32 32">
    <path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
    <path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    <path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    </symbol>
    <symbol id="icon-file-text2" viewBox="0 0 32 32">
    <path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
    <path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    </symbol>
    </defs>
    </svg>
    <style>/* CSS stylesheet for displaying xarray objects in notebooks */

    :root {
      --xr-font-color0: var(
        --jp-content-font-color0,
        var(--pst-color-text-base rgba(0, 0, 0, 1))
      );
      --xr-font-color2: var(
        --jp-content-font-color2,
        var(--pst-color-text-base, rgba(0, 0, 0, 0.54))
      );
      --xr-font-color3: var(
        --jp-content-font-color3,
        var(--pst-color-text-base, rgba(0, 0, 0, 0.38))
      );
      --xr-border-color: var(
        --jp-border-color2,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 10))
      );
      --xr-disabled-color: var(
        --jp-layout-color3,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 40))
      );
      --xr-background-color: var(
        --jp-layout-color0,
        var(--pst-color-on-background, white)
      );
      --xr-background-color-row-even: var(
        --jp-layout-color1,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 5))
      );
      --xr-background-color-row-odd: var(
        --jp-layout-color2,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 15))
      );
    }

    html[theme="dark"],
    html[data-theme="dark"],
    body[data-theme="dark"],
    body.vscode-dark {
      --xr-font-color0: var(
        --jp-content-font-color0,
        var(--pst-color-text-base, rgba(255, 255, 255, 1))
      );
      --xr-font-color2: var(
        --jp-content-font-color2,
        var(--pst-color-text-base, rgba(255, 255, 255, 0.54))
      );
      --xr-font-color3: var(
        --jp-content-font-color3,
        var(--pst-color-text-base, rgba(255, 255, 255, 0.38))
      );
      --xr-border-color: var(
        --jp-border-color2,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))
      );
      --xr-disabled-color: var(
        --jp-layout-color3,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))
      );
      --xr-background-color: var(
        --jp-layout-color0,
        var(--pst-color-on-background, #111111)
      );
      --xr-background-color-row-even: var(
        --jp-layout-color1,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))
      );
      --xr-background-color-row-odd: var(
        --jp-layout-color2,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))
      );
    }

    .xr-wrap {
      display: block !important;
      min-width: 300px;
      max-width: 700px;
      line-height: 1.6;
      padding-bottom: 4px;
    }

    .xr-text-repr-fallback {
      /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
      display: none;
    }

    .xr-header {
      padding-top: 6px;
      padding-bottom: 6px;
    }

    .xr-header {
      border-bottom: solid 1px var(--xr-border-color);
      margin-bottom: 4px;
    }

    .xr-header > div,
    .xr-header > ul {
      display: inline;
      margin-top: 0;
      margin-bottom: 0;
    }

    .xr-obj-type,
    .xr-obj-name {
      margin-left: 2px;
      margin-right: 10px;
    }

    .xr-obj-type,
    .xr-group-box-contents > label {
      color: var(--xr-font-color2);
      display: block;
    }

    .xr-sections {
      padding-left: 0 !important;
      display: grid;
      grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
      margin-block-start: 0;
      margin-block-end: 0;
    }

    .xr-section-item {
      display: contents;
    }

    .xr-section-item > input,
    .xr-group-box-contents > input,
    .xr-array-wrap > input {
      display: block;
      opacity: 0;
      height: 0;
      margin: 0;
    }

    .xr-section-item > input + label,
    .xr-var-item > input + label {
      color: var(--xr-disabled-color);
    }

    .xr-section-item > input:enabled + label,
    .xr-var-item > input:enabled + label,
    .xr-array-wrap > input:enabled + label,
    .xr-group-box-contents > input:enabled + label {
      cursor: pointer;
      color: var(--xr-font-color2);
    }

    .xr-section-item > input:focus-visible + label,
    .xr-var-item > input:focus-visible + label,
    .xr-array-wrap > input:focus-visible + label,
    .xr-group-box-contents > input:focus-visible + label {
      outline: auto;
    }

    .xr-section-item > input:enabled + label:hover,
    .xr-var-item > input:enabled + label:hover,
    .xr-array-wrap > input:enabled + label:hover,
    .xr-group-box-contents > input:enabled + label:hover {
      color: var(--xr-font-color0);
    }

    .xr-section-summary {
      grid-column: 1;
      color: var(--xr-font-color2);
      font-weight: 500;
      white-space: nowrap;
    }

    .xr-section-summary > em {
      font-weight: normal;
    }

    .xr-span-grid {
      grid-column-end: -1;
    }

    .xr-section-summary > span {
      display: inline-block;
      padding-left: 0.3em;
    }

    .xr-group-box-contents > input:checked + label > span {
      display: inline-block;
      padding-left: 0.6em;
    }

    .xr-section-summary-in:disabled + label {
      color: var(--xr-font-color2);
    }

    .xr-section-summary-in + label:before {
      display: inline-block;
      content: "‚ñ∫";
      font-size: 11px;
      width: 15px;
      text-align: center;
    }

    .xr-section-summary-in:disabled + label:before {
      color: var(--xr-disabled-color);
    }

    .xr-section-summary-in:checked + label:before {
      content: "‚ñº";
    }

    .xr-section-summary-in:checked + label > span {
      display: none;
    }

    .xr-section-summary,
    .xr-section-inline-details,
    .xr-group-box-contents > label {
      padding-top: 4px;
    }

    .xr-section-inline-details {
      grid-column: 2 / -1;
    }

    .xr-section-details {
      grid-column: 1 / -1;
      margin-top: 4px;
      margin-bottom: 5px;
    }

    .xr-section-summary-in ~ .xr-section-details {
      display: none;
    }

    .xr-section-summary-in:checked ~ .xr-section-details {
      display: contents;
    }

    .xr-children {
      display: inline-grid;
      grid-template-columns: 100%;
      grid-column: 1 / -1;
      padding-top: 4px;
    }

    .xr-group-box {
      display: inline-grid;
      grid-template-columns: 0px 30px auto;
    }

    .xr-group-box-vline {
      grid-column-start: 1;
      border-right: 0.2em solid;
      border-color: var(--xr-border-color);
      width: 0px;
    }

    .xr-group-box-hline {
      grid-column-start: 2;
      grid-row-start: 1;
      height: 1em;
      width: 26px;
      border-bottom: 0.2em solid;
      border-color: var(--xr-border-color);
    }

    .xr-group-box-contents {
      grid-column-start: 3;
      padding-bottom: 4px;
    }

    .xr-group-box-contents > label::before {
      content: "üìÇ";
      padding-right: 0.3em;
    }

    .xr-group-box-contents > input:checked + label::before {
      content: "üìÅ";
    }

    .xr-group-box-contents > input:checked + label {
      padding-bottom: 0px;
    }

    .xr-group-box-contents > input:checked ~ .xr-sections {
      display: none;
    }

    .xr-group-box-contents > input + label > span {
      display: none;
    }

    .xr-group-box-ellipsis {
      font-size: 1.4em;
      font-weight: 900;
      color: var(--xr-font-color2);
      letter-spacing: 0.15em;
      cursor: default;
    }

    .xr-array-wrap {
      grid-column: 1 / -1;
      display: grid;
      grid-template-columns: 20px auto;
    }

    .xr-array-wrap > label {
      grid-column: 1;
      vertical-align: top;
    }

    .xr-preview {
      color: var(--xr-font-color3);
    }

    .xr-array-preview,
    .xr-array-data {
      padding: 0 5px !important;
      grid-column: 2;
    }

    .xr-array-data,
    .xr-array-in:checked ~ .xr-array-preview {
      display: none;
    }

    .xr-array-in:checked ~ .xr-array-data,
    .xr-array-preview {
      display: inline-block;
    }

    .xr-dim-list {
      display: inline-block !important;
      list-style: none;
      padding: 0 !important;
      margin: 0;
    }

    .xr-dim-list li {
      display: inline-block;
      padding: 0;
      margin: 0;
    }

    .xr-dim-list:before {
      content: "(";
    }

    .xr-dim-list:after {
      content: ")";
    }

    .xr-dim-list li:not(:last-child):after {
      content: ",";
      padding-right: 5px;
    }

    .xr-has-index {
      font-weight: bold;
    }

    .xr-var-list,
    .xr-var-item {
      display: contents;
    }

    .xr-var-item > div,
    .xr-var-item label,
    .xr-var-item > .xr-var-name span {
      background-color: var(--xr-background-color-row-even);
      border-color: var(--xr-background-color-row-odd);
      margin-bottom: 0;
      padding-top: 2px;
    }

    .xr-var-item > .xr-var-name:hover span {
      padding-right: 5px;
    }

    .xr-var-list > li:nth-child(odd) > div,
    .xr-var-list > li:nth-child(odd) > label,
    .xr-var-list > li:nth-child(odd) > .xr-var-name span {
      background-color: var(--xr-background-color-row-odd);
      border-color: var(--xr-background-color-row-even);
    }

    .xr-var-name {
      grid-column: 1;
    }

    .xr-var-dims {
      grid-column: 2;
    }

    .xr-var-dtype {
      grid-column: 3;
      text-align: right;
      color: var(--xr-font-color2);
    }

    .xr-var-preview {
      grid-column: 4;
    }

    .xr-index-preview {
      grid-column: 2 / 5;
      color: var(--xr-font-color2);
    }

    .xr-var-name,
    .xr-var-dims,
    .xr-var-dtype,
    .xr-preview,
    .xr-attrs dt {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      padding-right: 10px;
    }

    .xr-var-name:hover,
    .xr-var-dims:hover,
    .xr-var-dtype:hover,
    .xr-attrs dt:hover {
      overflow: visible;
      width: auto;
      z-index: 1;
    }

    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      display: none;
      border-top: 2px dotted var(--xr-background-color);
      padding-bottom: 20px !important;
      padding-top: 10px !important;
    }

    .xr-var-attrs-in + label,
    .xr-var-data-in + label,
    .xr-index-data-in + label {
      padding: 0 1px;
    }

    .xr-var-attrs-in:checked ~ .xr-var-attrs,
    .xr-var-data-in:checked ~ .xr-var-data,
    .xr-index-data-in:checked ~ .xr-index-data {
      display: block;
    }

    .xr-var-data > table {
      float: right;
    }

    .xr-var-data > pre,
    .xr-index-data > pre,
    .xr-var-data > table > tbody > tr {
      background-color: transparent !important;
    }

    .xr-var-name span,
    .xr-var-data,
    .xr-index-name div,
    .xr-index-data,
    .xr-attrs {
      padding-left: 25px !important;
    }

    .xr-attrs,
    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      grid-column: 1 / -1;
    }

    dl.xr-attrs {
      padding: 0;
      margin: 0;
      display: grid;
      grid-template-columns: 125px auto;
    }

    .xr-attrs dt,
    .xr-attrs dd {
      padding: 0;
      margin: 0;
      float: left;
      padding-right: 10px;
      width: auto;
    }

    .xr-attrs dt {
      font-weight: normal;
      grid-column: 1;
    }

    .xr-attrs dt:hover span {
      display: inline-block;
      background: var(--xr-background-color);
      padding-right: 10px;
    }

    .xr-attrs dd {
      grid-column: 2;
      white-space: pre-wrap;
      word-break: break-all;
    }

    .xr-icon-database,
    .xr-icon-file-text2,
    .xr-no-icon {
      display: inline-block;
      vertical-align: middle;
      width: 1em;
      height: 1.5em !important;
      stroke-width: 0;
      stroke: currentColor;
      fill: currentColor;
    }

    .xr-var-attrs-in:checked + label > .xr-icon-file-text2,
    .xr-var-data-in:checked + label > .xr-icon-database,
    .xr-index-data-in:checked + label > .xr-icon-database {
      color: var(--xr-font-color0);
      filter: drop-shadow(1px 1px 5px var(--xr-font-color2));
      stroke-width: 0.8px;
    }
    </style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 22kB
    Dimensions:  (lat: 30, lon: 60)
    Coordinates:
      * lat      (lat) float64 240B -85.48 -79.63 -73.74 ... 73.74 79.63 85.48
      * lon      (lon) float64 480B 0.0 6.0 12.0 18.0 ... 336.0 342.0 348.0 354.0
        level    int32 4B 500
    Data variables:
        psi_p    (lat, lon) float32 7kB 5.594e+06 5.615e+06 ... 7.892e+05 7.138e+05
        fx       (lat, lon) float32 7kB 0.06288 0.1975 0.3501 ... 2.258 2.289 2.281
        fy       (lat, lon) float32 7kB -0.0001407 -0.205 -0.4062 ... -0.1934 -0.613
    Attributes:
        title:         Plumb Wave Activity Flux
        description:   Horizontal components of quasi-geostrophic wave activity f...
        reference:     Plumb, R. A., 1985: On the Three-Dimensional Propagation o...
        created_with:  easyclimate: calc_Plumb_wave_activity_horizontal_flux func...</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-41a0a733-4b04-4032-a0a1-3fbbd4b58915' class='xr-section-summary-in' type='checkbox' disabled /><label for='section-41a0a733-4b04-4032-a0a1-3fbbd4b58915' class='xr-section-summary'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>lat</span>: 30</li><li><span class='xr-has-index'>lon</span>: 60</li></ul></div></li><li class='xr-section-item'><input id='section-465d4c8b-9443-4576-b91a-2d7f257e0653' class='xr-section-summary-in' type='checkbox' checked /><label for='section-465d4c8b-9443-4576-b91a-2d7f257e0653' class='xr-section-summary' title='Expand/collapse section'>Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-85.48 -79.63 ... 79.63 85.48</div><input id='attrs-af6582b1-210d-4ffe-80ee-4d303fb793c5' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-af6582b1-210d-4ffe-80ee-4d303fb793c5' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-62bce38a-f6d7-4b24-8e8c-26cf45f5a8fa' class='xr-var-data-in' type='checkbox'><label for='data-62bce38a-f6d7-4b24-8e8c-26cf45f5a8fa' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>long_name :</span></dt><dd>latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>axis :</span></dt><dd>Y</dd></dl></div><div class='xr-var-data'><pre>array([-85.482617, -79.630722, -73.74427 , -67.850013, -61.952799, -56.054157,
           -50.154722, -44.254802, -38.354569, -32.454124, -26.553532, -20.652838,
           -14.752072,  -8.851261,  -2.950423,   2.950423,   8.851261,  14.752072,
            20.652838,  26.553532,  32.454124,  38.354569,  44.254802,  50.154722,
            56.054157,  61.952799,  67.850013,  73.74427 ,  79.630722,  85.482617])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 6.0 12.0 ... 342.0 348.0 354.0</div><input id='attrs-0769b848-223e-4ade-8c60-ae5af6502042' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-0769b848-223e-4ade-8c60-ae5af6502042' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f36bcf1a-a5ab-47da-bcbb-2911820908fd' class='xr-var-data-in' type='checkbox'><label for='data-f36bcf1a-a5ab-47da-bcbb-2911820908fd' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>long_name :</span></dt><dd>longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>axis :</span></dt><dd>X</dd></dl></div><div class='xr-var-data'><pre>array([  0.,   6.,  12.,  18.,  24.,  30.,  36.,  42.,  48.,  54.,  60.,  66.,
            72.,  78.,  84.,  90.,  96., 102., 108., 114., 120., 126., 132., 138.,
           144., 150., 156., 162., 168., 174., 180., 186., 192., 198., 204., 210.,
           216., 222., 228., 234., 240., 246., 252., 258., 264., 270., 276., 282.,
           288., 294., 300., 306., 312., 318., 324., 330., 336., 342., 348., 354.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>level</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>500</div><input id='attrs-b029585c-f90c-470a-9456-5ff8fd1756a2' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-b029585c-f90c-470a-9456-5ff8fd1756a2' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-97b591e4-c320-4edb-bb3c-36e761257d49' class='xr-var-data-in' type='checkbox'><label for='data-97b591e4-c320-4edb-bb3c-36e761257d49' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>air_pressure</dd><dt><span>long_name :</span></dt><dd>pressure_level</dd><dt><span>units :</span></dt><dd>millibars</dd><dt><span>positive :</span></dt><dd>down</dd><dt><span>axis :</span></dt><dd>Z</dd></dl></div><div class='xr-var-data'><pre>array(500, dtype=int32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-0054581b-5c11-42ae-b370-2f99585bad62' class='xr-section-summary-in' type='checkbox' checked /><label for='section-0054581b-5c11-42ae-b370-2f99585bad62' class='xr-section-summary' title='Expand/collapse section'>Data variables: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>psi_p</span></div><div class='xr-var-dims'>(lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>5.594e+06 5.615e+06 ... 7.138e+05</div><input id='attrs-6346d28d-ea73-48e7-bebd-35a127bf7d2f' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-6346d28d-ea73-48e7-bebd-35a127bf7d2f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-88419465-db5f-4a3f-a206-bba62209af89' class='xr-var-data-in' type='checkbox'><label for='data-88419465-db5f-4a3f-a206-bba62209af89' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Perturbation stream function</dd><dt><span>units :</span></dt><dd>m^2/s</dd><dt><span>description :</span></dt><dd>Geostrophic stream function perturbation calculated from geopotential height anomaly</dd></dl></div><div class='xr-var-data'><pre>array([[ 5.5938020e+06,  5.6146355e+06,  5.6498790e+06, ...,
             5.6161410e+06,  5.5980450e+06,  5.5882540e+06],
           [ 5.1080505e+06,  5.2447500e+06,  5.3889815e+06, ...,
             5.0263460e+06,  4.9858590e+06,  5.0184975e+06],
           [ 5.6851845e+06,  5.8798735e+06,  5.9037450e+06, ...,
             4.8398830e+06,  4.9754290e+06,  5.3237760e+06],
           ...,
           [-1.6486008e+06, -2.5191115e+06, -3.4225242e+06, ...,
            -4.0056731e+05, -6.2879800e+05, -1.0137227e+06],
           [-1.7253452e+06, -1.9866108e+06, -2.2160342e+06, ...,
            -8.1918544e+05, -1.1795360e+06, -1.4763795e+06],
           [ 6.4603019e+05,  5.9522512e+05,  5.6246344e+05, ...,
             8.5969088e+05,  7.8919356e+05,  7.1378669e+05]],
          shape=(30, 60), dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>fx</span></div><div class='xr-var-dims'>(lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.06288 0.1975 ... 2.289 2.281</div><input id='attrs-57443df8-8495-4685-893c-c3f9f5a940aa' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-57443df8-8495-4685-893c-c3f9f5a940aa' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-97c8ec8e-bc94-4640-b7c3-cdb6a82eb0e5' class='xr-var-data-in' type='checkbox'><label for='data-97c8ec8e-bc94-4640-b7c3-cdb6a82eb0e5' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Zonal component of Plumb wave activity horizontal flux</dd><dt><span>units :</span></dt><dd>m^2/s^2</dd><dt><span>description :</span></dt><dd>Eastward component of Plumb wave activity flux</dd><dt><span>standard_name :</span></dt><dd>tn_wave_activity_flux_x</dd></dl></div><div class='xr-var-data'><pre>array([[ 0.06287556,  0.19750811,  0.35009277, ...,  0.40255812,
             0.4382005 ,  0.5016371 ],
           [ 2.434162  ,  1.9353898 ,  1.6111541 , ...,  2.3820665 ,
             1.8702205 ,  1.5506308 ],
           [ 7.2345657 ,  5.174896  ,  3.3704126 , ...,  3.4364438 ,
             2.972242  ,  3.5416865 ],
           ...,
           [16.283007  , 16.733433  , 18.74035   , ..., 10.376772  ,
             9.9656    , 10.175784  ],
           [11.914114  ,  9.468366  ,  7.251418  , ...,  6.44123   ,
             7.232388  ,  7.9539156 ],
           [ 2.4217882 ,  2.258989  ,  2.2392244 , ...,  2.257672  ,
             2.2887034 ,  2.2810705 ]], shape=(30, 60), dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>fy</span></div><div class='xr-var-dims'>(lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-0.0001407 -0.205 ... -0.613</div><input id='attrs-078929fe-ccec-482b-b654-b5cd337ec5f2' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-078929fe-ccec-482b-b654-b5cd337ec5f2' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ab87c0c5-4725-4785-be6c-a1d8d0236327' class='xr-var-data-in' type='checkbox'><label for='data-ab87c0c5-4725-4785-be6c-a1d8d0236327' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Meridional component of Plumb wave activity horizontal flux</dd><dt><span>units :</span></dt><dd>m^2/s^2</dd><dt><span>description :</span></dt><dd>Northward component of Plumb wave activity flux</dd><dt><span>standard_name :</span></dt><dd>Plumb_wave_activity_flux_y</dd></dl></div><div class='xr-var-data'><pre>array([[-1.4067093e-04, -2.0500183e-01, -4.0623420e-01, ...,
             7.9862046e-01,  7.8352523e-01,  6.4764839e-01],
           [-2.2974579e-02,  3.4463775e-01,  5.5402184e-01, ...,
            -3.2563546e-01, -4.6377558e-01, -6.0410750e-01],
           [-1.1877099e+00, -2.4802142e-01,  4.2529219e-01, ...,
            -2.3693984e+00, -2.2608907e+00, -2.0488691e+00],
           ...,
           [ 4.8163742e-01,  9.1962165e-01,  1.4837648e+00, ...,
            -1.4265828e+00, -8.0261981e-01, -1.5377127e-01],
           [ 1.8826015e-02,  4.4345237e-02, -1.6037226e-01, ...,
            -3.3882576e-01, -2.2237176e-01, -9.6785575e-02],
           [-1.2135042e+00, -2.4160337e+00, -2.7841237e+00, ...,
             7.3985808e-02, -1.9339696e-01, -6.1300033e-01]],
          shape=(30, 60), dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-5aa7c8d9-20f6-4396-acd0-f08152889652' class='xr-section-summary-in' type='checkbox' checked /><label for='section-5aa7c8d9-20f6-4396-acd0-f08152889652' class='xr-section-summary' title='Expand/collapse section'>Attributes: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>title :</span></dt><dd>Plumb Wave Activity Flux</dd><dt><span>description :</span></dt><dd>Horizontal components of quasi-geostrophic wave activity flux following Plumb (1985)</dd><dt><span>reference :</span></dt><dd>Plumb, R. A., 1985: On the Three-Dimensional Propagation of Stationary Waves. J. Atmos. Sci., 42, 217‚Äì229</dd><dt><span>created_with :</span></dt><dd>easyclimate: calc_Plumb_wave_activity_horizontal_flux function</dd></dl></div></li></ul></div></div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 164-168

.. code-block:: Python

    draw_shaded3 = pwaf_mean_result["psi_p"]
    draw_shaded3 = ecl.plot.add_lon_cyclic(draw_shaded3, 6)
    draw_quiver3 = pwaf_mean_result[["fx", "fy"]]








.. GENERATED FROM PYTHON SOURCE LINES 169-204

.. code-block:: Python

    fig, ax = plt.subplots(
        figsize = (12, 6),
        subplot_kw={"projection": ccrs.Mercator(central_longitude=140)}
    )
    ax.set_extent([0, 360, 10, 85], crs = ccrs.PlateCarree())
    ax.coastlines(edgecolor="black", linewidths=0.5)
    ax.gridlines(draw_labels=["bottom", "left"], alpha=0)

    fg1 = draw_shaded3.plot.contourf(
        ax = ax,
        levels = np.linspace(-1e7, 1e7, 21),
        cbar_kwargs = {'location': 'bottom', 'aspect': 80, 'shrink': 0.7, 'pad': 0.1, 'format': formatter},
        transform=ccrs.PlateCarree(),
        zorder = 1
    )

    q = draw_quiver3.sel(lat = slice(5, None)).plot.quiver(
        ax = ax,
        x = "lon", y = "lat", u = "fx", v = "fy",
        transform = ccrs.PlateCarree(),
        scale = 800,
        regrid_shape = 15,
        add_guide = False,
    )
    qk = ax.quiverkey(
        q, 0.95, 1.03,
        50, "50", labelpos = "N",
        color = "k",
        coordinates = "axes",
        fontproperties = {"size": 12},
        labelsep = 0.05,
        transform = ccrs.PlateCarree(),
    )

    ax.set_title("Plumb WAF Analysis (500hPa, Nov. 2024)")



.. image-sg:: /auto_gallery/eddy/images/sphx_glr_plot_waf_003.png
   :alt: Plumb WAF Analysis (500hPa, Nov. 2024)
   :srcset: /auto_gallery/eddy/images/sphx_glr_plot_waf_003.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    Text(0.5, 1.0, 'Plumb WAF Analysis (500hPa, Nov. 2024)')




.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (0 minutes 6.968 seconds)


.. _sphx_glr_download_auto_gallery_eddy_plot_waf.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: plot_waf.ipynb <plot_waf.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: plot_waf.py <plot_waf.py>`

    .. container:: sphx-glr-download sphx-glr-download-zip

      :download:`Download zipped: plot_waf.zip <plot_waf.zip>`
