
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_gallery/eddy/plot_egr.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_auto_gallery_eddy_plot_egr.py>`
        to download the full example code.

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_gallery_eddy_plot_egr.py:


.. _max_egr_example:

Maximum Eady Growth Rate
============================================
Think of the atmosphere as a giant, swirling dance of air masses. Sometimes these dances become unstable and form dramatic weather systems like storms and cyclones. The Eady Growth Rate is like a "storm predictor" - it tells us how quickly these weather systems can grow and intensify!

Technically speaking, the Eady Growth Rate measures how fast weather disturbances can amplify in a rotating, stratified atmosphere. It was first derived from the famous Eady model in 1949 and has become a fundamental tool for meteorologists ever since.

The mathematical formula looks like this:

.. math::

   \sigma = 0.3098 \frac{f}{N} \frac{\mathrm{d} U}{\mathrm{d} z}

Where:

- :math:`\sigma` is the Eady growth rate (how fast storms grow)
- :math:`f` is the Coriolis parameter (Earth's rotation effect)
- :math:`N` is the Brunt-V√§is√§l√§ frequency (atmosphere's stability)
- :math:`\frac{\mathrm{d} U}{\mathrm{d} z}` is the vertical wind shear (how wind changes with height)

.. caution::

   The Eady growth rate is a non-linear quantity, so you should **NOT** apply it directly to monthly averaged data. If you want monthly EGR values, calculate EGR first using daily data, then compute the monthly average!

.. seealso::
    - Eady, E. T. (1949). Long Waves and Cyclone Waves. Tellus, 1(3), 33‚Äì52. https://doi.org/10.3402/tellusa.v1i3.8507, https://www.tandfonline.com/doi/abs/10.3402/tellusa.v1i3.8507
    - Lindzen, R. S. , & Farrell, B. (1980). A Simple Approximate Result for the Maximum Growth Rate of Baroclinic Instabilities. Journal of Atmospheric Sciences, 37(7), 1648-1654. https://journals.ametsoc.org/view/journals/atsc/37/7/1520-0469_1980_037_1648_asarft_2_0_co_2.xml
    - Simmonds, I., and E.-P. Lim (2009), Biases in the calculation of Southern Hemisphere mean baroclinic eddy growth rate, Geophys. Res. Lett., 36, L01707, https://doi.org/10.1029/2008GL036320.
    - Sloyan, B. M., and T. J. O'Kane (2015), Drivers of decadal variability in the Tasman Sea, J. Geophys. Res. Oceans, 120, 3193‚Äì3210, https://doi.org/10.1002/2014JC010550.
    - `eady_growth_rate -NCL <https://www.ncl.ucar.edu/Document/Functions/Contributed/eady_growth_rate.shtml>`__

First, we import our tools! Think of this as gathering our weather forecasting equipment, and also set up a special number formatter to make our scientific notation look clean and professional!

.. GENERATED FROM PYTHON SOURCE LINES 37-45

.. code-block:: Python

    import easyclimate as ecl
    import cartopy.crs as ccrs
    import cmaps
    import matplotlib.ticker as ticker

    formatter = ticker.ScalarFormatter(useMathText=True, useOffset=True)
    formatter.set_powerlimits((0, 0))








.. GENERATED FROM PYTHON SOURCE LINES 46-57

Time to load our weather ingredients! We're gathering three key ingredients:

1. **Zonal Wind (uwnd_daily)**: The east-west component of wind - imagine the wind blowing from west to east
2. **Geopotential Height (z_daily)**: Think of this as the "height" of pressure levels in the atmosphere
3. **Temperature (temp_daily)**: The air temperature at different levels

.. attention::

   The geopotential height data should be **meters**, NOT :math:`\mathrm{m^2 \cdot s^2}` which is the unit used in the representation of potential energy.

We use ``sortby("lat")`` to ensure our latitude data is properly organized from south to north.

.. GENERATED FROM PYTHON SOURCE LINES 57-71

.. code-block:: Python


    uwnd_daily = (
        ecl.open_tutorial_dataset("uwnd_2022_day5")
        .uwnd.sortby("lat")
    )
    z_daily = (
        ecl.open_tutorial_dataset("hgt_2022_day5")
        .hgt.sortby("lat")
    )
    temp_daily = (
        ecl.open_tutorial_dataset("air_2022_day5")
        .air.sortby("lat")
    )





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    uwnd_2022_day5.nc ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ 100.0% ‚Ä¢ 2.2/2.2 MB ‚Ä¢ 82.5 MB/s ‚Ä¢ 0:00:00
    hgt_2022_day5.nc ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ 100.0% ‚Ä¢ 1.7/1.7 MB ‚Ä¢ 64.3 MB/s ‚Ä¢ 0:00:00
    air_2022_day5.nc ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ 100.0% ‚Ä¢ 1.9/1.9 MB ‚Ä¢ 66.6 MB/s ‚Ä¢ 0:00:00




.. GENERATED FROM PYTHON SOURCE LINES 72-84

Now for the magic! üé© We call the :py:class:`easyclimate.calc_eady_growth_rate <easyclimate.calc_eady_growth_rate>` function with our three weather ingredients:

- ``vertical_dim="level"`` tells the function that our vertical coordinate is called "level"
- ``vertical_dim_units="hPa"`` specifies that we're using hectopascals (the standard unit for atmospheric pressure levels)

The function returns a treasure trove of information:

- ``eady_growth_rate``: Our main star - the maximum Eady growth rate.
- ``dudz``: The vertical wind shear.
- ``brunt_vaisala_frequency``: The Brunt-V√§is√§l√§ frequency (atmospheric stability).

We use ``.isel(time=3)`` to select the fourth time step (Python counts from 0!) for visualization.

.. GENERATED FROM PYTHON SOURCE LINES 84-94

.. code-block:: Python


    egr_result = ecl.calc_eady_growth_rate(
        u_daily_data=uwnd_daily,
        z_daily_data=z_daily,
        temper_daily_data=temp_daily,
        vertical_dim="level",
        vertical_dim_units="hPa",
    ).isel(time=3)
    egr_result





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    /opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/xarray/computation/apply_ufunc.py:820: RuntimeWarning: invalid value encountered in sqrt
      result_data = func(*input_data)


.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
    <defs>
    <symbol id="icon-database" viewBox="0 0 32 32">
    <path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
    <path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    <path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    </symbol>
    <symbol id="icon-file-text2" viewBox="0 0 32 32">
    <path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
    <path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    </symbol>
    </defs>
    </svg>
    <style>/* CSS stylesheet for displaying xarray objects in notebooks */

    :root {
      --xr-font-color0: var(
        --jp-content-font-color0,
        var(--pst-color-text-base rgba(0, 0, 0, 1))
      );
      --xr-font-color2: var(
        --jp-content-font-color2,
        var(--pst-color-text-base, rgba(0, 0, 0, 0.54))
      );
      --xr-font-color3: var(
        --jp-content-font-color3,
        var(--pst-color-text-base, rgba(0, 0, 0, 0.38))
      );
      --xr-border-color: var(
        --jp-border-color2,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 10))
      );
      --xr-disabled-color: var(
        --jp-layout-color3,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 40))
      );
      --xr-background-color: var(
        --jp-layout-color0,
        var(--pst-color-on-background, white)
      );
      --xr-background-color-row-even: var(
        --jp-layout-color1,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 5))
      );
      --xr-background-color-row-odd: var(
        --jp-layout-color2,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 15))
      );
    }

    html[theme="dark"],
    html[data-theme="dark"],
    body[data-theme="dark"],
    body.vscode-dark {
      --xr-font-color0: var(
        --jp-content-font-color0,
        var(--pst-color-text-base, rgba(255, 255, 255, 1))
      );
      --xr-font-color2: var(
        --jp-content-font-color2,
        var(--pst-color-text-base, rgba(255, 255, 255, 0.54))
      );
      --xr-font-color3: var(
        --jp-content-font-color3,
        var(--pst-color-text-base, rgba(255, 255, 255, 0.38))
      );
      --xr-border-color: var(
        --jp-border-color2,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))
      );
      --xr-disabled-color: var(
        --jp-layout-color3,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))
      );
      --xr-background-color: var(
        --jp-layout-color0,
        var(--pst-color-on-background, #111111)
      );
      --xr-background-color-row-even: var(
        --jp-layout-color1,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))
      );
      --xr-background-color-row-odd: var(
        --jp-layout-color2,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))
      );
    }

    .xr-wrap {
      display: block !important;
      min-width: 300px;
      max-width: 700px;
      line-height: 1.6;
      padding-bottom: 4px;
    }

    .xr-text-repr-fallback {
      /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
      display: none;
    }

    .xr-header {
      padding-top: 6px;
      padding-bottom: 6px;
    }

    .xr-header {
      border-bottom: solid 1px var(--xr-border-color);
      margin-bottom: 4px;
    }

    .xr-header > div,
    .xr-header > ul {
      display: inline;
      margin-top: 0;
      margin-bottom: 0;
    }

    .xr-obj-type,
    .xr-obj-name {
      margin-left: 2px;
      margin-right: 10px;
    }

    .xr-obj-type,
    .xr-group-box-contents > label {
      color: var(--xr-font-color2);
      display: block;
    }

    .xr-sections {
      padding-left: 0 !important;
      display: grid;
      grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
      margin-block-start: 0;
      margin-block-end: 0;
    }

    .xr-section-item {
      display: contents;
    }

    .xr-section-item > input,
    .xr-group-box-contents > input,
    .xr-array-wrap > input {
      display: block;
      opacity: 0;
      height: 0;
      margin: 0;
    }

    .xr-section-item > input + label,
    .xr-var-item > input + label {
      color: var(--xr-disabled-color);
    }

    .xr-section-item > input:enabled + label,
    .xr-var-item > input:enabled + label,
    .xr-array-wrap > input:enabled + label,
    .xr-group-box-contents > input:enabled + label {
      cursor: pointer;
      color: var(--xr-font-color2);
    }

    .xr-section-item > input:focus-visible + label,
    .xr-var-item > input:focus-visible + label,
    .xr-array-wrap > input:focus-visible + label,
    .xr-group-box-contents > input:focus-visible + label {
      outline: auto;
    }

    .xr-section-item > input:enabled + label:hover,
    .xr-var-item > input:enabled + label:hover,
    .xr-array-wrap > input:enabled + label:hover,
    .xr-group-box-contents > input:enabled + label:hover {
      color: var(--xr-font-color0);
    }

    .xr-section-summary {
      grid-column: 1;
      color: var(--xr-font-color2);
      font-weight: 500;
      white-space: nowrap;
    }

    .xr-section-summary > em {
      font-weight: normal;
    }

    .xr-span-grid {
      grid-column-end: -1;
    }

    .xr-section-summary > span {
      display: inline-block;
      padding-left: 0.3em;
    }

    .xr-group-box-contents > input:checked + label > span {
      display: inline-block;
      padding-left: 0.6em;
    }

    .xr-section-summary-in:disabled + label {
      color: var(--xr-font-color2);
    }

    .xr-section-summary-in + label:before {
      display: inline-block;
      content: "‚ñ∫";
      font-size: 11px;
      width: 15px;
      text-align: center;
    }

    .xr-section-summary-in:disabled + label:before {
      color: var(--xr-disabled-color);
    }

    .xr-section-summary-in:checked + label:before {
      content: "‚ñº";
    }

    .xr-section-summary-in:checked + label > span {
      display: none;
    }

    .xr-section-summary,
    .xr-section-inline-details,
    .xr-group-box-contents > label {
      padding-top: 4px;
    }

    .xr-section-inline-details {
      grid-column: 2 / -1;
    }

    .xr-section-details {
      grid-column: 1 / -1;
      margin-top: 4px;
      margin-bottom: 5px;
    }

    .xr-section-summary-in ~ .xr-section-details {
      display: none;
    }

    .xr-section-summary-in:checked ~ .xr-section-details {
      display: contents;
    }

    .xr-children {
      display: inline-grid;
      grid-template-columns: 100%;
      grid-column: 1 / -1;
      padding-top: 4px;
    }

    .xr-group-box {
      display: inline-grid;
      grid-template-columns: 0px 30px auto;
    }

    .xr-group-box-vline {
      grid-column-start: 1;
      border-right: 0.2em solid;
      border-color: var(--xr-border-color);
      width: 0px;
    }

    .xr-group-box-hline {
      grid-column-start: 2;
      grid-row-start: 1;
      height: 1em;
      width: 26px;
      border-bottom: 0.2em solid;
      border-color: var(--xr-border-color);
    }

    .xr-group-box-contents {
      grid-column-start: 3;
      padding-bottom: 4px;
    }

    .xr-group-box-contents > label::before {
      content: "üìÇ";
      padding-right: 0.3em;
    }

    .xr-group-box-contents > input:checked + label::before {
      content: "üìÅ";
    }

    .xr-group-box-contents > input:checked + label {
      padding-bottom: 0px;
    }

    .xr-group-box-contents > input:checked ~ .xr-sections {
      display: none;
    }

    .xr-group-box-contents > input + label > span {
      display: none;
    }

    .xr-group-box-ellipsis {
      font-size: 1.4em;
      font-weight: 900;
      color: var(--xr-font-color2);
      letter-spacing: 0.15em;
      cursor: default;
    }

    .xr-array-wrap {
      grid-column: 1 / -1;
      display: grid;
      grid-template-columns: 20px auto;
    }

    .xr-array-wrap > label {
      grid-column: 1;
      vertical-align: top;
    }

    .xr-preview {
      color: var(--xr-font-color3);
    }

    .xr-array-preview,
    .xr-array-data {
      padding: 0 5px !important;
      grid-column: 2;
    }

    .xr-array-data,
    .xr-array-in:checked ~ .xr-array-preview {
      display: none;
    }

    .xr-array-in:checked ~ .xr-array-data,
    .xr-array-preview {
      display: inline-block;
    }

    .xr-dim-list {
      display: inline-block !important;
      list-style: none;
      padding: 0 !important;
      margin: 0;
    }

    .xr-dim-list li {
      display: inline-block;
      padding: 0;
      margin: 0;
    }

    .xr-dim-list:before {
      content: "(";
    }

    .xr-dim-list:after {
      content: ")";
    }

    .xr-dim-list li:not(:last-child):after {
      content: ",";
      padding-right: 5px;
    }

    .xr-has-index {
      font-weight: bold;
    }

    .xr-var-list,
    .xr-var-item {
      display: contents;
    }

    .xr-var-item > div,
    .xr-var-item label,
    .xr-var-item > .xr-var-name span {
      background-color: var(--xr-background-color-row-even);
      border-color: var(--xr-background-color-row-odd);
      margin-bottom: 0;
      padding-top: 2px;
    }

    .xr-var-item > .xr-var-name:hover span {
      padding-right: 5px;
    }

    .xr-var-list > li:nth-child(odd) > div,
    .xr-var-list > li:nth-child(odd) > label,
    .xr-var-list > li:nth-child(odd) > .xr-var-name span {
      background-color: var(--xr-background-color-row-odd);
      border-color: var(--xr-background-color-row-even);
    }

    .xr-var-name {
      grid-column: 1;
    }

    .xr-var-dims {
      grid-column: 2;
    }

    .xr-var-dtype {
      grid-column: 3;
      text-align: right;
      color: var(--xr-font-color2);
    }

    .xr-var-preview {
      grid-column: 4;
    }

    .xr-index-preview {
      grid-column: 2 / 5;
      color: var(--xr-font-color2);
    }

    .xr-var-name,
    .xr-var-dims,
    .xr-var-dtype,
    .xr-preview,
    .xr-attrs dt {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      padding-right: 10px;
    }

    .xr-var-name:hover,
    .xr-var-dims:hover,
    .xr-var-dtype:hover,
    .xr-attrs dt:hover {
      overflow: visible;
      width: auto;
      z-index: 1;
    }

    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      display: none;
      border-top: 2px dotted var(--xr-background-color);
      padding-bottom: 20px !important;
      padding-top: 10px !important;
    }

    .xr-var-attrs-in + label,
    .xr-var-data-in + label,
    .xr-index-data-in + label {
      padding: 0 1px;
    }

    .xr-var-attrs-in:checked ~ .xr-var-attrs,
    .xr-var-data-in:checked ~ .xr-var-data,
    .xr-index-data-in:checked ~ .xr-index-data {
      display: block;
    }

    .xr-var-data > table {
      float: right;
    }

    .xr-var-data > pre,
    .xr-index-data > pre,
    .xr-var-data > table > tbody > tr {
      background-color: transparent !important;
    }

    .xr-var-name span,
    .xr-var-data,
    .xr-index-name div,
    .xr-index-data,
    .xr-attrs {
      padding-left: 25px !important;
    }

    .xr-attrs,
    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      grid-column: 1 / -1;
    }

    dl.xr-attrs {
      padding: 0;
      margin: 0;
      display: grid;
      grid-template-columns: 125px auto;
    }

    .xr-attrs dt,
    .xr-attrs dd {
      padding: 0;
      margin: 0;
      float: left;
      padding-right: 10px;
      width: auto;
    }

    .xr-attrs dt {
      font-weight: normal;
      grid-column: 1;
    }

    .xr-attrs dt:hover span {
      display: inline-block;
      background: var(--xr-background-color);
      padding-right: 10px;
    }

    .xr-attrs dd {
      grid-column: 2;
      white-space: pre-wrap;
      word-break: break-all;
    }

    .xr-icon-database,
    .xr-icon-file-text2,
    .xr-no-icon {
      display: inline-block;
      vertical-align: middle;
      width: 1em;
      height: 1.5em !important;
      stroke-width: 0;
      stroke: currentColor;
      fill: currentColor;
    }

    .xr-var-attrs-in:checked + label > .xr-icon-file-text2,
    .xr-var-data-in:checked + label > .xr-icon-database,
    .xr-index-data-in:checked + label > .xr-icon-database {
      color: var(--xr-font-color0);
      filter: drop-shadow(1px 1px 5px var(--xr-font-color2));
      stroke-width: 0.8px;
    }
    </style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 3MB
    Dimensions:                  (lat: 73, lon: 144, level: 17)
    Coordinates:
      * lat                      (lat) float32 292B -90.0 -87.5 -85.0 ... 87.5 90.0
      * lon                      (lon) float32 576B 0.0 2.5 5.0 ... 355.0 357.5
      * level                    (level) float32 68B 1e+03 925.0 850.0 ... 20.0 10.0
        time                     datetime64[ns] 8B 2022-01-04
    Data variables:
        eady_growth_rate         (level, lat, lon) float64 1MB 2.789e-06 ... 1.40...
        dudz                     (level, lat, lon) float32 715kB -0.0006436 ... -...
        brunt_vaisala_frequency  (level, lat, lon) float32 715kB 0.01043 ... 0.02216</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-b60f9874-0ba3-4757-a4e0-83e8d6953a84' class='xr-section-summary-in' type='checkbox' disabled /><label for='section-b60f9874-0ba3-4757-a4e0-83e8d6953a84' class='xr-section-summary'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>lat</span>: 73</li><li><span class='xr-has-index'>lon</span>: 144</li><li><span class='xr-has-index'>level</span>: 17</li></ul></div></li><li class='xr-section-item'><input id='section-6960bd4e-0126-4756-9e27-00c19c817524' class='xr-section-summary-in' type='checkbox' checked /><label for='section-6960bd4e-0126-4756-9e27-00c19c817524' class='xr-section-summary' title='Expand/collapse section'>Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-90.0 -87.5 -85.0 ... 87.5 90.0</div><input id='attrs-d1ef3b98-0d6a-4ce5-86bf-0b5ef1dc5f5b' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-d1ef3b98-0d6a-4ce5-86bf-0b5ef1dc5f5b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6b93c1fa-9343-44c2-bfc1-86000fc1ce13' class='xr-var-data-in' type='checkbox'><label for='data-6b93c1fa-9343-44c2-bfc1-86000fc1ce13' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>long_name :</span></dt><dd>Latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>axis :</span></dt><dd>Y</dd></dl></div><div class='xr-var-data'><pre>array([-90. , -87.5, -85. , -82.5, -80. , -77.5, -75. , -72.5, -70. , -67.5,
           -65. , -62.5, -60. , -57.5, -55. , -52.5, -50. , -47.5, -45. , -42.5,
           -40. , -37.5, -35. , -32.5, -30. , -27.5, -25. , -22.5, -20. , -17.5,
           -15. , -12.5, -10. ,  -7.5,  -5. ,  -2.5,   0. ,   2.5,   5. ,   7.5,
            10. ,  12.5,  15. ,  17.5,  20. ,  22.5,  25. ,  27.5,  30. ,  32.5,
            35. ,  37.5,  40. ,  42.5,  45. ,  47.5,  50. ,  52.5,  55. ,  57.5,
            60. ,  62.5,  65. ,  67.5,  70. ,  72.5,  75. ,  77.5,  80. ,  82.5,
            85. ,  87.5,  90. ], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.0 2.5 5.0 ... 352.5 355.0 357.5</div><input id='attrs-28dfa62a-22fe-425f-8496-2dbedf843e93' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-28dfa62a-22fe-425f-8496-2dbedf843e93' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2562e668-7466-4307-bbc3-cd1eb0ac40df' class='xr-var-data-in' type='checkbox'><label for='data-2562e668-7466-4307-bbc3-cd1eb0ac40df' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>long_name :</span></dt><dd>Longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>axis :</span></dt><dd>X</dd></dl></div><div class='xr-var-data'><pre>array([  0. ,   2.5,   5. ,   7.5,  10. ,  12.5,  15. ,  17.5,  20. ,  22.5,
            25. ,  27.5,  30. ,  32.5,  35. ,  37.5,  40. ,  42.5,  45. ,  47.5,
            50. ,  52.5,  55. ,  57.5,  60. ,  62.5,  65. ,  67.5,  70. ,  72.5,
            75. ,  77.5,  80. ,  82.5,  85. ,  87.5,  90. ,  92.5,  95. ,  97.5,
           100. , 102.5, 105. , 107.5, 110. , 112.5, 115. , 117.5, 120. , 122.5,
           125. , 127.5, 130. , 132.5, 135. , 137.5, 140. , 142.5, 145. , 147.5,
           150. , 152.5, 155. , 157.5, 160. , 162.5, 165. , 167.5, 170. , 172.5,
           175. , 177.5, 180. , 182.5, 185. , 187.5, 190. , 192.5, 195. , 197.5,
           200. , 202.5, 205. , 207.5, 210. , 212.5, 215. , 217.5, 220. , 222.5,
           225. , 227.5, 230. , 232.5, 235. , 237.5, 240. , 242.5, 245. , 247.5,
           250. , 252.5, 255. , 257.5, 260. , 262.5, 265. , 267.5, 270. , 272.5,
           275. , 277.5, 280. , 282.5, 285. , 287.5, 290. , 292.5, 295. , 297.5,
           300. , 302.5, 305. , 307.5, 310. , 312.5, 315. , 317.5, 320. , 322.5,
           325. , 327.5, 330. , 332.5, 335. , 337.5, 340. , 342.5, 345. , 347.5,
           350. , 352.5, 355. , 357.5], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>level</span></div><div class='xr-var-dims'>(level)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>1e+03 925.0 850.0 ... 20.0 10.0</div><input id='attrs-8c1cd0bb-8d3a-479d-8cfe-315cfe5090f7' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-8c1cd0bb-8d3a-479d-8cfe-315cfe5090f7' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-fc1891de-95c4-4ed2-b474-b46945059372' class='xr-var-data-in' type='checkbox'><label for='data-fc1891de-95c4-4ed2-b474-b46945059372' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>air_pressure</dd><dt><span>long_name :</span></dt><dd>Level</dd><dt><span>units :</span></dt><dd>millibar</dd><dt><span>positive :</span></dt><dd>down</dd><dt><span>axis :</span></dt><dd>Z</dd><dt><span>actual_range :</span></dt><dd>[1000.   10.]</dd><dt><span>GRIB_id :</span></dt><dd>100</dd><dt><span>GRIB_name :</span></dt><dd>hPa</dd></dl></div><div class='xr-var-data'><pre>array([1000.,  925.,  850.,  700.,  600.,  500.,  400.,  300.,  250.,  200.,
            150.,  100.,   70.,   50.,   30.,   20.,   10.], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>time</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2022-01-04</div><input id='attrs-bb776ea4-8bae-4b42-b436-1ea36f578a89' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-bb776ea4-8bae-4b42-b436-1ea36f578a89' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b33a76bd-1bf5-427a-9695-c3a8dcc17571' class='xr-var-data-in' type='checkbox'><label for='data-b33a76bd-1bf5-427a-9695-c3a8dcc17571' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>time</dd><dt><span>long_name :</span></dt><dd>Time</dd><dt><span>axis :</span></dt><dd>T</dd></dl></div><div class='xr-var-data'><pre>array(&#x27;2022-01-04T00:00:00.000000000&#x27;, dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-65cf6c92-b8f4-490f-8964-c182b0b0d41c' class='xr-section-summary-in' type='checkbox' checked /><label for='section-65cf6c92-b8f4-490f-8964-c182b0b0d41c' class='xr-section-summary' title='Expand/collapse section'>Data variables: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>eady_growth_rate</span></div><div class='xr-var-dims'>(level, lat, lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>2.789e-06 2.696e-06 ... 1.403e-06</div><input id='attrs-c6e68632-ae83-407d-ba09-68340001a599' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-c6e68632-ae83-407d-ba09-68340001a599' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c6cbc5a0-4018-4b50-9839-9660c1891319' class='xr-var-data-in' type='checkbox'><label for='data-c6cbc5a0-4018-4b50-9839-9660c1891319' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>long_name :</span></dt><dd>Latitude</dd><dt><span>axis :</span></dt><dd>Y</dd></dl></div><div class='xr-var-data'><pre>array([[[2.78854548e-06, 2.69559248e-06, 2.78854574e-06, ...,
             2.69559399e-06, 2.69559349e-06, 2.78854675e-06],
            [1.54047710e-06, 1.12234660e-06, 1.98722261e-06, ...,
             1.18998982e-06, 1.77840667e-06, 1.43897812e-06],
            [1.50769080e-06, 2.05832681e-06, 1.84338500e-06, ...,
             1.57574140e-06, 1.80518363e-06, 1.26003628e-06],
            ...,
            [8.64499704e-06, 8.36499909e-06, 8.14148170e-06, ...,
             9.84086435e-06, 9.56738511e-06, 9.05616779e-06],
            [1.16048309e-05, 1.16579354e-05, 1.22435286e-05, ...,
             1.06290480e-05, 1.10253467e-05, 1.12421349e-05],
            [1.41202523e-05, 1.52297067e-05, 1.67425764e-05, ...,
             9.48075111e-06, 1.07919083e-05, 1.26073689e-05]],

           [[1.53639840e-07, 7.68202828e-08, 1.53640566e-07, ...,
             7.68202828e-08, 7.68202828e-08, 1.53639840e-07],
            [1.38560970e-06, 1.14103694e-06, 1.21867889e-06, ...,
             1.38680408e-06, 1.47227412e-06, 1.47206226e-06],
            [3.32708615e-07, 4.14349520e-07, 3.32509391e-07, ...,
             2.51610808e-07, 3.34202684e-07, 2.48892503e-07],
    ...
             2.05175929e-06, 2.02941006e-06, 1.95436773e-06],
            [2.35810232e-06, 2.30571964e-06, 2.25293933e-06, ...,
             2.48638168e-06, 2.44883460e-06, 2.41797931e-06],
            [3.85400451e-06, 3.79294949e-06, 3.73952898e-06, ...,
             3.94558457e-06, 3.92269023e-06, 3.88452955e-06]],

           [[1.79708937e-06, 1.84751874e-06, 1.92086885e-06, ...,
             1.58620612e-06, 1.68247905e-06, 1.76041393e-06],
            [1.58703768e-06, 1.75703674e-06, 1.89768867e-06, ...,
             1.16132103e-06, 1.29888095e-06, 1.46344013e-06],
            [1.78070320e-06, 1.95038787e-06, 2.10403794e-06, ...,
             1.46001838e-06, 1.55068068e-06, 1.66329938e-06],
            ...,
            [1.15104050e-06, 1.10122159e-06, 1.06087736e-06, ...,
             1.24023537e-06, 1.23503691e-06, 1.18565211e-06],
            [9.71296113e-08, 7.16564304e-08, 5.11579466e-09, ...,
             1.94211690e-07, 1.99391648e-07, 1.58438005e-07],
            [1.36078496e-06, 1.29773628e-06, 1.22943489e-06, ...,
             1.50789648e-06, 1.48162640e-06, 1.40281638e-06]]],
          shape=(17, 73, 144))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dudz</span></div><div class='xr-var-dims'>(level, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-0.0006436 -0.0006222 ... -0.000688</div><input id='attrs-b0c2e6c3-1c6f-47c4-a128-e7c0b30c4c13' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-b0c2e6c3-1c6f-47c4-a128-e7c0b30c4c13' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1ab6253e-2782-434a-b817-e6d3fd5cbacc' class='xr-var-data-in' type='checkbox'><label for='data-1ab6253e-2782-434a-b817-e6d3fd5cbacc' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[-6.4364128e-04, -6.2218623e-04, -6.4364134e-04, ...,
             -6.2218658e-04, -6.2218646e-04, -6.4364157e-04],
            [ 4.0348028e-04,  2.9730043e-04,  5.3055765e-04, ...,
              3.1860408e-04,  4.6698927e-04,  3.8216313e-04],
            [ 4.2007718e-04,  5.6579791e-04,  5.0293078e-04, ...,
              4.4089608e-04,  5.0398731e-04,  3.5691544e-04],
            ...,
            [-5.8718487e-03, -5.6919670e-03, -5.5592796e-03, ...,
             -6.7189275e-03, -6.5202815e-03, -6.1703580e-03],
            [-6.3787396e-03, -6.3881543e-03, -6.7020603e-03, ...,
             -5.8445898e-03, -6.0592685e-03, -6.1919531e-03],
            [-3.0850621e-03, -3.3274612e-03, -3.6580004e-03, ...,
             -2.0714011e-03, -2.3578692e-03, -2.7545199e-03]],

           [[ 4.0072093e-05,  2.0036141e-05,  4.0072282e-05, ...,
              2.0036141e-05,  2.0036141e-05,  4.0072093e-05],
            [ 3.3736843e-04,  2.7783294e-04,  2.9761894e-04, ...,
              3.3756948e-04,  3.5735557e-04,  3.5728459e-04],
            [ 7.8446770e-05,  9.8039171e-05,  7.8431294e-05, ...,
              5.8904392e-05,  7.8523735e-05,  5.8858190e-05],
    ...
             -1.0975366e-03, -1.0853023e-03, -1.0451287e-03],
            [-1.2459201e-03, -1.2179592e-03, -1.1899074e-03, ...,
             -1.3140084e-03, -1.2940477e-03, -1.2779167e-03],
            [-1.9969947e-03, -1.9653584e-03, -1.9376780e-03, ...,
             -2.0444479e-03, -2.0325850e-03, -2.0128116e-03]],

           [[-8.0539112e-04, -8.2799175e-04, -8.6086465e-04, ...,
             -7.1088079e-04, -7.5402687e-04, -7.8895449e-04],
            [-7.1155332e-04, -7.8803330e-04, -8.5193961e-04, ...,
             -5.1985920e-04, -5.8167032e-04, -6.5591960e-04],
            [-8.0745079e-04, -8.8440708e-04, -9.5521647e-04, ...,
             -6.5958989e-04, -7.0119009e-04, -7.5321400e-04],
            ...,
            [-5.9371878e-04, -5.6766369e-04, -5.4668990e-04, ...,
             -6.4077537e-04, -6.3811976e-04, -6.1205885e-04],
            [-4.9199698e-05, -3.6252070e-05, -2.5871193e-06, ...,
             -9.8431563e-05, -1.0101177e-04, -8.0284794e-05],
            [-6.6738721e-04, -6.3646544e-04, -6.0296751e-04, ...,
             -7.3953700e-04, -7.2665303e-04, -6.8800122e-04]]],
          shape=(17, 73, 144), dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>brunt_vaisala_frequency</span></div><div class='xr-var-dims'>(level, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.01043 0.01043 ... 0.02216 0.02216</div><input id='attrs-d8954267-baed-46c8-b643-8a5c07b8f4e6' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-d8954267-baed-46c8-b643-8a5c07b8f4e6' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-201e98e6-9c4b-4aba-a916-55e5b803e536' class='xr-var-data-in' type='checkbox'><label for='data-201e98e6-9c4b-4aba-a916-55e5b803e536' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>m^(1/2)</dd></dl></div><div class='xr-var-data'><pre>array([[[0.01042856, 0.01042856, 0.01042856, ..., 0.01042856,
             0.01042856, 0.01042856],
            [0.01182256, 0.01195675, 0.01205121, ..., 0.01208517,
             0.01185278, 0.01198779],
            [0.01254062, 0.01237227, 0.01227989, ..., 0.01259371,
             0.0125661 , 0.01274925],
            ...,
            [0.03057119, 0.0306266 , 0.03073388, ..., 0.03073046,
             0.03067435, 0.03066678],
            [0.02481079, 0.02473422, 0.02470849, ..., 0.02482014,
             0.0248069 , 0.02486127],
            [0.00987142, 0.00987142, 0.00987142, ..., 0.00987142,
             0.00987142, 0.00987142]],

           [[0.0117841 , 0.0117841 , 0.0117841 , ..., 0.0117841 ,
             0.0117841 , 0.0117841 ],
            [0.01099026, 0.01099078, 0.01102341, ..., 0.01098734,
             0.01095611, 0.01095551],
            [0.01061239, 0.01064964, 0.01061666, ..., 0.01053709,
             0.01057531, 0.01064382],
    ...
            [0.02405994, 0.02404572, 0.02405003, ..., 0.02407659,
             0.0240704 , 0.02406943],
            [0.0238491 , 0.02384354, 0.02384011, ..., 0.02385475,
             0.02385258, 0.02385583],
            [0.02341115, 0.02341115, 0.02341115, ..., 0.02341115,
             0.02341115, 0.02341115]],

           [[0.02024861, 0.02024861, 0.02024861, ..., 0.02024861,
             0.02024861, 0.02024861],
            [0.02023787, 0.02024456, 0.02026415, ..., 0.02020589,
             0.02021399, 0.02023113],
            [0.02040924, 0.02040955, 0.02043387, ..., 0.02033377,
             0.0203524 , 0.02038216],
            ...,
            [0.02321627, 0.02320164, 0.02319413, ..., 0.02325434,
             0.02325544, 0.02323476],
            [0.02286416, 0.02283611, 0.02282695, ..., 0.02287723,
             0.02286702, 0.02287275],
            [0.02215881, 0.02215881, 0.02215881, ..., 0.02215881,
             0.02215881, 0.02215881]]], shape=(17, 73, 144), dtype=float32)</pre></div></li></ul></div></li></ul></div></div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 95-98

Time to see our results! We create a world map and plot the Eady Growth Rate at 500 hPa (about 5.5 km altitude).

The red and yellow areas show where storms are most likely to grow rapidly - these are the "storm nurseries" of the atmosphere! The color scale uses scientific notation (like :math:`1.2 \cdot 10^{-5}`) to handle the very small numbers typical in atmospheric physics.

.. GENERATED FROM PYTHON SOURCE LINES 98-108

.. code-block:: Python

    fig, ax = ecl.plot.quick_draw_spatial_basemap(central_longitude=180)

    egr_result.eady_growth_rate.sel(level = 500).plot.contourf(
        ax = ax,
        transform = ccrs.PlateCarree(),
        cbar_kwargs = {'location': 'bottom', 'aspect': 40, 'format': formatter},
        cmap = cmaps.sunshine_9lev
    )
    ax.set_title("EGR (500hPa)")




.. image-sg:: /auto_gallery/eddy/images/sphx_glr_plot_egr_001.png
   :alt: EGR (500hPa)
   :srcset: /auto_gallery/eddy/images/sphx_glr_plot_egr_001.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    Text(0.5, 1.0, 'EGR (500hPa)')



.. GENERATED FROM PYTHON SOURCE LINES 109-112

This plot shows the vertical wind shear - how much the wind speed changes as you go higher in the atmosphere.

Think of it like this: if you're in an elevator and the wind is much stronger at the top floor than the ground floor, that's strong vertical shear! This shear provides the "fuel" for storm development.

.. GENERATED FROM PYTHON SOURCE LINES 112-121

.. code-block:: Python

    fig, ax = ecl.plot.quick_draw_spatial_basemap(central_longitude=180)

    egr_result.dudz.sel(level = 500).plot.contourf(
        ax = ax,
        transform = ccrs.PlateCarree(),
        cbar_kwargs = {'location': 'bottom', 'aspect': 40, 'format': formatter}
    )
    ax.set_title("$\\partial u / \\partial z$ (500hPa)")




.. image-sg:: /auto_gallery/eddy/images/sphx_glr_plot_egr_002.png
   :alt: $\partial u / \partial z$ (500hPa)
   :srcset: /auto_gallery/eddy/images/sphx_glr_plot_egr_002.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    Text(0.5, 1.0, '$\\partial u / \\partial z$ (500hPa)')



.. GENERATED FROM PYTHON SOURCE LINES 122-125

Finally, we plot the Brunt-V√§is√§l√§ frequency squared (:math:`N^2`), which measures how stable the atmosphere is.

High values mean the atmosphere is very stable (like a well-behaved layer cake), while low values indicate instability (like a wobbly jelly). Storms love unstable atmospheres because it's easier for air parcels to rise and form clouds!

.. GENERATED FROM PYTHON SOURCE LINES 125-134

.. code-block:: Python

    fig, ax = ecl.plot.quick_draw_spatial_basemap(central_longitude=180)

    (egr_result.brunt_vaisala_frequency **2).sel(level = 500).plot.contourf(
        ax = ax,
        transform = ccrs.PlateCarree(),
        cbar_kwargs = {'location': 'bottom', 'aspect': 40, 'format': formatter},
        cmap = cmaps.sunshine_9lev
    )
    ax.set_title("$N^2$ (500hPa)")



.. image-sg:: /auto_gallery/eddy/images/sphx_glr_plot_egr_003.png
   :alt: $N^2$ (500hPa)
   :srcset: /auto_gallery/eddy/images/sphx_glr_plot_egr_003.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    Text(0.5, 1.0, '$N^2$ (500hPa)')




.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (0 minutes 4.145 seconds)


.. _sphx_glr_download_auto_gallery_eddy_plot_egr.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: plot_egr.ipynb <plot_egr.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: plot_egr.py <plot_egr.py>`

    .. container:: sphx-glr-download sphx-glr-download-zip

      :download:`Download zipped: plot_egr.zip <plot_egr.zip>`
