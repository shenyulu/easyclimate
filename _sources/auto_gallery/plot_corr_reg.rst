
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_gallery/plot_corr_reg.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_auto_gallery_plot_corr_reg.py>`
        to download the full example code.

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_gallery_plot_corr_reg.py:


.. _corr_reg_example:

Regression and Correlation Analyses
============================================

Want to dive into the mysteries of climate science using Python?
Today, we‚Äôll walk through a piece of code to explore the impact of **El Ni√±o-Southern Oscillation (ENSO)** on global sea surface temperature (SST)!
This code is simple, beginner-friendly, and perfect for anyone curious about climate science! üòÑ Whether you‚Äôre learning data analysis or eager to uncover the secrets of climate change, this tutorial will leave you inspired and empowered! üéâ

We‚Äôll use Python‚Äôs `easyclimate` library, along with `xarray`, `matplotlib`, and `cartopy`, to step through the code, create stunning visualizations, and reveal how ENSO influences global sea temperatures! In particular, we‚Äôll dive deep into **regression analysis**, using the :py:func:`easyclimate.calc_corr_spatial <easyclimate.calc_corr_spatial>` function, and explain the math behind it! üìê Ready to get started? Let‚Äôs dive in! üöÄ


Background: What is Regression Analysis?
++++++++++++++++++++++++++++++++++++++++++++++++

Before we jump into the code, let‚Äôs talk about **regression analysis**, the core tool of this tutorial! Regression analysis is a statistical method used to study relationships between variables, particularly how a **dependent variable** (e.g., sea temperature anomalies) changes with an **independent variable** (e.g., ENSO index). üå°Ô∏è In climate science, it helps us explore how ENSO ‚Äúdrives‚Äù global sea temperatures!

> Ensure data is preprocessed, e.g., by removing the seasonal cycle to focus on non-seasonal variability.

Steps of Regression Analysis
***************************************

In regression analysis, we assume a **linear relationship** between the dependent variable :math:`y(t)` (e.g., sea temperature anomaly at a grid point) and the independent variable :math:`x(t)` (e.g., Ni√±o 3.4 index), expressed as:

.. math::

    \hat{y}(t) = a_1 x(t) + a_0

- :math:`\hat{y}(t)`: Predicted sea temperature anomaly.
- :math:`a_1`: **Regression coefficient** (slope), indicating how much :math:`y(t)` changes per unit change in :math:`x(t)`.
- :math:`a_0`: Intercept, the value of :math:`y(t)` when :math:`x(t) = 0`.

To find the optimal :math:`a_1` and :math:`a_0`, we use the **least squares method** to minimize the sum of squared errors between predicted and actual values:

.. math::

    Q = \sum_{i=1}^N \left( \hat{y}(i) - y(i) \right)^2 = \sum_{i=1}^N \left( (a_1 x(i) + a_0) - y(i) \right)^2

By taking partial derivatives with respect to :math:`a_0` and :math:`a_1` and setting them to zero, we get:

.. math::

    \frac { \mathrm{d} Q } { \mathrm{d} a _ { 0 } } \, = \, 0 \, = \, 2 \sum _ { i \, = \, 1 } ^ { N } \bigl ( a _ { 1 } x ( i ) + a _ { 0 } - y ( i ) \bigr ) \, = \, a _ { 1 } \sum _ { i \, = \, 1 } ^ { N } x ( i ) + a _ { 0 } N - \sum _ { i \, = \, 1 } ^ { N } y ( i )


.. math::

    \frac { \mathrm{d} Q } { \mathrm{d} a _ { 1 } } = \; 0 \; = \; 2 \sum _ { i \; = \; 1 } ^ { N } \left( a _ { 1 } x ( i ) + a _ { 0 } - y ( i ) \right) \cdot x ( i ) \; = \; a _ { 1 } \sum _ { i \; = \; 1 } ^ { N } x ( i ) ^ { 2 } + a _ { 0 } \sum _ { i \; = \; 1 } ^ { N } x ( i ) - \sum _ { i \; = \; 1 } ^ { N } x ( i ) y ( i )


Given :math:`\bar{x} = \frac{1}{N} \sum_{i=1}^N x(i)`, we have:

.. math::

    \bar{y} = a_1 \bar{x} + a_0

.. math::

    \overline{xy} = a_1 \overline{x^2} + a_0 \bar{x}

Solving these equations yields the slope :math:`a_1` and intercept :math:`a_0`:

.. math::

    a_1 = \frac{\overline{xy} - \bar{x}\bar{y}}{\overline{x^2} - \bar{x}^2},

.. math::

    a_0 = \bar{y} - a_1 \bar{x}

This gives us the best-fitting line using the least squares method.
Typically, :math:`a_1` is expressed in terms of deviations from the mean.
To do this, we decompose :math:`x(t)` and :math:`y(t)` into their time mean and deviations:

.. math::

    x(t) = \bar{x} + x'(t)

.. math::

    y(t) = \bar{y} + y'(t)

From this, we derive:

.. math::

    \overline{xy} = \overline{(\bar{x} + x')(\bar{y} + y')} = \bar{x}\bar{y} + \overline{x'y'}

.. math::

    \overline{x^2} = \bar{x}^2 + \overline{x'^2}

Using these and the formula for :math:`a_1`, we get:

.. math::

    a_1 = \frac{\overline{x'y'}}{\overline{x'^2}} = \frac{\text{Cov}(x, y)}{\text{Var}(x)}

- :math:`\text{Cov}(x, y)`: Covariance of :math:`x(t)` and :math:`y(t)`, measuring how they vary together.
- :math:`\text{Var}(x)`: Variance of :math:`x(t)`, measuring its own variability.
- :math:`\bar{x}`, :math:`\bar{y}`: Means of :math:`x(t)` and :math:`y(t)`.

The slope :math:`a_1` indicates the expected change in :math:`y(t)` per unit change in :math:`x(t)`.

Relationship Between Correlation and Regression Coefficients
******************************************************************************

In regression analysis, we also calculate the **correlation coefficient** :math:`r` to measure the strength of the linear relationship:

.. math::

    r = \frac{\overline{x'y'}}{\sqrt{\overline{x'^2}} \sqrt{\overline{y'^2}}}

.. math::

    r = \frac{\text{Cov}(x, y)}{\sqrt{\text{Var}(x)} \sqrt{\text{Var}(y)}}

- :math:`r` ranges from :math:`[-1, 1]`:
    - :math:`r = 1` indicates perfect positive correlation.
    - :math:`r = -1` indicates perfect negative correlation.
    - :math:`r = 0` indicates no linear relationship.
- The relationship between :math:`a_1` and :math:`r` is:

.. math::

    a_1 = r \cdot \frac{\sqrt{\text{Var}(y)}}{\sqrt{\text{Var}(x)}}

If :math:`x(t)` is standardized (mean = 0, standard deviation = 1), then :math:`\text{Var}(x) = 1`, and :math:`a_1 = r \cdot \sqrt{\text{Var}(y)}`.

Significance Testing
***************************************

To assess the reliability of the regression results, we use the :math:`t`-statistic to test the significance of the correlation coefficient:

.. math::

    t = \frac{r \sqrt{N-2}}{\sqrt{1-r^2}}

- :math:`N`: Sample size (length of the time series).
- The **p-value** is calculated from the :math:`t`-statistic. A :math:`p`-value < 0.05 (or 0.01) indicates significance at the 95% (or 99%) confidence level.

.. note::

    - Regression analysis is like finding the ‚Äúbest-fit line‚Äù to show how sea temperatures ‚Äúfollow‚Äù the ENSO index!
    - The correlation coefficient :math:`r` tells you how ‚Äúclose‚Äù the relationship is.
    - The :math:`p`-value tells you if it‚Äôs ‚Äúreal‚Äù! üòâ

Preparation: Importing Required Libraries
++++++++++++++++++++++++++++++++++++++++++++++++

.. GENERATED FROM PYTHON SOURCE LINES 153-160

.. code-block:: Python

    import easyclimate as ecl
    import xarray as xr
    import numpy as np
    import matplotlib.pyplot as plt
    import cartopy.crs as ccrs
    import cartopy.feature as cfeature








.. GENERATED FROM PYTHON SOURCE LINES 161-168

- **easyclimate**: A powerful climate analysis tool with functions like :py:func:`easyclimate.calc_corr_spatial <easyclimate.calc_corr_spatial>` to streamline data processing! üåç
- **xarray**: Ideal for handling multi-dimensional data (time, longitude, latitude).
- **numpy**: The backbone for numerical computations.
- **matplotlib.pyplot**: For plotting line graphs and maps.
- **cartopy**: A professional library for geospatial visualizations, perfect for global maps! üó∫Ô∏è

These libraries are your ‚Äúclimate lab‚Äù toolkit‚Äîlet‚Äôs start experimenting! üí™

.. GENERATED FROM PYTHON SOURCE LINES 172-182

Loading Sea Surface Temperature Data
++++++++++++++++++++++++++++++++++++++++++++++++

- ``ecl.open_tutorial_dataset("sst_mnmean_oisst")``: Loads a global sea surface temperature (SST) dataset with time, longitude, and latitude dimensions.
- ``.sst``: Extracts the sea temperature variable (units: ¬∞C).
- ``sst_data``: An :py:class:`xarray.DataArray<xarray.DataArray>`, like a 3D ‚Äúdata cube‚Äù! üßä

.. note::

    SST stands for sea surface temperature. ENSO can make some regions warmer or cooler, affecting global weather! üå¶Ô∏è

.. GENERATED FROM PYTHON SOURCE LINES 182-186

.. code-block:: Python


    sst_data = ecl.open_tutorial_dataset("sst_mnmean_oisst").sst
    sst_data





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    sst_mnmean_oisst.nc ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ 100.0% ‚Ä¢ 28.1/28.1 MB ‚Ä¢ 127.1 MB/s ‚Ä¢ 0:00:00


.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
    <defs>
    <symbol id="icon-database" viewBox="0 0 32 32">
    <path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
    <path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    <path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    </symbol>
    <symbol id="icon-file-text2" viewBox="0 0 32 32">
    <path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
    <path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    </symbol>
    </defs>
    </svg>
    <style>/* CSS stylesheet for displaying xarray objects in notebooks */

    :root {
      --xr-font-color0: var(
        --jp-content-font-color0,
        var(--pst-color-text-base rgba(0, 0, 0, 1))
      );
      --xr-font-color2: var(
        --jp-content-font-color2,
        var(--pst-color-text-base, rgba(0, 0, 0, 0.54))
      );
      --xr-font-color3: var(
        --jp-content-font-color3,
        var(--pst-color-text-base, rgba(0, 0, 0, 0.38))
      );
      --xr-border-color: var(
        --jp-border-color2,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 10))
      );
      --xr-disabled-color: var(
        --jp-layout-color3,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 40))
      );
      --xr-background-color: var(
        --jp-layout-color0,
        var(--pst-color-on-background, white)
      );
      --xr-background-color-row-even: var(
        --jp-layout-color1,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 5))
      );
      --xr-background-color-row-odd: var(
        --jp-layout-color2,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 15))
      );
    }

    html[theme="dark"],
    html[data-theme="dark"],
    body[data-theme="dark"],
    body.vscode-dark {
      --xr-font-color0: var(
        --jp-content-font-color0,
        var(--pst-color-text-base, rgba(255, 255, 255, 1))
      );
      --xr-font-color2: var(
        --jp-content-font-color2,
        var(--pst-color-text-base, rgba(255, 255, 255, 0.54))
      );
      --xr-font-color3: var(
        --jp-content-font-color3,
        var(--pst-color-text-base, rgba(255, 255, 255, 0.38))
      );
      --xr-border-color: var(
        --jp-border-color2,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))
      );
      --xr-disabled-color: var(
        --jp-layout-color3,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))
      );
      --xr-background-color: var(
        --jp-layout-color0,
        var(--pst-color-on-background, #111111)
      );
      --xr-background-color-row-even: var(
        --jp-layout-color1,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))
      );
      --xr-background-color-row-odd: var(
        --jp-layout-color2,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))
      );
    }

    .xr-wrap {
      display: block !important;
      min-width: 300px;
      max-width: 700px;
      line-height: 1.6;
    }

    .xr-text-repr-fallback {
      /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
      display: none;
    }

    .xr-header {
      padding-top: 6px;
      padding-bottom: 6px;
      margin-bottom: 4px;
      border-bottom: solid 1px var(--xr-border-color);
    }

    .xr-header > div,
    .xr-header > ul {
      display: inline;
      margin-top: 0;
      margin-bottom: 0;
    }

    .xr-obj-type,
    .xr-obj-name,
    .xr-group-name {
      margin-left: 2px;
      margin-right: 10px;
    }

    .xr-group-name::before {
      content: "üìÅ";
      padding-right: 0.3em;
    }

    .xr-group-name,
    .xr-obj-type {
      color: var(--xr-font-color2);
    }

    .xr-sections {
      padding-left: 0 !important;
      display: grid;
      grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
      margin-block-start: 0;
      margin-block-end: 0;
    }

    .xr-section-item {
      display: contents;
    }

    .xr-section-item input {
      display: inline-block;
      opacity: 0;
      height: 0;
      margin: 0;
    }

    .xr-section-item input + label {
      color: var(--xr-disabled-color);
      border: 2px solid transparent !important;
    }

    .xr-section-item input:enabled + label {
      cursor: pointer;
      color: var(--xr-font-color2);
    }

    .xr-section-item input:focus + label {
      border: 2px solid var(--xr-font-color0) !important;
    }

    .xr-section-item input:enabled + label:hover {
      color: var(--xr-font-color0);
    }

    .xr-section-summary {
      grid-column: 1;
      color: var(--xr-font-color2);
      font-weight: 500;
    }

    .xr-section-summary > span {
      display: inline-block;
      padding-left: 0.5em;
    }

    .xr-section-summary-in:disabled + label {
      color: var(--xr-font-color2);
    }

    .xr-section-summary-in + label:before {
      display: inline-block;
      content: "‚ñ∫";
      font-size: 11px;
      width: 15px;
      text-align: center;
    }

    .xr-section-summary-in:disabled + label:before {
      color: var(--xr-disabled-color);
    }

    .xr-section-summary-in:checked + label:before {
      content: "‚ñº";
    }

    .xr-section-summary-in:checked + label > span {
      display: none;
    }

    .xr-section-summary,
    .xr-section-inline-details {
      padding-top: 4px;
    }

    .xr-section-inline-details {
      grid-column: 2 / -1;
    }

    .xr-section-details {
      display: none;
      grid-column: 1 / -1;
      margin-top: 4px;
      margin-bottom: 5px;
    }

    .xr-section-summary-in:checked ~ .xr-section-details {
      display: contents;
    }

    .xr-group-box {
      display: inline-grid;
      grid-template-columns: 0px 20px auto;
      width: 100%;
    }

    .xr-group-box-vline {
      grid-column-start: 1;
      border-right: 0.2em solid;
      border-color: var(--xr-border-color);
      width: 0px;
    }

    .xr-group-box-hline {
      grid-column-start: 2;
      grid-row-start: 1;
      height: 1em;
      width: 20px;
      border-bottom: 0.2em solid;
      border-color: var(--xr-border-color);
    }

    .xr-group-box-contents {
      grid-column-start: 3;
    }

    .xr-array-wrap {
      grid-column: 1 / -1;
      display: grid;
      grid-template-columns: 20px auto;
    }

    .xr-array-wrap > label {
      grid-column: 1;
      vertical-align: top;
    }

    .xr-preview {
      color: var(--xr-font-color3);
    }

    .xr-array-preview,
    .xr-array-data {
      padding: 0 5px !important;
      grid-column: 2;
    }

    .xr-array-data,
    .xr-array-in:checked ~ .xr-array-preview {
      display: none;
    }

    .xr-array-in:checked ~ .xr-array-data,
    .xr-array-preview {
      display: inline-block;
    }

    .xr-dim-list {
      display: inline-block !important;
      list-style: none;
      padding: 0 !important;
      margin: 0;
    }

    .xr-dim-list li {
      display: inline-block;
      padding: 0;
      margin: 0;
    }

    .xr-dim-list:before {
      content: "(";
    }

    .xr-dim-list:after {
      content: ")";
    }

    .xr-dim-list li:not(:last-child):after {
      content: ",";
      padding-right: 5px;
    }

    .xr-has-index {
      font-weight: bold;
    }

    .xr-var-list,
    .xr-var-item {
      display: contents;
    }

    .xr-var-item > div,
    .xr-var-item label,
    .xr-var-item > .xr-var-name span {
      background-color: var(--xr-background-color-row-even);
      border-color: var(--xr-background-color-row-odd);
      margin-bottom: 0;
      padding-top: 2px;
    }

    .xr-var-item > .xr-var-name:hover span {
      padding-right: 5px;
    }

    .xr-var-list > li:nth-child(odd) > div,
    .xr-var-list > li:nth-child(odd) > label,
    .xr-var-list > li:nth-child(odd) > .xr-var-name span {
      background-color: var(--xr-background-color-row-odd);
      border-color: var(--xr-background-color-row-even);
    }

    .xr-var-name {
      grid-column: 1;
    }

    .xr-var-dims {
      grid-column: 2;
    }

    .xr-var-dtype {
      grid-column: 3;
      text-align: right;
      color: var(--xr-font-color2);
    }

    .xr-var-preview {
      grid-column: 4;
    }

    .xr-index-preview {
      grid-column: 2 / 5;
      color: var(--xr-font-color2);
    }

    .xr-var-name,
    .xr-var-dims,
    .xr-var-dtype,
    .xr-preview,
    .xr-attrs dt {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      padding-right: 10px;
    }

    .xr-var-name:hover,
    .xr-var-dims:hover,
    .xr-var-dtype:hover,
    .xr-attrs dt:hover {
      overflow: visible;
      width: auto;
      z-index: 1;
    }

    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      display: none;
      border-top: 2px dotted var(--xr-background-color);
      padding-bottom: 20px !important;
      padding-top: 10px !important;
    }

    .xr-var-attrs-in + label,
    .xr-var-data-in + label,
    .xr-index-data-in + label {
      padding: 0 1px;
    }

    .xr-var-attrs-in:checked ~ .xr-var-attrs,
    .xr-var-data-in:checked ~ .xr-var-data,
    .xr-index-data-in:checked ~ .xr-index-data {
      display: block;
    }

    .xr-var-data > table {
      float: right;
    }

    .xr-var-data > pre,
    .xr-index-data > pre,
    .xr-var-data > table > tbody > tr {
      background-color: transparent !important;
    }

    .xr-var-name span,
    .xr-var-data,
    .xr-index-name div,
    .xr-index-data,
    .xr-attrs {
      padding-left: 25px !important;
    }

    .xr-attrs,
    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      grid-column: 1 / -1;
    }

    dl.xr-attrs {
      padding: 0;
      margin: 0;
      display: grid;
      grid-template-columns: 125px auto;
    }

    .xr-attrs dt,
    .xr-attrs dd {
      padding: 0;
      margin: 0;
      float: left;
      padding-right: 10px;
      width: auto;
    }

    .xr-attrs dt {
      font-weight: normal;
      grid-column: 1;
    }

    .xr-attrs dt:hover span {
      display: inline-block;
      background: var(--xr-background-color);
      padding-right: 10px;
    }

    .xr-attrs dd {
      grid-column: 2;
      white-space: pre-wrap;
      word-break: break-all;
    }

    .xr-icon-database,
    .xr-icon-file-text2,
    .xr-no-icon {
      display: inline-block;
      vertical-align: middle;
      width: 1em;
      height: 1.5em !important;
      stroke-width: 0;
      stroke: currentColor;
      fill: currentColor;
    }

    .xr-var-attrs-in:checked + label > .xr-icon-file-text2,
    .xr-var-data-in:checked + label > .xr-icon-database,
    .xr-index-data-in:checked + label > .xr-icon-database {
      color: var(--xr-font-color0);
      filter: drop-shadow(1px 1px 5px var(--xr-font-color2));
      stroke-width: 0.8px;
    }
    </style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;sst&#x27; (time: 494, lat: 180, lon: 360)&gt; Size: 128MB
    [32011200 values with dtype=float32]
    Coordinates:
      * time     (time) datetime64[ns] 4kB 1981-12-01 1982-01-01 ... 2023-01-01
      * lat      (lat) float32 720B -89.5 -88.5 -87.5 -86.5 ... 86.5 87.5 88.5 89.5
      * lon      (lon) float32 1kB 0.5 1.5 2.5 3.5 4.5 ... 356.5 357.5 358.5 359.5</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-obj-name'>&#x27;sst&#x27;</div><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 494</li><li><span class='xr-has-index'>lat</span>: 180</li><li><span class='xr-has-index'>lon</span>: 360</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-96f3cb2c-bdf3-4f80-885a-63c4359475b1' class='xr-array-in' type='checkbox' checked><label for='section-96f3cb2c-bdf3-4f80-885a-63c4359475b1' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>...</span></div><div class='xr-array-data'><pre>[32011200 values with dtype=float32]</pre></div></div></li><li class='xr-section-item'><input id='section-cdc6e30c-fe4c-44e2-967e-4c7bd04fc83f' class='xr-section-summary-in' type='checkbox'  checked><label for='section-cdc6e30c-fe4c-44e2-967e-4c7bd04fc83f' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>1981-12-01 ... 2023-01-01</div><input id='attrs-efb12c15-79ea-413b-b25d-faff7fb67945' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-efb12c15-79ea-413b-b25d-faff7fb67945' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0be98dcf-6b94-4103-8083-b57a96fcc17f' class='xr-var-data-in' type='checkbox'><label for='data-0be98dcf-6b94-4103-8083-b57a96fcc17f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Time</dd><dt><span>actual_range :</span></dt><dd>[66443. 81449.]</dd><dt><span>delta_t :</span></dt><dd>0000-01-00 00:00:00</dd><dt><span>avg_period :</span></dt><dd>0000-01-00 00:00:00</dd><dt><span>prev_avg_period :</span></dt><dd>0000-00-07 00:00:00</dd><dt><span>standard_name :</span></dt><dd>time</dd><dt><span>axis :</span></dt><dd>T</dd><dt><span>bounds :</span></dt><dd>time_bnds</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;1981-12-01T00:00:00.000000000&#x27;, &#x27;1982-01-01T00:00:00.000000000&#x27;,
           &#x27;1982-02-01T00:00:00.000000000&#x27;, ..., &#x27;2022-11-01T00:00:00.000000000&#x27;,
           &#x27;2022-12-01T00:00:00.000000000&#x27;, &#x27;2023-01-01T00:00:00.000000000&#x27;],
          shape=(494,), dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-89.5 -88.5 -87.5 ... 88.5 89.5</div><input id='attrs-26d856d1-a3d0-4491-b5a5-cff6fc9c602f' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-26d856d1-a3d0-4491-b5a5-cff6fc9c602f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d11ddb6c-5411-4073-bcf0-abd6c2a24d41' class='xr-var-data-in' type='checkbox'><label for='data-d11ddb6c-5411-4073-bcf0-abd6c2a24d41' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>long_name :</span></dt><dd>Latitude</dd><dt><span>actual_range :</span></dt><dd>[ 89.5 -89.5]</dd><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>axis :</span></dt><dd>Y</dd><dt><span>coordinate_defines :</span></dt><dd>center</dd></dl></div><div class='xr-var-data'><pre>array([-89.5, -88.5, -87.5, -86.5, -85.5, -84.5, -83.5, -82.5, -81.5, -80.5,
           -79.5, -78.5, -77.5, -76.5, -75.5, -74.5, -73.5, -72.5, -71.5, -70.5,
           -69.5, -68.5, -67.5, -66.5, -65.5, -64.5, -63.5, -62.5, -61.5, -60.5,
           -59.5, -58.5, -57.5, -56.5, -55.5, -54.5, -53.5, -52.5, -51.5, -50.5,
           -49.5, -48.5, -47.5, -46.5, -45.5, -44.5, -43.5, -42.5, -41.5, -40.5,
           -39.5, -38.5, -37.5, -36.5, -35.5, -34.5, -33.5, -32.5, -31.5, -30.5,
           -29.5, -28.5, -27.5, -26.5, -25.5, -24.5, -23.5, -22.5, -21.5, -20.5,
           -19.5, -18.5, -17.5, -16.5, -15.5, -14.5, -13.5, -12.5, -11.5, -10.5,
            -9.5,  -8.5,  -7.5,  -6.5,  -5.5,  -4.5,  -3.5,  -2.5,  -1.5,  -0.5,
             0.5,   1.5,   2.5,   3.5,   4.5,   5.5,   6.5,   7.5,   8.5,   9.5,
            10.5,  11.5,  12.5,  13.5,  14.5,  15.5,  16.5,  17.5,  18.5,  19.5,
            20.5,  21.5,  22.5,  23.5,  24.5,  25.5,  26.5,  27.5,  28.5,  29.5,
            30.5,  31.5,  32.5,  33.5,  34.5,  35.5,  36.5,  37.5,  38.5,  39.5,
            40.5,  41.5,  42.5,  43.5,  44.5,  45.5,  46.5,  47.5,  48.5,  49.5,
            50.5,  51.5,  52.5,  53.5,  54.5,  55.5,  56.5,  57.5,  58.5,  59.5,
            60.5,  61.5,  62.5,  63.5,  64.5,  65.5,  66.5,  67.5,  68.5,  69.5,
            70.5,  71.5,  72.5,  73.5,  74.5,  75.5,  76.5,  77.5,  78.5,  79.5,
            80.5,  81.5,  82.5,  83.5,  84.5,  85.5,  86.5,  87.5,  88.5,  89.5],
          dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.5 1.5 2.5 ... 357.5 358.5 359.5</div><input id='attrs-3042ff81-3661-459b-813d-2c0600605102' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-3042ff81-3661-459b-813d-2c0600605102' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-df4c9630-e3c3-48c5-bd0c-f120204e3a70' class='xr-var-data-in' type='checkbox'><label for='data-df4c9630-e3c3-48c5-bd0c-f120204e3a70' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>long_name :</span></dt><dd>Longitude</dd><dt><span>actual_range :</span></dt><dd>[  0.5 359.5]</dd><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>axis :</span></dt><dd>X</dd><dt><span>coordinate_defines :</span></dt><dd>center</dd></dl></div><div class='xr-var-data'><pre>array([  0.5,   1.5,   2.5, ..., 357.5, 358.5, 359.5],
          shape=(360,), dtype=float32)</pre></div></li></ul></div></li></ul></div></div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 187-198

Removing the Seasonal Cycle to Extract Anomalies
++++++++++++++++++++++++++++++++++++++++++++++++

- :py:func:`easyclimate.remove_seasonal_cycle_mean <easyclimate.remove_seasonal_cycle_mean>`: Removes seasonal variations (e.g., warmer summers, cooler winters) to get **sea temperature anomalies**, focusing on non-seasonal signals like ENSO.
- ``sst_data_anomaly``: A new dataset containing only ‚Äúunusual‚Äù temperature changes.

.. note::

    - Removing the seasonal cycle is like filtering out ‚Äúbackground noise‚Äù to hear ENSO‚Äôs ‚Äúsolo performance‚Äù! üé∂
    - Heads up! ‚ö†Ô∏è If you don‚Äôt remove the seasonal cycle before correlation or regression analysis, most climate variables will show high correlations with distant regions‚Äîsimply because they‚Äôre all influenced by the annual solar radiation cycle! üåç‚òÄÔ∏è Pretty cool, right?


.. GENERATED FROM PYTHON SOURCE LINES 198-201

.. code-block:: Python

    sst_data_anormaly = ecl.remove_seasonal_cycle_mean(sst_data)
    sst_data_anormaly






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
    <defs>
    <symbol id="icon-database" viewBox="0 0 32 32">
    <path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
    <path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    <path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    </symbol>
    <symbol id="icon-file-text2" viewBox="0 0 32 32">
    <path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
    <path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    </symbol>
    </defs>
    </svg>
    <style>/* CSS stylesheet for displaying xarray objects in notebooks */

    :root {
      --xr-font-color0: var(
        --jp-content-font-color0,
        var(--pst-color-text-base rgba(0, 0, 0, 1))
      );
      --xr-font-color2: var(
        --jp-content-font-color2,
        var(--pst-color-text-base, rgba(0, 0, 0, 0.54))
      );
      --xr-font-color3: var(
        --jp-content-font-color3,
        var(--pst-color-text-base, rgba(0, 0, 0, 0.38))
      );
      --xr-border-color: var(
        --jp-border-color2,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 10))
      );
      --xr-disabled-color: var(
        --jp-layout-color3,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 40))
      );
      --xr-background-color: var(
        --jp-layout-color0,
        var(--pst-color-on-background, white)
      );
      --xr-background-color-row-even: var(
        --jp-layout-color1,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 5))
      );
      --xr-background-color-row-odd: var(
        --jp-layout-color2,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 15))
      );
    }

    html[theme="dark"],
    html[data-theme="dark"],
    body[data-theme="dark"],
    body.vscode-dark {
      --xr-font-color0: var(
        --jp-content-font-color0,
        var(--pst-color-text-base, rgba(255, 255, 255, 1))
      );
      --xr-font-color2: var(
        --jp-content-font-color2,
        var(--pst-color-text-base, rgba(255, 255, 255, 0.54))
      );
      --xr-font-color3: var(
        --jp-content-font-color3,
        var(--pst-color-text-base, rgba(255, 255, 255, 0.38))
      );
      --xr-border-color: var(
        --jp-border-color2,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))
      );
      --xr-disabled-color: var(
        --jp-layout-color3,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))
      );
      --xr-background-color: var(
        --jp-layout-color0,
        var(--pst-color-on-background, #111111)
      );
      --xr-background-color-row-even: var(
        --jp-layout-color1,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))
      );
      --xr-background-color-row-odd: var(
        --jp-layout-color2,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))
      );
    }

    .xr-wrap {
      display: block !important;
      min-width: 300px;
      max-width: 700px;
      line-height: 1.6;
    }

    .xr-text-repr-fallback {
      /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
      display: none;
    }

    .xr-header {
      padding-top: 6px;
      padding-bottom: 6px;
      margin-bottom: 4px;
      border-bottom: solid 1px var(--xr-border-color);
    }

    .xr-header > div,
    .xr-header > ul {
      display: inline;
      margin-top: 0;
      margin-bottom: 0;
    }

    .xr-obj-type,
    .xr-obj-name,
    .xr-group-name {
      margin-left: 2px;
      margin-right: 10px;
    }

    .xr-group-name::before {
      content: "üìÅ";
      padding-right: 0.3em;
    }

    .xr-group-name,
    .xr-obj-type {
      color: var(--xr-font-color2);
    }

    .xr-sections {
      padding-left: 0 !important;
      display: grid;
      grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
      margin-block-start: 0;
      margin-block-end: 0;
    }

    .xr-section-item {
      display: contents;
    }

    .xr-section-item input {
      display: inline-block;
      opacity: 0;
      height: 0;
      margin: 0;
    }

    .xr-section-item input + label {
      color: var(--xr-disabled-color);
      border: 2px solid transparent !important;
    }

    .xr-section-item input:enabled + label {
      cursor: pointer;
      color: var(--xr-font-color2);
    }

    .xr-section-item input:focus + label {
      border: 2px solid var(--xr-font-color0) !important;
    }

    .xr-section-item input:enabled + label:hover {
      color: var(--xr-font-color0);
    }

    .xr-section-summary {
      grid-column: 1;
      color: var(--xr-font-color2);
      font-weight: 500;
    }

    .xr-section-summary > span {
      display: inline-block;
      padding-left: 0.5em;
    }

    .xr-section-summary-in:disabled + label {
      color: var(--xr-font-color2);
    }

    .xr-section-summary-in + label:before {
      display: inline-block;
      content: "‚ñ∫";
      font-size: 11px;
      width: 15px;
      text-align: center;
    }

    .xr-section-summary-in:disabled + label:before {
      color: var(--xr-disabled-color);
    }

    .xr-section-summary-in:checked + label:before {
      content: "‚ñº";
    }

    .xr-section-summary-in:checked + label > span {
      display: none;
    }

    .xr-section-summary,
    .xr-section-inline-details {
      padding-top: 4px;
    }

    .xr-section-inline-details {
      grid-column: 2 / -1;
    }

    .xr-section-details {
      display: none;
      grid-column: 1 / -1;
      margin-top: 4px;
      margin-bottom: 5px;
    }

    .xr-section-summary-in:checked ~ .xr-section-details {
      display: contents;
    }

    .xr-group-box {
      display: inline-grid;
      grid-template-columns: 0px 20px auto;
      width: 100%;
    }

    .xr-group-box-vline {
      grid-column-start: 1;
      border-right: 0.2em solid;
      border-color: var(--xr-border-color);
      width: 0px;
    }

    .xr-group-box-hline {
      grid-column-start: 2;
      grid-row-start: 1;
      height: 1em;
      width: 20px;
      border-bottom: 0.2em solid;
      border-color: var(--xr-border-color);
    }

    .xr-group-box-contents {
      grid-column-start: 3;
    }

    .xr-array-wrap {
      grid-column: 1 / -1;
      display: grid;
      grid-template-columns: 20px auto;
    }

    .xr-array-wrap > label {
      grid-column: 1;
      vertical-align: top;
    }

    .xr-preview {
      color: var(--xr-font-color3);
    }

    .xr-array-preview,
    .xr-array-data {
      padding: 0 5px !important;
      grid-column: 2;
    }

    .xr-array-data,
    .xr-array-in:checked ~ .xr-array-preview {
      display: none;
    }

    .xr-array-in:checked ~ .xr-array-data,
    .xr-array-preview {
      display: inline-block;
    }

    .xr-dim-list {
      display: inline-block !important;
      list-style: none;
      padding: 0 !important;
      margin: 0;
    }

    .xr-dim-list li {
      display: inline-block;
      padding: 0;
      margin: 0;
    }

    .xr-dim-list:before {
      content: "(";
    }

    .xr-dim-list:after {
      content: ")";
    }

    .xr-dim-list li:not(:last-child):after {
      content: ",";
      padding-right: 5px;
    }

    .xr-has-index {
      font-weight: bold;
    }

    .xr-var-list,
    .xr-var-item {
      display: contents;
    }

    .xr-var-item > div,
    .xr-var-item label,
    .xr-var-item > .xr-var-name span {
      background-color: var(--xr-background-color-row-even);
      border-color: var(--xr-background-color-row-odd);
      margin-bottom: 0;
      padding-top: 2px;
    }

    .xr-var-item > .xr-var-name:hover span {
      padding-right: 5px;
    }

    .xr-var-list > li:nth-child(odd) > div,
    .xr-var-list > li:nth-child(odd) > label,
    .xr-var-list > li:nth-child(odd) > .xr-var-name span {
      background-color: var(--xr-background-color-row-odd);
      border-color: var(--xr-background-color-row-even);
    }

    .xr-var-name {
      grid-column: 1;
    }

    .xr-var-dims {
      grid-column: 2;
    }

    .xr-var-dtype {
      grid-column: 3;
      text-align: right;
      color: var(--xr-font-color2);
    }

    .xr-var-preview {
      grid-column: 4;
    }

    .xr-index-preview {
      grid-column: 2 / 5;
      color: var(--xr-font-color2);
    }

    .xr-var-name,
    .xr-var-dims,
    .xr-var-dtype,
    .xr-preview,
    .xr-attrs dt {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      padding-right: 10px;
    }

    .xr-var-name:hover,
    .xr-var-dims:hover,
    .xr-var-dtype:hover,
    .xr-attrs dt:hover {
      overflow: visible;
      width: auto;
      z-index: 1;
    }

    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      display: none;
      border-top: 2px dotted var(--xr-background-color);
      padding-bottom: 20px !important;
      padding-top: 10px !important;
    }

    .xr-var-attrs-in + label,
    .xr-var-data-in + label,
    .xr-index-data-in + label {
      padding: 0 1px;
    }

    .xr-var-attrs-in:checked ~ .xr-var-attrs,
    .xr-var-data-in:checked ~ .xr-var-data,
    .xr-index-data-in:checked ~ .xr-index-data {
      display: block;
    }

    .xr-var-data > table {
      float: right;
    }

    .xr-var-data > pre,
    .xr-index-data > pre,
    .xr-var-data > table > tbody > tr {
      background-color: transparent !important;
    }

    .xr-var-name span,
    .xr-var-data,
    .xr-index-name div,
    .xr-index-data,
    .xr-attrs {
      padding-left: 25px !important;
    }

    .xr-attrs,
    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      grid-column: 1 / -1;
    }

    dl.xr-attrs {
      padding: 0;
      margin: 0;
      display: grid;
      grid-template-columns: 125px auto;
    }

    .xr-attrs dt,
    .xr-attrs dd {
      padding: 0;
      margin: 0;
      float: left;
      padding-right: 10px;
      width: auto;
    }

    .xr-attrs dt {
      font-weight: normal;
      grid-column: 1;
    }

    .xr-attrs dt:hover span {
      display: inline-block;
      background: var(--xr-background-color);
      padding-right: 10px;
    }

    .xr-attrs dd {
      grid-column: 2;
      white-space: pre-wrap;
      word-break: break-all;
    }

    .xr-icon-database,
    .xr-icon-file-text2,
    .xr-no-icon {
      display: inline-block;
      vertical-align: middle;
      width: 1em;
      height: 1.5em !important;
      stroke-width: 0;
      stroke: currentColor;
      fill: currentColor;
    }

    .xr-var-attrs-in:checked + label > .xr-icon-file-text2,
    .xr-var-data-in:checked + label > .xr-icon-database,
    .xr-index-data-in:checked + label > .xr-icon-database {
      color: var(--xr-font-color0);
      filter: drop-shadow(1px 1px 5px var(--xr-font-color2));
      stroke-width: 0.8px;
    }
    </style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;sst&#x27; (time: 494, lat: 180, lon: 360)&gt; Size: 128MB
    array([[[ 0.        ,  0.        ,  0.        , ...,  0.        ,
              0.        ,  0.        ],
            [ 0.        ,  0.        ,  0.        , ...,  0.        ,
              0.        ,  0.        ],
            [ 0.        ,  0.        ,  0.        , ...,  0.        ,
              0.        ,  0.        ],
            ...,
            [ 0.01261902,  0.01166666,  0.01071429, ...,  0.00833333,
              0.00833333,  0.00809526],
            [ 0.        ,  0.        ,  0.        , ...,  0.        ,
              0.        ,  0.        ],
            [ 0.        ,  0.        ,  0.        , ...,  0.        ,
              0.        ,  0.        ]],

           [[ 0.        ,  0.        ,  0.        , ...,  0.        ,
              0.        ,  0.        ],
            [ 0.        ,  0.        ,  0.        , ...,  0.        ,
              0.        ,  0.        ],
            [ 0.        ,  0.        ,  0.        , ...,  0.        ,
              0.        ,  0.        ],
    ...
            [-0.00738096, -0.00833333, -0.00928569, ..., -0.00166667,
             -0.00166667, -0.00190473],
            [ 0.        ,  0.        ,  0.        , ...,  0.        ,
              0.        ,  0.        ],
            [ 0.        ,  0.        ,  0.        , ...,  0.        ,
              0.        ,  0.        ]],

           [[ 0.        ,  0.        ,  0.        , ...,  0.        ,
              0.        ,  0.        ],
            [ 0.        ,  0.        ,  0.        , ...,  0.        ,
              0.        ,  0.        ],
            [ 0.        ,  0.        ,  0.        , ...,  0.        ,
              0.        ,  0.        ],
            ...,
            [-0.0064286 , -0.00904763, -0.00952375, ..., -0.0007143 ,
             -0.0007143 , -0.00095236],
            [ 0.        ,  0.        ,  0.        , ...,  0.        ,
              0.        ,  0.        ],
            [ 0.        ,  0.        ,  0.        , ...,  0.        ,
              0.        ,  0.        ]]], shape=(494, 180, 360), dtype=float32)
    Coordinates:
      * time     (time) datetime64[ns] 4kB 1981-12-01 1982-01-01 ... 2023-01-01
      * lat      (lat) float32 720B -89.5 -88.5 -87.5 -86.5 ... 86.5 87.5 88.5 89.5
      * lon      (lon) float32 1kB 0.5 1.5 2.5 3.5 4.5 ... 356.5 357.5 358.5 359.5
        month    (time) int64 4kB 12 1 2 3 4 5 6 7 8 9 10 ... 4 5 6 7 8 9 10 11 12 1</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-obj-name'>&#x27;sst&#x27;</div><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 494</li><li><span class='xr-has-index'>lat</span>: 180</li><li><span class='xr-has-index'>lon</span>: 360</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-0b6685b7-e434-4570-942e-47266c7de7b5' class='xr-array-in' type='checkbox' checked><label for='section-0b6685b7-e434-4570-942e-47266c7de7b5' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 ... 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0</span></div><div class='xr-array-data'><pre>array([[[ 0.        ,  0.        ,  0.        , ...,  0.        ,
              0.        ,  0.        ],
            [ 0.        ,  0.        ,  0.        , ...,  0.        ,
              0.        ,  0.        ],
            [ 0.        ,  0.        ,  0.        , ...,  0.        ,
              0.        ,  0.        ],
            ...,
            [ 0.01261902,  0.01166666,  0.01071429, ...,  0.00833333,
              0.00833333,  0.00809526],
            [ 0.        ,  0.        ,  0.        , ...,  0.        ,
              0.        ,  0.        ],
            [ 0.        ,  0.        ,  0.        , ...,  0.        ,
              0.        ,  0.        ]],

           [[ 0.        ,  0.        ,  0.        , ...,  0.        ,
              0.        ,  0.        ],
            [ 0.        ,  0.        ,  0.        , ...,  0.        ,
              0.        ,  0.        ],
            [ 0.        ,  0.        ,  0.        , ...,  0.        ,
              0.        ,  0.        ],
    ...
            [-0.00738096, -0.00833333, -0.00928569, ..., -0.00166667,
             -0.00166667, -0.00190473],
            [ 0.        ,  0.        ,  0.        , ...,  0.        ,
              0.        ,  0.        ],
            [ 0.        ,  0.        ,  0.        , ...,  0.        ,
              0.        ,  0.        ]],

           [[ 0.        ,  0.        ,  0.        , ...,  0.        ,
              0.        ,  0.        ],
            [ 0.        ,  0.        ,  0.        , ...,  0.        ,
              0.        ,  0.        ],
            [ 0.        ,  0.        ,  0.        , ...,  0.        ,
              0.        ,  0.        ],
            ...,
            [-0.0064286 , -0.00904763, -0.00952375, ..., -0.0007143 ,
             -0.0007143 , -0.00095236],
            [ 0.        ,  0.        ,  0.        , ...,  0.        ,
              0.        ,  0.        ],
            [ 0.        ,  0.        ,  0.        , ...,  0.        ,
              0.        ,  0.        ]]], shape=(494, 180, 360), dtype=float32)</pre></div></div></li><li class='xr-section-item'><input id='section-536dbc4b-9fcb-43a1-83e3-833a228a31af' class='xr-section-summary-in' type='checkbox'  checked><label for='section-536dbc4b-9fcb-43a1-83e3-833a228a31af' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>1981-12-01 ... 2023-01-01</div><input id='attrs-15148ede-df05-48a7-852e-bbb7796230e9' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-15148ede-df05-48a7-852e-bbb7796230e9' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-908b8f0d-f0f1-4e91-a072-3191169edd4d' class='xr-var-data-in' type='checkbox'><label for='data-908b8f0d-f0f1-4e91-a072-3191169edd4d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Time</dd><dt><span>actual_range :</span></dt><dd>[66443. 81449.]</dd><dt><span>delta_t :</span></dt><dd>0000-01-00 00:00:00</dd><dt><span>avg_period :</span></dt><dd>0000-01-00 00:00:00</dd><dt><span>prev_avg_period :</span></dt><dd>0000-00-07 00:00:00</dd><dt><span>standard_name :</span></dt><dd>time</dd><dt><span>axis :</span></dt><dd>T</dd><dt><span>bounds :</span></dt><dd>time_bnds</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;1981-12-01T00:00:00.000000000&#x27;, &#x27;1982-01-01T00:00:00.000000000&#x27;,
           &#x27;1982-02-01T00:00:00.000000000&#x27;, ..., &#x27;2022-11-01T00:00:00.000000000&#x27;,
           &#x27;2022-12-01T00:00:00.000000000&#x27;, &#x27;2023-01-01T00:00:00.000000000&#x27;],
          shape=(494,), dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-89.5 -88.5 -87.5 ... 88.5 89.5</div><input id='attrs-0cad869a-5ccb-4f51-a02e-847a98520afe' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-0cad869a-5ccb-4f51-a02e-847a98520afe' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-52061e4a-18a0-4658-9546-e28f76a9810d' class='xr-var-data-in' type='checkbox'><label for='data-52061e4a-18a0-4658-9546-e28f76a9810d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>long_name :</span></dt><dd>Latitude</dd><dt><span>actual_range :</span></dt><dd>[ 89.5 -89.5]</dd><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>axis :</span></dt><dd>Y</dd><dt><span>coordinate_defines :</span></dt><dd>center</dd></dl></div><div class='xr-var-data'><pre>array([-89.5, -88.5, -87.5, -86.5, -85.5, -84.5, -83.5, -82.5, -81.5, -80.5,
           -79.5, -78.5, -77.5, -76.5, -75.5, -74.5, -73.5, -72.5, -71.5, -70.5,
           -69.5, -68.5, -67.5, -66.5, -65.5, -64.5, -63.5, -62.5, -61.5, -60.5,
           -59.5, -58.5, -57.5, -56.5, -55.5, -54.5, -53.5, -52.5, -51.5, -50.5,
           -49.5, -48.5, -47.5, -46.5, -45.5, -44.5, -43.5, -42.5, -41.5, -40.5,
           -39.5, -38.5, -37.5, -36.5, -35.5, -34.5, -33.5, -32.5, -31.5, -30.5,
           -29.5, -28.5, -27.5, -26.5, -25.5, -24.5, -23.5, -22.5, -21.5, -20.5,
           -19.5, -18.5, -17.5, -16.5, -15.5, -14.5, -13.5, -12.5, -11.5, -10.5,
            -9.5,  -8.5,  -7.5,  -6.5,  -5.5,  -4.5,  -3.5,  -2.5,  -1.5,  -0.5,
             0.5,   1.5,   2.5,   3.5,   4.5,   5.5,   6.5,   7.5,   8.5,   9.5,
            10.5,  11.5,  12.5,  13.5,  14.5,  15.5,  16.5,  17.5,  18.5,  19.5,
            20.5,  21.5,  22.5,  23.5,  24.5,  25.5,  26.5,  27.5,  28.5,  29.5,
            30.5,  31.5,  32.5,  33.5,  34.5,  35.5,  36.5,  37.5,  38.5,  39.5,
            40.5,  41.5,  42.5,  43.5,  44.5,  45.5,  46.5,  47.5,  48.5,  49.5,
            50.5,  51.5,  52.5,  53.5,  54.5,  55.5,  56.5,  57.5,  58.5,  59.5,
            60.5,  61.5,  62.5,  63.5,  64.5,  65.5,  66.5,  67.5,  68.5,  69.5,
            70.5,  71.5,  72.5,  73.5,  74.5,  75.5,  76.5,  77.5,  78.5,  79.5,
            80.5,  81.5,  82.5,  83.5,  84.5,  85.5,  86.5,  87.5,  88.5,  89.5],
          dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.5 1.5 2.5 ... 357.5 358.5 359.5</div><input id='attrs-44fe2dfa-d40a-43c4-9114-ba69c29d0c60' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-44fe2dfa-d40a-43c4-9114-ba69c29d0c60' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a1b132ea-2088-4bd8-b8c5-5a207528bfbc' class='xr-var-data-in' type='checkbox'><label for='data-a1b132ea-2088-4bd8-b8c5-5a207528bfbc' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>long_name :</span></dt><dd>Longitude</dd><dt><span>actual_range :</span></dt><dd>[  0.5 359.5]</dd><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>axis :</span></dt><dd>X</dd><dt><span>coordinate_defines :</span></dt><dd>center</dd></dl></div><div class='xr-var-data'><pre>array([  0.5,   1.5,   2.5, ..., 357.5, 358.5, 359.5],
          shape=(360,), dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>month</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>12 1 2 3 4 5 6 ... 7 8 9 10 11 12 1</div><input id='attrs-04aa53ad-39f3-4d0c-856a-9ceb5a725811' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-04aa53ad-39f3-4d0c-856a-9ceb5a725811' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-fdd3b318-85a8-45c6-9e72-8375fbefab7a' class='xr-var-data-in' type='checkbox'><label for='data-fdd3b318-85a8-45c6-9e72-8375fbefab7a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Time</dd><dt><span>actual_range :</span></dt><dd>[66443. 81449.]</dd><dt><span>delta_t :</span></dt><dd>0000-01-00 00:00:00</dd><dt><span>avg_period :</span></dt><dd>0000-01-00 00:00:00</dd><dt><span>prev_avg_period :</span></dt><dd>0000-00-07 00:00:00</dd><dt><span>standard_name :</span></dt><dd>time</dd><dt><span>axis :</span></dt><dd>T</dd><dt><span>bounds :</span></dt><dd>time_bnds</dd></dl></div><div class='xr-var-data'><pre>array([12,  1,  2, ..., 11, 12,  1], shape=(494,))</pre></div></li></ul></div></li></ul></div></div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 202-219

Calculating the Ni√±o 3.4 Index
++++++++++++++++++++++++++++++++++++++++++++++++

1. Calculating the Ni√±o 3.4 Index:

   - :py:func:`easyclimate.field.air_sea_interaction.calc_index_nino34 <easyclimate.field.air_sea_interaction.calc_index_nino34>`: Computes the Ni√±o 3.4 index from sea temperature anomalies in the eastern tropical Pacific (5¬∞S‚Äì5¬∞N, 170¬∞W‚Äì120¬∞W), measuring ENSO strength.
   - ``running_mean = 0``: Uses raw data without smoothing.

2. Plotting the Line Graph:

   - ``plt.figure(figsize=(10, 3))``: Creates a canvas 10 units wide and 3 units high.
   - :py:func:`easyclimate.plot.line_plot_with_threshold <easyclimate.plot.line_plot_with_threshold>`: Plots the Ni√±o 3.4 index time series.
   - :py:func:`plt.title <matplotlib.pyplot.title>`: Sets the title to ‚ÄúNi√±o 3.4 index‚Äù.

.. note::

    The Ni√±o 3.4 index is like a ‚Äúweather gauge‚Äù for ENSO‚Äîpositive values indicate El Ni√±o (warm), and negative values indicate La Ni√±a (cool). üìà

.. GENERATED FROM PYTHON SOURCE LINES 219-229

.. code-block:: Python


    nino34_index = ecl.field.air_sea_interaction.calc_index_nino34(
        sst_data,
        running_mean = 0
    )

    plt.figure(figsize=(10, 3))
    ecl.plot.line_plot_with_threshold(nino34_index)
    plt.title("Ni√±o 3.4 index")




.. image-sg:: /auto_gallery/images/sphx_glr_plot_corr_reg_001.png
   :alt: Ni√±o 3.4 index
   :srcset: /auto_gallery/images/sphx_glr_plot_corr_reg_001.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    /home/runner/work/easyclimate/easyclimate/src/easyclimate/core/utility.py:843: UserWarning: It seems that the input data longitude range is not from -180¬∞ to 180¬∞. Please carefully check your data.
      warnings.warn(

    Text(0.5, 1.0, 'Ni√±o 3.4 index')



.. GENERATED FROM PYTHON SOURCE LINES 230-235

Standardizing the Ni√±o 3.4 Index
++++++++++++++++++++++++++++++++++++++++++++++++

For the next steps, if we perform linear regression between the SST anomaly time series :math:`y(t)` at each global grid point and the standardized ENSO index :math:`x(t)`, we calculate the regression coefficient :math:`a_1`:


.. GENERATED FROM PYTHON SOURCE LINES 237-240

.. math::

    a_1 = \frac{\text{Cov} (x,y)}{\text{Var}(x)}

.. GENERATED FROM PYTHON SOURCE LINES 242-256

Since :math:`x(t)` is standardized, :math:`\mathrm{Var}(x) = 1`, so :math:`a_1` directly reflects the covariance, with units of :math:`\frac{\text{ K (local SST change) }}{ \sigma \text{(ENSO index)} } = \mathrm{K}`.

- :py:func:`easyclimate.normalized.normalize_zscore <easyclimate.normalized.normalize_zscore>`: Standardizes the Ni√±o 3.4 index (mean = 0, standard deviation = 1) using:

.. math::

    z = \frac{x - \bar{x}}{\sqrt{\mathrm{Var}(x)}}

- Plots the standardized time series with the title ‚ÄúNormalized Ni√±o 3.4 index‚Äù.

.. note::

    Standardization puts the index in ‚Äústandard units,‚Äù making it easier to compare and use in regression analysis! üìè


.. GENERATED FROM PYTHON SOURCE LINES 256-263

.. code-block:: Python


    nino34_index_normalized = ecl.normalized.normalize_zscore(nino34_index)

    plt.figure(figsize=(10, 3))
    ecl.plot.line_plot_with_threshold(nino34_index_normalized)
    plt.title("Normalized Ni√±o 3.4 index")




.. image-sg:: /auto_gallery/images/sphx_glr_plot_corr_reg_002.png
   :alt: Normalized Ni√±o 3.4 index
   :srcset: /auto_gallery/images/sphx_glr_plot_corr_reg_002.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    Text(0.5, 1.0, 'Normalized Ni√±o 3.4 index')



.. GENERATED FROM PYTHON SOURCE LINES 264-277

Calculating Correlation Between SST Anomalies and Ni√±o 3.4 Index
++++++++++++++++++++++++++++++++++++++++++++++++

- ``ecl.calc_corr_spatial``: Performs regression analysis between global SST anomalies (`sst_data_anomaly`) and the standardized Ni√±o 3.4 index (`nino34_index_normalized`).
- Output: ``sst_reg_nino34_result``, containing:

  - ``reg_coeff``: Regression coefficient, in units of ¬∞C per standard deviation of the index.
  - ``corr``: Correlation coefficient, ranging from :math:`[-1, 1]`.
  - ``pvalue``: Significance p-value.

.. note::

    This step is like giving global sea temperatures a ‚Äúcheck-up‚Äù to see which regions are closely tied to ENSO! üîç

.. GENERATED FROM PYTHON SOURCE LINES 277-283

.. code-block:: Python

    sst_reg_nino34_result = ecl.calc_corr_spatial(
        sst_data_anormaly,
        x = nino34_index_normalized
    )
    sst_reg_nino34_result






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
    <defs>
    <symbol id="icon-database" viewBox="0 0 32 32">
    <path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
    <path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    <path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    </symbol>
    <symbol id="icon-file-text2" viewBox="0 0 32 32">
    <path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
    <path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    </symbol>
    </defs>
    </svg>
    <style>/* CSS stylesheet for displaying xarray objects in notebooks */

    :root {
      --xr-font-color0: var(
        --jp-content-font-color0,
        var(--pst-color-text-base rgba(0, 0, 0, 1))
      );
      --xr-font-color2: var(
        --jp-content-font-color2,
        var(--pst-color-text-base, rgba(0, 0, 0, 0.54))
      );
      --xr-font-color3: var(
        --jp-content-font-color3,
        var(--pst-color-text-base, rgba(0, 0, 0, 0.38))
      );
      --xr-border-color: var(
        --jp-border-color2,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 10))
      );
      --xr-disabled-color: var(
        --jp-layout-color3,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 40))
      );
      --xr-background-color: var(
        --jp-layout-color0,
        var(--pst-color-on-background, white)
      );
      --xr-background-color-row-even: var(
        --jp-layout-color1,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 5))
      );
      --xr-background-color-row-odd: var(
        --jp-layout-color2,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 15))
      );
    }

    html[theme="dark"],
    html[data-theme="dark"],
    body[data-theme="dark"],
    body.vscode-dark {
      --xr-font-color0: var(
        --jp-content-font-color0,
        var(--pst-color-text-base, rgba(255, 255, 255, 1))
      );
      --xr-font-color2: var(
        --jp-content-font-color2,
        var(--pst-color-text-base, rgba(255, 255, 255, 0.54))
      );
      --xr-font-color3: var(
        --jp-content-font-color3,
        var(--pst-color-text-base, rgba(255, 255, 255, 0.38))
      );
      --xr-border-color: var(
        --jp-border-color2,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))
      );
      --xr-disabled-color: var(
        --jp-layout-color3,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))
      );
      --xr-background-color: var(
        --jp-layout-color0,
        var(--pst-color-on-background, #111111)
      );
      --xr-background-color-row-even: var(
        --jp-layout-color1,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))
      );
      --xr-background-color-row-odd: var(
        --jp-layout-color2,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))
      );
    }

    .xr-wrap {
      display: block !important;
      min-width: 300px;
      max-width: 700px;
      line-height: 1.6;
    }

    .xr-text-repr-fallback {
      /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
      display: none;
    }

    .xr-header {
      padding-top: 6px;
      padding-bottom: 6px;
      margin-bottom: 4px;
      border-bottom: solid 1px var(--xr-border-color);
    }

    .xr-header > div,
    .xr-header > ul {
      display: inline;
      margin-top: 0;
      margin-bottom: 0;
    }

    .xr-obj-type,
    .xr-obj-name,
    .xr-group-name {
      margin-left: 2px;
      margin-right: 10px;
    }

    .xr-group-name::before {
      content: "üìÅ";
      padding-right: 0.3em;
    }

    .xr-group-name,
    .xr-obj-type {
      color: var(--xr-font-color2);
    }

    .xr-sections {
      padding-left: 0 !important;
      display: grid;
      grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
      margin-block-start: 0;
      margin-block-end: 0;
    }

    .xr-section-item {
      display: contents;
    }

    .xr-section-item input {
      display: inline-block;
      opacity: 0;
      height: 0;
      margin: 0;
    }

    .xr-section-item input + label {
      color: var(--xr-disabled-color);
      border: 2px solid transparent !important;
    }

    .xr-section-item input:enabled + label {
      cursor: pointer;
      color: var(--xr-font-color2);
    }

    .xr-section-item input:focus + label {
      border: 2px solid var(--xr-font-color0) !important;
    }

    .xr-section-item input:enabled + label:hover {
      color: var(--xr-font-color0);
    }

    .xr-section-summary {
      grid-column: 1;
      color: var(--xr-font-color2);
      font-weight: 500;
    }

    .xr-section-summary > span {
      display: inline-block;
      padding-left: 0.5em;
    }

    .xr-section-summary-in:disabled + label {
      color: var(--xr-font-color2);
    }

    .xr-section-summary-in + label:before {
      display: inline-block;
      content: "‚ñ∫";
      font-size: 11px;
      width: 15px;
      text-align: center;
    }

    .xr-section-summary-in:disabled + label:before {
      color: var(--xr-disabled-color);
    }

    .xr-section-summary-in:checked + label:before {
      content: "‚ñº";
    }

    .xr-section-summary-in:checked + label > span {
      display: none;
    }

    .xr-section-summary,
    .xr-section-inline-details {
      padding-top: 4px;
    }

    .xr-section-inline-details {
      grid-column: 2 / -1;
    }

    .xr-section-details {
      display: none;
      grid-column: 1 / -1;
      margin-top: 4px;
      margin-bottom: 5px;
    }

    .xr-section-summary-in:checked ~ .xr-section-details {
      display: contents;
    }

    .xr-group-box {
      display: inline-grid;
      grid-template-columns: 0px 20px auto;
      width: 100%;
    }

    .xr-group-box-vline {
      grid-column-start: 1;
      border-right: 0.2em solid;
      border-color: var(--xr-border-color);
      width: 0px;
    }

    .xr-group-box-hline {
      grid-column-start: 2;
      grid-row-start: 1;
      height: 1em;
      width: 20px;
      border-bottom: 0.2em solid;
      border-color: var(--xr-border-color);
    }

    .xr-group-box-contents {
      grid-column-start: 3;
    }

    .xr-array-wrap {
      grid-column: 1 / -1;
      display: grid;
      grid-template-columns: 20px auto;
    }

    .xr-array-wrap > label {
      grid-column: 1;
      vertical-align: top;
    }

    .xr-preview {
      color: var(--xr-font-color3);
    }

    .xr-array-preview,
    .xr-array-data {
      padding: 0 5px !important;
      grid-column: 2;
    }

    .xr-array-data,
    .xr-array-in:checked ~ .xr-array-preview {
      display: none;
    }

    .xr-array-in:checked ~ .xr-array-data,
    .xr-array-preview {
      display: inline-block;
    }

    .xr-dim-list {
      display: inline-block !important;
      list-style: none;
      padding: 0 !important;
      margin: 0;
    }

    .xr-dim-list li {
      display: inline-block;
      padding: 0;
      margin: 0;
    }

    .xr-dim-list:before {
      content: "(";
    }

    .xr-dim-list:after {
      content: ")";
    }

    .xr-dim-list li:not(:last-child):after {
      content: ",";
      padding-right: 5px;
    }

    .xr-has-index {
      font-weight: bold;
    }

    .xr-var-list,
    .xr-var-item {
      display: contents;
    }

    .xr-var-item > div,
    .xr-var-item label,
    .xr-var-item > .xr-var-name span {
      background-color: var(--xr-background-color-row-even);
      border-color: var(--xr-background-color-row-odd);
      margin-bottom: 0;
      padding-top: 2px;
    }

    .xr-var-item > .xr-var-name:hover span {
      padding-right: 5px;
    }

    .xr-var-list > li:nth-child(odd) > div,
    .xr-var-list > li:nth-child(odd) > label,
    .xr-var-list > li:nth-child(odd) > .xr-var-name span {
      background-color: var(--xr-background-color-row-odd);
      border-color: var(--xr-background-color-row-even);
    }

    .xr-var-name {
      grid-column: 1;
    }

    .xr-var-dims {
      grid-column: 2;
    }

    .xr-var-dtype {
      grid-column: 3;
      text-align: right;
      color: var(--xr-font-color2);
    }

    .xr-var-preview {
      grid-column: 4;
    }

    .xr-index-preview {
      grid-column: 2 / 5;
      color: var(--xr-font-color2);
    }

    .xr-var-name,
    .xr-var-dims,
    .xr-var-dtype,
    .xr-preview,
    .xr-attrs dt {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      padding-right: 10px;
    }

    .xr-var-name:hover,
    .xr-var-dims:hover,
    .xr-var-dtype:hover,
    .xr-attrs dt:hover {
      overflow: visible;
      width: auto;
      z-index: 1;
    }

    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      display: none;
      border-top: 2px dotted var(--xr-background-color);
      padding-bottom: 20px !important;
      padding-top: 10px !important;
    }

    .xr-var-attrs-in + label,
    .xr-var-data-in + label,
    .xr-index-data-in + label {
      padding: 0 1px;
    }

    .xr-var-attrs-in:checked ~ .xr-var-attrs,
    .xr-var-data-in:checked ~ .xr-var-data,
    .xr-index-data-in:checked ~ .xr-index-data {
      display: block;
    }

    .xr-var-data > table {
      float: right;
    }

    .xr-var-data > pre,
    .xr-index-data > pre,
    .xr-var-data > table > tbody > tr {
      background-color: transparent !important;
    }

    .xr-var-name span,
    .xr-var-data,
    .xr-index-name div,
    .xr-index-data,
    .xr-attrs {
      padding-left: 25px !important;
    }

    .xr-attrs,
    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      grid-column: 1 / -1;
    }

    dl.xr-attrs {
      padding: 0;
      margin: 0;
      display: grid;
      grid-template-columns: 125px auto;
    }

    .xr-attrs dt,
    .xr-attrs dd {
      padding: 0;
      margin: 0;
      float: left;
      padding-right: 10px;
      width: auto;
    }

    .xr-attrs dt {
      font-weight: normal;
      grid-column: 1;
    }

    .xr-attrs dt:hover span {
      display: inline-block;
      background: var(--xr-background-color);
      padding-right: 10px;
    }

    .xr-attrs dd {
      grid-column: 2;
      white-space: pre-wrap;
      word-break: break-all;
    }

    .xr-icon-database,
    .xr-icon-file-text2,
    .xr-no-icon {
      display: inline-block;
      vertical-align: middle;
      width: 1em;
      height: 1.5em !important;
      stroke-width: 0;
      stroke: currentColor;
      fill: currentColor;
    }

    .xr-var-attrs-in:checked + label > .xr-icon-file-text2,
    .xr-var-data-in:checked + label > .xr-icon-database,
    .xr-index-data-in:checked + label > .xr-icon-database {
      color: var(--xr-font-color0);
      filter: drop-shadow(1px 1px 5px var(--xr-font-color2));
      stroke-width: 0.8px;
    }
    </style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 1MB
    Dimensions:    (lat: 180, lon: 360)
    Coordinates:
      * lat        (lat) float32 720B -89.5 -88.5 -87.5 -86.5 ... 87.5 88.5 89.5
      * lon        (lon) float32 1kB 0.5 1.5 2.5 3.5 4.5 ... 356.5 357.5 358.5 359.5
    Data variables:
        reg_coeff  (lat, lon) float64 518kB 0.0 0.0 0.0 0.0 0.0 ... 0.0 0.0 0.0 0.0
        corr       (lat, lon) float32 259kB nan nan nan nan nan ... nan nan nan nan
        pvalue     (lat, lon) float64 518kB nan nan nan nan nan ... nan nan nan nan</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-ed4c30a2-47dd-4f5a-a198-4bde5f3c2076' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-ed4c30a2-47dd-4f5a-a198-4bde5f3c2076' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>lat</span>: 180</li><li><span class='xr-has-index'>lon</span>: 360</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-08c75f52-d1ef-4592-b2ea-f619f5872183' class='xr-section-summary-in' type='checkbox'  checked><label for='section-08c75f52-d1ef-4592-b2ea-f619f5872183' class='xr-section-summary' >Coordinates: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-89.5 -88.5 -87.5 ... 88.5 89.5</div><input id='attrs-b9806272-e4f4-4c0d-8335-ffc25050e908' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-b9806272-e4f4-4c0d-8335-ffc25050e908' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1ff184e5-5e5b-4b73-b103-5700f0268f21' class='xr-var-data-in' type='checkbox'><label for='data-1ff184e5-5e5b-4b73-b103-5700f0268f21' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>long_name :</span></dt><dd>Latitude</dd><dt><span>actual_range :</span></dt><dd>[ 89.5 -89.5]</dd><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>axis :</span></dt><dd>Y</dd><dt><span>coordinate_defines :</span></dt><dd>center</dd></dl></div><div class='xr-var-data'><pre>array([-89.5, -88.5, -87.5, -86.5, -85.5, -84.5, -83.5, -82.5, -81.5, -80.5,
           -79.5, -78.5, -77.5, -76.5, -75.5, -74.5, -73.5, -72.5, -71.5, -70.5,
           -69.5, -68.5, -67.5, -66.5, -65.5, -64.5, -63.5, -62.5, -61.5, -60.5,
           -59.5, -58.5, -57.5, -56.5, -55.5, -54.5, -53.5, -52.5, -51.5, -50.5,
           -49.5, -48.5, -47.5, -46.5, -45.5, -44.5, -43.5, -42.5, -41.5, -40.5,
           -39.5, -38.5, -37.5, -36.5, -35.5, -34.5, -33.5, -32.5, -31.5, -30.5,
           -29.5, -28.5, -27.5, -26.5, -25.5, -24.5, -23.5, -22.5, -21.5, -20.5,
           -19.5, -18.5, -17.5, -16.5, -15.5, -14.5, -13.5, -12.5, -11.5, -10.5,
            -9.5,  -8.5,  -7.5,  -6.5,  -5.5,  -4.5,  -3.5,  -2.5,  -1.5,  -0.5,
             0.5,   1.5,   2.5,   3.5,   4.5,   5.5,   6.5,   7.5,   8.5,   9.5,
            10.5,  11.5,  12.5,  13.5,  14.5,  15.5,  16.5,  17.5,  18.5,  19.5,
            20.5,  21.5,  22.5,  23.5,  24.5,  25.5,  26.5,  27.5,  28.5,  29.5,
            30.5,  31.5,  32.5,  33.5,  34.5,  35.5,  36.5,  37.5,  38.5,  39.5,
            40.5,  41.5,  42.5,  43.5,  44.5,  45.5,  46.5,  47.5,  48.5,  49.5,
            50.5,  51.5,  52.5,  53.5,  54.5,  55.5,  56.5,  57.5,  58.5,  59.5,
            60.5,  61.5,  62.5,  63.5,  64.5,  65.5,  66.5,  67.5,  68.5,  69.5,
            70.5,  71.5,  72.5,  73.5,  74.5,  75.5,  76.5,  77.5,  78.5,  79.5,
            80.5,  81.5,  82.5,  83.5,  84.5,  85.5,  86.5,  87.5,  88.5,  89.5],
          dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.5 1.5 2.5 ... 357.5 358.5 359.5</div><input id='attrs-19262c9b-bfec-4882-8b84-6860a1abe6a9' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-19262c9b-bfec-4882-8b84-6860a1abe6a9' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d638d565-71cf-4889-9311-0fdee3a41fbf' class='xr-var-data-in' type='checkbox'><label for='data-d638d565-71cf-4889-9311-0fdee3a41fbf' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>long_name :</span></dt><dd>Longitude</dd><dt><span>actual_range :</span></dt><dd>[  0.5 359.5]</dd><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>axis :</span></dt><dd>X</dd><dt><span>coordinate_defines :</span></dt><dd>center</dd></dl></div><div class='xr-var-data'><pre>array([  0.5,   1.5,   2.5, ..., 357.5, 358.5, 359.5],
          shape=(360,), dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-47d854d3-a7fd-4d1f-8949-66f0ba90790b' class='xr-section-summary-in' type='checkbox'  checked><label for='section-47d854d3-a7fd-4d1f-8949-66f0ba90790b' class='xr-section-summary' >Data variables: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>reg_coeff</span></div><div class='xr-var-dims'>(lat, lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 0.0 0.0 0.0 ... 0.0 0.0 0.0 0.0</div><input id='attrs-eb4cdaed-e35f-4bed-9eb5-78b329d72b1a' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-eb4cdaed-e35f-4bed-9eb5-78b329d72b1a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-60626666-63da-4eb8-8636-1af4a1a83f78' class='xr-var-data-in' type='checkbox'><label for='data-60626666-63da-4eb8-8636-1af4a1a83f78' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[0.        , 0.        , 0.        , ..., 0.        , 0.        ,
            0.        ],
           [0.        , 0.        , 0.        , ..., 0.        , 0.        ,
            0.        ],
           [0.        , 0.        , 0.        , ..., 0.        , 0.        ,
            0.        ],
           ...,
           [0.0008169 , 0.00103835, 0.00101341, ..., 0.00098493, 0.00105047,
            0.00116883],
           [0.        , 0.        , 0.        , ..., 0.        , 0.        ,
            0.        ],
           [0.        , 0.        , 0.        , ..., 0.        , 0.        ,
            0.        ]], shape=(180, 360))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>corr</span></div><div class='xr-var-dims'>(lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>nan nan nan nan ... nan nan nan nan</div><input id='attrs-479ef3c7-6b95-4db9-86e9-07aa6f9a5309' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-479ef3c7-6b95-4db9-86e9-07aa6f9a5309' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a460612e-48a1-4bcd-a8e6-254ffee3c339' class='xr-var-data-in' type='checkbox'><label for='data-a460612e-48a1-4bcd-a8e6-254ffee3c339' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[       nan,        nan,        nan, ...,        nan,        nan,
                   nan],
           [       nan,        nan,        nan, ...,        nan,        nan,
                   nan],
           [       nan,        nan,        nan, ...,        nan,        nan,
                   nan],
           ...,
           [0.01964271, 0.02484176, 0.02426423, ..., 0.0231114 , 0.02459968,
            0.0277905 ],
           [       nan,        nan,        nan, ...,        nan,        nan,
                   nan],
           [       nan,        nan,        nan, ...,        nan,        nan,
                   nan]], shape=(180, 360), dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>pvalue</span></div><div class='xr-var-dims'>(lat, lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>nan nan nan nan ... nan nan nan nan</div><input id='attrs-d6d7fdf4-b1a3-4566-8d98-1848692d4c56' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-d6d7fdf4-b1a3-4566-8d98-1848692d4c56' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-fbc8af4a-e200-46f8-a749-7e018c541e02' class='xr-var-data-in' type='checkbox'><label for='data-fbc8af4a-e200-46f8-a749-7e018c541e02' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[       nan,        nan,        nan, ...,        nan,        nan,
                   nan],
           [       nan,        nan,        nan, ...,        nan,        nan,
                   nan],
           [       nan,        nan,        nan, ...,        nan,        nan,
                   nan],
           ...,
           [0.66318708, 0.58175568, 0.59056838, ..., 0.60834051, 0.58544222,
            0.53774334],
           [       nan,        nan,        nan, ...,        nan,        nan,
                   nan],
           [       nan,        nan,        nan, ...,        nan,        nan,
                   nan]], shape=(180, 360))</pre></div></li></ul></div></li></ul></div></div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 284-293

Regression Coefficient Map
++++++++++++++++++++++++++++++++++++++++++++++++

- **Base Map**: ``quick_draw_spatial_basemap`` creates a global map centered at 205¬∞ longitude.
- **Regression Coefficient Plot**: ``reg_coeff.plot.contourf`` visualizes the amplitude of SST changes (¬∞C) per standard deviation change in the Ni√±o 3.4 index.
- **Significance Markers**: ``draw_significant_area_contourf`` highlights areas with :math:`p < 0.01`.
- **Land**: Adds gray landmasses, with the title indicating regression results.

The map shows the global SST anomaly regressed onto the standardized ENSO index, displayed as a spatial distribution of SST anomalies in units of K.

.. GENERATED FROM PYTHON SOURCE LINES 293-312

.. code-block:: Python

    fig, ax = ecl.plot.quick_draw_spatial_basemap(central_longitude=205)

    sst_reg_nino34_result.reg_coeff.plot.contourf(
        ax = ax,
        levels = np.linspace(-1.5, 1.5, 21),
        transform = ccrs.PlateCarree(),
        cbar_kwargs={"location": "bottom", "aspect": 30, "label": "‚ÑÉ"},
    )

    ecl.plot.draw_significant_area_contourf(
        sst_reg_nino34_result.pvalue,
        thresh = 0.01,
        ax = ax,
        transform = ccrs.PlateCarree(),
    )

    ax.add_feature(cfeature.LAND, facecolor = '#DDDDDD', zorder = 1)
    ax.set_title("Ni√±o 3.4 index Reg SST anormaly")




.. image-sg:: /auto_gallery/images/sphx_glr_plot_corr_reg_003.png
   :alt: Ni√±o 3.4 index Reg SST anormaly
   :srcset: /auto_gallery/images/sphx_glr_plot_corr_reg_003.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    Text(0.5, 1.0, 'Ni√±o 3.4 index Reg SST anormaly')



.. GENERATED FROM PYTHON SOURCE LINES 313-344

- In the eastern tropical Pacific (20¬∞N‚Äì20¬∞S, 160¬∞E to South American coast), a one-standard-deviation increase in the ENSO warm phase (or cold tongue) index corresponds to significant positive SST anomalies, exceeding 1 K in the eastern tropical Pacific.
- In the western tropical Pacific, SST anomalies are near 0 K, indicating minimal ENSO influence.
- In the North Pacific, the ENSO warm phase corresponds to negative SST anomalies of about -0.2 K, indicating cooler temperatures.
- The regression coefficients largely reflect the spatial pattern of global SST changes during the ENSO warm phase.
- The regression coefficients show the magnitude of change but do not indicate statistical significance. Significance can be assessed by plotting confidence levels (e.g., 95%).

.. note::

    - Linear Assumption

      Regression analysis is a **linear** method üìà. In the example above, the cold phase of the ENSO cycle (La Ni√±a) is assumed to exhibit a pattern exactly opposite to the anomalies shown in the regression results. It‚Äôs like playing a ‚Äúmirror symmetry‚Äù game!

      To capture more complex **non-linear** relationships ü§π‚Äç‚ôÇÔ∏è between ENSO and global SST anomalies, scientists often perform **composite analysis** (i.e., averaging separately for warm (El Ni√±o) and cold (La Ni√±a) events) to reveal their distinct characteristics.

    - Causality

      Regression analysis only reveals statistical associations, not causation üîó ‚â† üß™.

      In the example, North Atlantic SST anomalies may be a remote ‚Äúresponse‚Äù or ‚Äúresult‚Äù of tropical climate anomalies, as determined by numerical simulations. However, regression results alone cannot determine cause and effect‚Äîinterpret with caution! ‚ö†Ô∏è

    - Effective Sample Size

      The significance of correlations depends on the ‚Äúeffective sample size‚Äù üß†, which is almost always smaller than the number of data points used in the analysis.

      For example üå∞: A 50-year record of monthly mean Atlantic basin SST anomalies might seem to have :math:`50 \\cdot 12 = 600` time points, but due to the strong ‚Äúmemory‚Äù (persistence) of regionally averaged SSTs, the number of truly independent samples may be much smaller!

      So, when interpreting correlations based on limited sample sizes, stay cautious and critical‚Äînumbers can be deceptive! üïµÔ∏è‚Äç‚ôÄÔ∏è

.. note::

    This map shows where sea temperatures rise (red) or fall (blue) when ENSO ‚Äúacts up‚Äù! üå°Ô∏è

.. GENERATED FROM PYTHON SOURCE LINES 347-356

Correlation Coefficient Map
++++++++++++++++++++++++++++++++++++++++++++++++

- Similar to above, but plots the **correlation coefficient** map, showing the strength of the relationship between SST and the ENSO index (-1 to 1).
- Title changed to ‚Äúcorr Ni√±o 3.4 index & SST anomaly‚Äù.

.. note::

    This map highlights the ‚Äúconnection strength‚Äù between ENSO and sea temperatures‚Äîred means they ‚Äúmove together,‚Äù blue means they ‚Äúmove opposite‚Äù! üòé

.. GENERATED FROM PYTHON SOURCE LINES 356-375

.. code-block:: Python

    fig, ax = ecl.plot.quick_draw_spatial_basemap(central_longitude=205)

    sst_reg_nino34_result.corr.plot.contourf(
        ax = ax,
        levels = np.linspace(-1, 1, 11),
        transform = ccrs.PlateCarree(),
        cbar_kwargs={"location": "bottom", "aspect": 30, "label": ""},
    )

    ecl.plot.draw_significant_area_contourf(
        sst_reg_nino34_result.pvalue,
        thresh = 0.01,
        ax = ax,
        transform = ccrs.PlateCarree(),
    )

    ax.add_feature(cfeature.LAND, facecolor = '#DDDDDD', zorder = 1)
    ax.set_title("corr Ni√±o 3.4 index & SST anormaly")




.. image-sg:: /auto_gallery/images/sphx_glr_plot_corr_reg_004.png
   :alt: corr Ni√±o 3.4 index & SST anormaly
   :srcset: /auto_gallery/images/sphx_glr_plot_corr_reg_004.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    Text(0.5, 1.0, 'corr Ni√±o 3.4 index & SST anormaly')



.. GENERATED FROM PYTHON SOURCE LINES 376-400

Summary: What Did We Learn?
++++++++++++++++++++++++++++++++++++++++++++++++

Through this code, we embarked on a climate science adventure! üåç We:

1. Loaded and preprocessed SST data to extract anomalies.
2. Calculated and standardized the Ni√±o 3.4 index, plotting its time series.
3. Used :py:func:`easyclimate.calc_corr_spatial <easyclimate.calc_corr_spatial>` to analyze the relationship between global SSTs and ENSO, obtaining regression coefficients, correlation coefficients, and p-values.
4. Created two maps showing the amplitude and strength of ENSO‚Äôs impact on SSTs.

Pro Tips
***************************************

- The regression coefficient :math:`a_1` shows the ‚Äúactual impact‚Äù of ENSO changes on SST anomalies (¬∞C), while the correlation coefficient :math:`r` shows the ‚Äústrength of the connection.‚Äù
- :py:func:`easyclimate.calc_corr_spatial <easyclimate.calc_corr_spatial>` efficiently handles multi-dimensional data, automatically skipping NaN values, making it ideal for large-scale climate analysis.
- Areas with :math:`p < 0.01/0.05` are ‚Äúrock-solid‚Äù results worth focusing on! üî•

Beginner Tips
***************************************

- ENSO is like the ocean‚Äôs ‚Äúmood,‚Äù affecting global climate, and this code helps you ‚Äúhear‚Äù its story! üòâ
- Want to go deeper? Check the `easyclimate` documentation or try other climate indices!

Run the code and explore the wonders of climate science! üöÄ


.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (0 minutes 17.000 seconds)


.. _sphx_glr_download_auto_gallery_plot_corr_reg.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: plot_corr_reg.ipynb <plot_corr_reg.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: plot_corr_reg.py <plot_corr_reg.py>`

    .. container:: sphx-glr-download sphx-glr-download-zip

      :download:`Download zipped: plot_corr_reg.zip <plot_corr_reg.zip>`
