
<!DOCTYPE html>


<html lang="en" data-content_root="../../../../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>easyclimate.core.diff &#8212; easyclimate v2026.2.0 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../../../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../../../../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../../../../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../../../../_static/tabs.css?v=4c969af8" />
    <link rel="stylesheet" type="text/css" href="../../../../../_static/graphviz.css?v=4ae1632d" />
    <link rel="stylesheet" type="text/css" href="../../../../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../../../../_static/sg_gallery.css?v=d2d258e8" />
    <link rel="stylesheet" type="text/css" href="../../../../../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../../../../../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../../../../../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <link rel="stylesheet" type="text/css" href="../../../../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../../../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../../../../_static/documentation_options.js?v=6e6efcf0"></script>
    <script src="../../../../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../../../_static/tabs.js?v=3ee01567"></script>
    <script src="../../../../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../../../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../../../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script src="../../../../../_static/design-tabs.js?v=f930bc37"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'technical/api/easyclimate/core/diff/index';</script>
    <link rel="index" title="Index" href="../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
    <meta name="docbuild:last-update" content="2026-01-30"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../../../../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../../../../_static/easyclimate_logo_mini.png" class="logo__image only-light" alt="easyclimate v2026.2.0 documentation - Home"/>
    <script>document.write(`<img src="../../../../../_static/easyclimate_logo_mini.png" class="logo__image only-dark" alt="easyclimate v2026.2.0 documentation - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../../../overview.html">What is Easy Climate</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../install.html">Installation Guide</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../../../auto_gallery/index.html">Gallery</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../../auto_gallery/plot_monsoon_npwi.html">Onset and Retreat of Monsoon</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../auto_gallery/plot_corr_reg.html">Regression and Correlation Analyses</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../auto_gallery/plot_formatting_coordinates.html">Formatting Coordinates</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../auto_gallery/plot_wet_bulk.html">Wet-bulb Temperature</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../auto_gallery/plot_aerobulk.html">Estimate Turbulent Air-sea Fluxes</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../../../auto_gallery/basic/index.html">Bases for Atmospheric Science</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../../auto_gallery/basic/plot_time_scale_average.html">Time Scale Average</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../auto_gallery/basic/plot_co_coeff.html">Coriolis Coefficient with Latitude</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../auto_gallery/basic/plot_multi_linear_reg.html">Multiple Variable Linear Regression</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../auto_gallery/basic/plot_taylor_diagram.html">Taylor Diagram</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../auto_gallery/basic/plot_geographic_finite_difference.html">Geographic Finite Difference</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../auto_gallery/basic/plot_basic_statistical_analysis.html">Basic Statistical Analysis</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../../../auto_gallery/eddy/index.html">Transient Eddy</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../../auto_gallery/eddy/plot_egr.html">Maximum Eady Growth Rate</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../auto_gallery/eddy/plot_waf.html">Wave Activity Horizontal Flux</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../../../auto_gallery/filter/index.html">Filter and Smooth</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../../auto_gallery/filter/plot_wavelet.html">Wavelets</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../auto_gallery/filter/plot_smooth_daily_cycle.html">Smooth Mean Daily Annual Cycle</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../auto_gallery/filter/plot_wk_spectra.html">Wheeler-Kiladis Space-Time Spectra</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../auto_gallery/filter/plot_barnes_filter.html">Barnes Filter</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../auto_gallery/filter/plot_emd.html">Empirical Mode Decomposition (EMD) and Ensemble Empirical Mode Decomposition (EEMD)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../auto_gallery/filter/plot_redfit.html">Estimate Red-noise Spectrum</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../auto_gallery/filter/plot_spatial_pcf.html">2D Spatial Parabolic Cylinder Function</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../auto_gallery/filter/plot_multieof.html">EOF Analysis of Multiple Variables</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../auto_gallery/filter/plot_kf_filter.html">KF Filter and Hovm√∂ller Diagram</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../auto_gallery/filter/plot_basic_eof.html">Empirical Orthogonal Function (EOF) and Maximum Covariance Analysis (MCA)</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../../../auto_gallery/interp/index.html">Interpolation and Regridding</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../../auto_gallery/interp/plot_interp_mesh2point.html">Interpolate grid data to station data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../auto_gallery/interp/plot_interp.html">Interpolation and Regriding</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../../../auto_gallery/ocean/index.html">Ocean</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../../auto_gallery/ocean/plot_ocean_stability.html">Ocean Instability</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../auto_gallery/ocean/plot_thermal_layer.html">Thermocline Depth and 20¬∞C Isotherm Depth</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../auto_gallery/ocean/plot_ocean_mix_layer.html">Ocean Surface Mixed Layers Analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../auto_gallery/ocean/plot_oceanic_front.html">Oceanic Front</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../../../auto_gallery/oscillation/index.html">Oscillation</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../../auto_gallery/oscillation/plot_mjo_phase.html">MJO Phase Space Trajectory Diagram</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../auto_gallery/oscillation/plot_ao_index.html">Arctic Oscillation (AO) Index</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../auto_gallery/oscillation/plot_da_bbo.html">Arctic Dipole Anomaly (DA/AD) and Barents-Beaufort Oscillation (BBO)</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../../../auto_gallery/satellite/index.html">Satellite</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../../auto_gallery/satellite/plot_satellite_data_analysis.html">Satellite Data Analysis</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../../../auto_gallery/typhoon/index.html">Typhoon</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../../auto_gallery/typhoon/plot_tcpv.html">Potential Intensity for Typhoon</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../auto_gallery/typhoon/plot_tc_track_axis.html">Typhoon Tracking and Axisymmetric Analysis</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../../../auto_gallery/wrf/index.html">WRF data post-processing</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../../auto_gallery/wrf/plot_wrf_tutorial.html">Build-in WRF-python</a></li>
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Plotting</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../../../auto_gallery/plot_formatting_coordinates.html">Formatting Coordinates</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Meteorology Field</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../../../static_docs/air_sea_interaction.html">Air‚Äìsea Interactions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../static_docs/teleconnections.html">Teleconnections</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../static_docs/ocean.html">Ocean</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../static_docs/monsoon.html">Monsoon</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../static_docs/land.html">Land</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../static_docs/typhoons.html">Typhoons</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Reference documentation</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../../../api_index/index.html">List of Functions and Classes (API)</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../../api_index/generated/easyclimate.core.datanode.html">easyclimate.core.datanode</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../api_index/generated/easyclimate.core.units.html">easyclimate.core.units</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../api_index/generated/easyclimate.core.diff.html">easyclimate.core.diff</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../api_index/generated/easyclimate.core.eddy.html">easyclimate.core.eddy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../api_index/generated/easyclimate.core.eof.html">easyclimate.core.eof</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../api_index/generated/easyclimate.core.extract.html">easyclimate.core.extract</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../api_index/generated/easyclimate.core.mk_test.html">easyclimate.core.mk_test</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../api_index/generated/easyclimate.core.normalized.html">easyclimate.core.normalized</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../api_index/generated/easyclimate.core.read.html">easyclimate.core.read</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../api_index/generated/easyclimate.core.tutorial.html">easyclimate.core.tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../api_index/generated/easyclimate.core.utility.html">easyclimate.core.utility</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../api_index/generated/easyclimate.core.variability.html">easyclimate.core.variability</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../api_index/generated/easyclimate.core.spharm.html">easyclimate.core.spharm</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../api_index/generated/easyclimate.core.windspharm.html">easyclimate.core.windspharm</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../api_index/generated/easyclimate.core.stat.html">easyclimate.core.stat</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../api_index/generated/easyclimate.core.stats.detrend_spatial.html">easyclimate.core.stats.detrend_spatial</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../api_index/generated/easyclimate.core.stats.yearstat.html">easyclimate.core.stats.yearstat</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../api_index/generated/easyclimate.core.stats.monthstat.html">easyclimate.core.stats.monthstat</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../api_index/generated/easyclimate.core.stats.seasonstat.html">easyclimate.core.stats.seasonstat</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../api_index/generated/easyclimate.physics.geo.coriolis.html">easyclimate.physics.geo.coriolis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../api_index/generated/easyclimate.physics.geo.linrood_latwgt.html">easyclimate.physics.geo.linrood_latwgt</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../api_index/generated/easyclimate.physics.dry.html">easyclimate.physics.dry</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../api_index/generated/easyclimate.physics.moisture.dewpoint.html">easyclimate.physics.moisture.dewpoint</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../api_index/generated/easyclimate.physics.moisture.lapse_rate.html">easyclimate.physics.moisture.lapse_rate</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../api_index/generated/easyclimate.physics.moisture.mix.html">easyclimate.physics.moisture.mix</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../api_index/generated/easyclimate.physics.moisture.vapor_pressure.html">easyclimate.physics.moisture.vapor_pressure</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../api_index/generated/easyclimate.physics.moisture.wet_bulb.html">easyclimate.physics.moisture.wet_bulb</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../api_index/generated/easyclimate.physics.temperature.equivalent_potential_temperature.html">easyclimate.physics.temperature.equivalent_potential_temperature</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../api_index/generated/easyclimate.physics.temperature.potential_temperature.html">easyclimate.physics.temperature.potential_temperature</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../api_index/generated/easyclimate.physics.temperature.virtual_temperature.html">easyclimate.physics.temperature.virtual_temperature</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../api_index/generated/easyclimate.physics.condensation.lcl.html">easyclimate.physics.condensation.lcl</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../api_index/generated/easyclimate.physics.convection.stability.html">easyclimate.physics.convection.stability</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../api_index/generated/easyclimate.physics.energy.angmom_atm.html">easyclimate.physics.energy.angmom_atm</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../api_index/generated/easyclimate.physics.energy.enthalpy.html">easyclimate.physics.energy.enthalpy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../api_index/generated/easyclimate.physics.energy.latent_heat_water.html">easyclimate.physics.energy.latent_heat_water</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../api_index/generated/easyclimate.physics.transfer.html">easyclimate.physics.transfer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../api_index/generated/easyclimate.filter.butter_filter.html">easyclimate.filter.butter_filter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../api_index/generated/easyclimate.filter.lanczos_filter.html">easyclimate.filter.lanczos_filter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../api_index/generated/easyclimate.filter.kf_filter.html">easyclimate.filter.kf_filter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../api_index/generated/easyclimate.filter.barnes_filter.html">easyclimate.filter.barnes_filter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../api_index/generated/easyclimate.filter.gaussian_filter.html">easyclimate.filter.gaussian_filter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../api_index/generated/easyclimate.filter.smooth.html">easyclimate.filter.smooth</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../api_index/generated/easyclimate.filter.wavelet.html">easyclimate.filter.wavelet</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../api_index/generated/easyclimate.filter.redfit.html">easyclimate.filter.redfit</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../api_index/generated/easyclimate.filter.spatial_pcf.html">easyclimate.filter.spatial_pcf</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../api_index/generated/easyclimate.filter.emd.html">easyclimate.filter.emd</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../api_index/generated/easyclimate.filter.spectrum.html">easyclimate.filter.spectrum</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../api_index/generated/easyclimate.interp.barnes.html">easyclimate.interp.barnes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../api_index/generated/easyclimate.interp.mesh2mesh.html">easyclimate.interp.mesh2mesh</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../api_index/generated/easyclimate.interp.mesh2point.html">easyclimate.interp.mesh2point</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../api_index/generated/easyclimate.interp.interp1d_vertical_model2pressure.html">easyclimate.interp.interp1d_vertical_model2pressure</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../api_index/generated/easyclimate.interp.interp1d_vertical_pressure2altitude.html">easyclimate.interp.interp1d_vertical_pressure2altitude</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../api_index/generated/easyclimate.interp.vinth2p.html">easyclimate.interp.vinth2p</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../api_index/generated/easyclimate.plot.axisticker.html">easyclimate.plot.axisticker</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../api_index/generated/easyclimate.plot.projection.html">easyclimate.plot.projection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../api_index/generated/easyclimate.plot.significance_plot.html">easyclimate.plot.significance_plot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../api_index/generated/easyclimate.plot.taylor_diagram.html">easyclimate.plot.taylor_diagram</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../api_index/generated/easyclimate.plot.quick_draw.html">easyclimate.plot.quick_draw</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../api_index/generated/easyclimate.plot.curved_quiver_plot.html">easyclimate.plot.curved_quiver_plot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../api_index/generated/easyclimate.plot.bar.html">easyclimate.plot.bar</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../api_index/generated/easyclimate.plot.line.html">easyclimate.plot.line</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../api_index/generated/easyclimate.wrf.interface.html">easyclimate.wrf.interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../api_index/generated/easyclimate.field.air_sea_interaction.index_enso.html">easyclimate.field.air_sea_interaction.index_enso</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../api_index/generated/easyclimate.field.air_sea_interaction.index_iod.html">easyclimate.field.air_sea_interaction.index_iod</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../api_index/generated/easyclimate.field.air_sea_interaction.index_iobm.html">easyclimate.field.air_sea_interaction.index_iobm</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../api_index/generated/easyclimate.field.air_sea_interaction.index_amm.html">easyclimate.field.air_sea_interaction.index_amm</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../api_index/generated/easyclimate.field.air_sea_interaction.index_atlantic_nino.html">easyclimate.field.air_sea_interaction.index_atlantic_nino</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../api_index/generated/easyclimate.field.air_sea_interaction.index_pdo.html">easyclimate.field.air_sea_interaction.index_pdo</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../api_index/generated/easyclimate.field.teleconnection.index_pna.html">easyclimate.field.teleconnection.index_pna</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../api_index/generated/easyclimate.field.teleconnection.index_nao.html">easyclimate.field.teleconnection.index_nao</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../api_index/generated/easyclimate.field.teleconnection.index_ea.html">easyclimate.field.teleconnection.index_ea</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../api_index/generated/easyclimate.field.teleconnection.index_wa.html">easyclimate.field.teleconnection.index_wa</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../api_index/generated/easyclimate.field.teleconnection.index_wp.html">easyclimate.field.teleconnection.index_wp</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../api_index/generated/easyclimate.field.teleconnection.index_eu.html">easyclimate.field.teleconnection.index_eu</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../api_index/generated/easyclimate.field.teleconnection.index_srp.html">easyclimate.field.teleconnection.index_srp</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../api_index/generated/easyclimate.field.teleconnection.index_cgt.html">easyclimate.field.teleconnection.index_cgt</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../api_index/generated/easyclimate.field.teleconnection.index_ao_nam.html">easyclimate.field.teleconnection.index_ao_nam</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../api_index/generated/easyclimate.field.teleconnection.index_da.html">easyclimate.field.teleconnection.index_da</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../api_index/generated/easyclimate.field.teleconnection.index_bbo.html">easyclimate.field.teleconnection.index_bbo</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../api_index/generated/easyclimate.field.land.html">easyclimate.field.land</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../api_index/generated/easyclimate.field.monsoon.index_npwi.html">easyclimate.field.monsoon.index_npwi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../api_index/generated/easyclimate.field.monsoon.bsiso.html">easyclimate.field.monsoon.bsiso</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../api_index/generated/easyclimate.field.ocean.mixlayer.html">easyclimate.field.ocean.mixlayer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../api_index/generated/easyclimate.field.ocean.oceanic_front.html">easyclimate.field.ocean.oceanic_front</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../api_index/generated/easyclimate.field.ocean.stability.html">easyclimate.field.ocean.stability</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../api_index/generated/easyclimate.field.ocean.thermal.html">easyclimate.field.ocean.thermal</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../api_index/generated/easyclimate.field.typhoon.potential_intensity.html">easyclimate.field.typhoon.potential_intensity</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../api_index/generated/easyclimate.field.typhoon.track.html">easyclimate.field.typhoon.track</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../api_index/generated/easyclimate.field.typhoon.axisymmetric.html">easyclimate.field.typhoon.axisymmetric</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../api_index/generated/easyclimate.field.equatorial_wave.mjo.html">easyclimate.field.equatorial_wave.mjo</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../api_index/generated/easyclimate.field.equatorial_wave.wk_spectra.html">easyclimate.field.equatorial_wave.wk_spectra</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../api_index/generated/easyclimate.field.satellite.image.html">easyclimate.field.satellite.image</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../api_index/generated/easyclimate.field.heat_stress.humanindexmod_2020.html">easyclimate.field.heat_stress.humanindexmod_2020</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../api_index/generated/easyclimate.field.boundary_layer.aerobulk.html">easyclimate.field.boundary_layer.aerobulk</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../changes.html">Changelog‚ôªÔ∏è</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../static_docs/cite.html">Citing Easy Climateüìí</a></li>
<li class="toctree-l1"><a class="reference external" href="https://easyclimate-backend.readthedocs.io/en/latest/src/softlist.html">Open Source Licenses</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Community</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../../../contributing.html">Contributing to easyclimateü§º</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/shenyulu/easyclimate/blob/main/CONTRIBUTING.md">How to Contribute</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/shenyulu/easyclimate">Source Code on GitHub</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../sponsor.html">Sponsor This Project‚ù§Ô∏è</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/shenyulu/easyclimate" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/shenyulu/easyclimate/issues/new?title=Issue%20on%20page%20%2Ftechnical/api/easyclimate/core/diff/index.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../../../../_sources/technical/api/easyclimate/core/diff/index.rst" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.rst</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>easyclimate.core.diff</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#functions">Functions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-contents">Module Contents</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#easyclimate.core.diff.calc_gradient"><code class="docutils literal notranslate"><span class="pre">calc_gradient()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#easyclimate.core.diff.calc_dx_gradient"><code class="docutils literal notranslate"><span class="pre">calc_dx_gradient()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#easyclimate.core.diff.calc_dlon_radian_gradient"><code class="docutils literal notranslate"><span class="pre">calc_dlon_radian_gradient()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#easyclimate.core.diff.calc_dlon_degree_gradient"><code class="docutils literal notranslate"><span class="pre">calc_dlon_degree_gradient()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#easyclimate.core.diff.calc_dy_gradient"><code class="docutils literal notranslate"><span class="pre">calc_dy_gradient()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#easyclimate.core.diff.calc_dlat_radian_gradient"><code class="docutils literal notranslate"><span class="pre">calc_dlat_radian_gradient()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#easyclimate.core.diff.calc_dlat_degree_gradient"><code class="docutils literal notranslate"><span class="pre">calc_dlat_degree_gradient()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#easyclimate.core.diff.calc_dx_laplacian"><code class="docutils literal notranslate"><span class="pre">calc_dx_laplacian()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#easyclimate.core.diff.calc_dy_laplacian"><code class="docutils literal notranslate"><span class="pre">calc_dy_laplacian()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#easyclimate.core.diff.calc_dxdy_mixed_derivatives"><code class="docutils literal notranslate"><span class="pre">calc_dxdy_mixed_derivatives()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#easyclimate.core.diff.calc_p_gradient"><code class="docutils literal notranslate"><span class="pre">calc_p_gradient()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#easyclimate.core.diff.calc_time_gradient"><code class="docutils literal notranslate"><span class="pre">calc_time_gradient()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#easyclimate.core.diff.calc_delta_pressure"><code class="docutils literal notranslate"><span class="pre">calc_delta_pressure()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#easyclimate.core.diff.calc_p_integral"><code class="docutils literal notranslate"><span class="pre">calc_p_integral()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#easyclimate.core.diff.calc_top2surface_integral"><code class="docutils literal notranslate"><span class="pre">calc_top2surface_integral()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#easyclimate.core.diff.calc_dxdy_laplacian"><code class="docutils literal notranslate"><span class="pre">calc_dxdy_laplacian()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#easyclimate.core.diff.calc_divergence"><code class="docutils literal notranslate"><span class="pre">calc_divergence()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#easyclimate.core.diff.calc_vorticity"><code class="docutils literal notranslate"><span class="pre">calc_vorticity()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#easyclimate.core.diff.calc_geostrophic_wind"><code class="docutils literal notranslate"><span class="pre">calc_geostrophic_wind()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#easyclimate.core.diff.calc_geostrophic_wind_vorticity"><code class="docutils literal notranslate"><span class="pre">calc_geostrophic_wind_vorticity()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#easyclimate.core.diff.calc_horizontal_water_flux"><code class="docutils literal notranslate"><span class="pre">calc_horizontal_water_flux()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#easyclimate.core.diff.calc_vertical_water_flux"><code class="docutils literal notranslate"><span class="pre">calc_vertical_water_flux()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#easyclimate.core.diff.calc_water_flux_top2surface_integral"><code class="docutils literal notranslate"><span class="pre">calc_water_flux_top2surface_integral()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#easyclimate.core.diff.calc_divergence_watervaporflux"><code class="docutils literal notranslate"><span class="pre">calc_divergence_watervaporflux()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#easyclimate.core.diff.calc_divergence_watervaporflux_top2surface_integral"><code class="docutils literal notranslate"><span class="pre">calc_divergence_watervaporflux_top2surface_integral()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#easyclimate.core.diff.calc_u_advection"><code class="docutils literal notranslate"><span class="pre">calc_u_advection()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#easyclimate.core.diff.calc_v_advection"><code class="docutils literal notranslate"><span class="pre">calc_v_advection()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#easyclimate.core.diff.calc_p_advection"><code class="docutils literal notranslate"><span class="pre">calc_p_advection()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#easyclimate.core.diff.calc_shear_stretch_deform"><code class="docutils literal notranslate"><span class="pre">calc_shear_stretch_deform()</span></code></a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="module-easyclimate.core.diff">
<span id="easyclimate-core-diff"></span><h1>easyclimate.core.diff<a class="headerlink" href="#module-easyclimate.core.diff" title="Link to this heading">#</a></h1>
<p>The calculation of geographic finite difference</p>
<section id="functions">
<h2>Functions<a class="headerlink" href="#functions" title="Link to this heading">#</a></h2>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#easyclimate.core.diff.calc_gradient" title="easyclimate.core.diff.calc_gradient"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calc_gradient</span></code></a>(‚Üí¬†xarray.DataArray¬†|¬†xarray.Dataset)</p></td>
<td><p>Compute the gradient along the coordinate <cite>dim</cite> direction.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#easyclimate.core.diff.calc_dx_gradient" title="easyclimate.core.diff.calc_dx_gradient"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calc_dx_gradient</span></code></a>(‚Üí¬†xarray.DataArray¬†|¬†xarray.Dataset)</p></td>
<td><p>Calculate the zonal gradient of the input data in physical units (meters).</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#easyclimate.core.diff.calc_dlon_radian_gradient" title="easyclimate.core.diff.calc_dlon_radian_gradient"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calc_dlon_radian_gradient</span></code></a>(...)</p></td>
<td><p>Calculate the gradient of the input data with respect to longitude in radians.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#easyclimate.core.diff.calc_dlon_degree_gradient" title="easyclimate.core.diff.calc_dlon_degree_gradient"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calc_dlon_degree_gradient</span></code></a>(...)</p></td>
<td><p>Calculate the gradient of the input data with respect to longitude in degrees.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#easyclimate.core.diff.calc_dy_gradient" title="easyclimate.core.diff.calc_dy_gradient"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calc_dy_gradient</span></code></a>(‚Üí¬†xarray.DataArray¬†|¬†xarray.Dataset)</p></td>
<td><p>Calculate the meridional gradient of the input data in physical units (meters).</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#easyclimate.core.diff.calc_dlat_radian_gradient" title="easyclimate.core.diff.calc_dlat_radian_gradient"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calc_dlat_radian_gradient</span></code></a>(...)</p></td>
<td><p>Calculate the gradient of the input data with respect to latitude in radians.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#easyclimate.core.diff.calc_dlat_degree_gradient" title="easyclimate.core.diff.calc_dlat_degree_gradient"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calc_dlat_degree_gradient</span></code></a>(...)</p></td>
<td><p>Calculate the gradient of the input data with respect to latitude in degrees.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#easyclimate.core.diff.calc_dx_laplacian" title="easyclimate.core.diff.calc_dx_laplacian"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calc_dx_laplacian</span></code></a>(‚Üí¬†xarray.DataArray¬†|¬†xarray.Dataset)</p></td>
<td><p>Calculation of the second-order partial derivative term (Laplace term) along longitude.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#easyclimate.core.diff.calc_dy_laplacian" title="easyclimate.core.diff.calc_dy_laplacian"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calc_dy_laplacian</span></code></a>(‚Üí¬†xarray.DataArray¬†|¬†xarray.Dataset)</p></td>
<td><p>Calculation of the second-order partial derivative term (Laplace term) along latitude.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#easyclimate.core.diff.calc_dxdy_mixed_derivatives" title="easyclimate.core.diff.calc_dxdy_mixed_derivatives"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calc_dxdy_mixed_derivatives</span></code></a>(...)</p></td>
<td><p>Calculation of second-order mixed partial derivative terms along longitude and latitude.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#easyclimate.core.diff.calc_p_gradient" title="easyclimate.core.diff.calc_p_gradient"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calc_p_gradient</span></code></a>(‚Üí¬†xarray.DataArray)</p></td>
<td><p>Calculate the gradient along the barometric pressure direction in the p-coordinate system.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#easyclimate.core.diff.calc_time_gradient" title="easyclimate.core.diff.calc_time_gradient"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calc_time_gradient</span></code></a>(‚Üí¬†xarray.DataArray)</p></td>
<td><p>Calculate the gradient along the time direction.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#easyclimate.core.diff.calc_delta_pressure" title="easyclimate.core.diff.calc_delta_pressure"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calc_delta_pressure</span></code></a>(‚Üí¬†xarray.DataArray)</p></td>
<td><p>Calculates the pressure layer thickness (delta pressure) of a constant</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#easyclimate.core.diff.calc_p_integral" title="easyclimate.core.diff.calc_p_integral"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calc_p_integral</span></code></a>(‚Üí¬†xarray.DataArray)</p></td>
<td><p>Calculate the vertical integral along the barometric pressure direction in the p-coordinate system.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#easyclimate.core.diff.calc_top2surface_integral" title="easyclimate.core.diff.calc_top2surface_integral"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calc_top2surface_integral</span></code></a>(‚Üí¬†xarray.DataArray)</p></td>
<td><p>Calculate the vertical integral in the p-coordinate system from the ground to the zenith along the barometric pressure direction.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#easyclimate.core.diff.calc_dxdy_laplacian" title="easyclimate.core.diff.calc_dxdy_laplacian"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calc_dxdy_laplacian</span></code></a>(‚Üí¬†xarray.DataArray)</p></td>
<td><p>Calculate the horizontal Laplace term.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#easyclimate.core.diff.calc_divergence" title="easyclimate.core.diff.calc_divergence"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calc_divergence</span></code></a>(‚Üí¬†xarray.DataArray)</p></td>
<td><p>Calculate the horizontal divergence term.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#easyclimate.core.diff.calc_vorticity" title="easyclimate.core.diff.calc_vorticity"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calc_vorticity</span></code></a>(‚Üí¬†xarray.DataArray)</p></td>
<td><p>Calculate the horizontal relative vorticity term.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#easyclimate.core.diff.calc_geostrophic_wind" title="easyclimate.core.diff.calc_geostrophic_wind"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calc_geostrophic_wind</span></code></a>(‚Üí¬†xarray.DataArray)</p></td>
<td><p>Calculate the geostrophic wind.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#easyclimate.core.diff.calc_geostrophic_wind_vorticity" title="easyclimate.core.diff.calc_geostrophic_wind_vorticity"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calc_geostrophic_wind_vorticity</span></code></a>(‚Üí¬†xarray.DataArray)</p></td>
<td><p>Calculate the geostrophic vorticity.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#easyclimate.core.diff.calc_horizontal_water_flux" title="easyclimate.core.diff.calc_horizontal_water_flux"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calc_horizontal_water_flux</span></code></a>(‚Üí¬†xarray.Dataset)</p></td>
<td><p>Calculate horizontal water vapor flux at each vertical level.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#easyclimate.core.diff.calc_vertical_water_flux" title="easyclimate.core.diff.calc_vertical_water_flux"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calc_vertical_water_flux</span></code></a>(‚Üí¬†xarray.DataArray)</p></td>
<td><p>Calculate vertical water vapor flux.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#easyclimate.core.diff.calc_water_flux_top2surface_integral" title="easyclimate.core.diff.calc_water_flux_top2surface_integral"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calc_water_flux_top2surface_integral</span></code></a>(‚Üí¬†xarray.DataArray)</p></td>
<td><p>Calculate the water vapor flux across the vertical level.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#easyclimate.core.diff.calc_divergence_watervaporflux" title="easyclimate.core.diff.calc_divergence_watervaporflux"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calc_divergence_watervaporflux</span></code></a>(‚Üí¬†xarray.DataArray)</p></td>
<td><p>Calculate water vapor flux divergence at each vertical level.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#easyclimate.core.diff.calc_divergence_watervaporflux_top2surface_integral" title="easyclimate.core.diff.calc_divergence_watervaporflux_top2surface_integral"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calc_divergence_watervaporflux_top2surface_integral</span></code></a>(...)</p></td>
<td><p>Calculate water vapor flux divergence across the vertical level.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#easyclimate.core.diff.calc_u_advection" title="easyclimate.core.diff.calc_u_advection"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calc_u_advection</span></code></a>(‚Üí¬†xarray.DataArray)</p></td>
<td><p>Calculate zonal temperature advection at each vertical level.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#easyclimate.core.diff.calc_v_advection" title="easyclimate.core.diff.calc_v_advection"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calc_v_advection</span></code></a>(‚Üí¬†xarray.DataArray)</p></td>
<td><p>Calculate meridional temperature advection at each vertical level.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#easyclimate.core.diff.calc_p_advection" title="easyclimate.core.diff.calc_p_advection"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calc_p_advection</span></code></a>(‚Üí¬†xarray.DataArray)</p></td>
<td><p>Calculate vertical temperature transport at each vertical level.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#easyclimate.core.diff.calc_shear_stretch_deform" title="easyclimate.core.diff.calc_shear_stretch_deform"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calc_shear_stretch_deform</span></code></a>(u_data,¬†v_data[,¬†lon_dim,¬†...])</p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="module-contents">
<h2>Module Contents<a class="headerlink" href="#module-contents" title="Link to this heading">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="easyclimate.core.diff.calc_gradient">
<span class="sig-prename descclassname"><span class="pre">easyclimate.core.diff.</span></span><span class="sig-name descname"><span class="pre">calc_gradient</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_input</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><span class="pre">xarray.DataArray</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.Dataset.html#xarray.Dataset" title="(in xarray v2026.1.0)"><span class="pre">xarray.Dataset</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">varargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><span class="pre">xarray.DataArray</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.Dataset.html#xarray.Dataset" title="(in xarray v2026.1.0)"><span class="pre">xarray.Dataset</span></a></span></span><a class="headerlink" href="#easyclimate.core.diff.calc_gradient" title="Link to this definition">#</a></dt>
<dd><p>Compute the gradient along the coordinate <cite>dim</cite> direction.</p>
<p>The gradient is computed using <strong>second order accurate central differences</strong> in the interior points
and either first or second order accurate one-sides (forward or backwards) differences at the boundaries.
The returned gradient hence has the same shape as the input array.</p>
<section id="parameters">
<h3>Parameters<a class="headerlink" href="#parameters" title="Link to this heading">#</a></h3>
<dl>
<dt>data_input<span class="classifier"><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.DataArray</span></code></a> or <a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.Dataset.html#xarray.Dataset" title="(in xarray v2026.1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.Dataset</span></code></a>.</span></dt><dd><p>The spatio-temporal data to be calculated.</p>
</dd>
<dt>dim<span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>.</span></dt><dd><p>Dimension(s) over which to apply gradient. By default gradient is applied over the <cite>time</cite> dimension.</p>
</dd>
<dt>varargs: <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a> of scalar or array, optional</dt><dd><p>Spacing between f values. Default unitary spacing for all dimensions. Spacing can be specified using:</p>
<ol class="arabic simple">
<li><p>Single scalar to specify a sample distance for all dimensions.</p></li>
<li><p>N scalars to specify a constant sample distance for each dimension. i.e. <span class="math notranslate nohighlight">\(\mathrm{d}x, \mathrm{d}y, \mathrm{d}z, ...\)</span></p></li>
<li><p>N arrays to specify the coordinates of the values along each dimension of F.
The length of the array must match the size of the corresponding dimension.</p></li>
<li><p>Any combination of N scalars/arrays with the meaning of 2. and 3.</p></li>
</ol>
</dd>
<dt>edge_order: {1, 2}, optional</dt><dd><p>Gradient is calculated using N-th order accurate differences at the boundaries. Default: 2.</p>
</dd>
</dl>
</section>
<section id="returns">
<h3>Returns<a class="headerlink" href="#returns" title="Link to this heading">#</a></h3>
<p>The gradient along the coordinate <cite>dim</cite> direction (<a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.DataArray</span></code></a> or <a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.Dataset.html#xarray.Dataset" title="(in xarray v2026.1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.Dataset</span></code></a>).</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.gradient.html#numpy.gradient" title="(in NumPy v2.4)"><code class="xref py py-func docutils literal notranslate"><span class="pre">numpy.gradient</span></code></a></p>
</div>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="easyclimate.core.diff.calc_dx_gradient">
<span class="sig-prename descclassname"><span class="pre">easyclimate.core.diff.</span></span><span class="sig-name descname"><span class="pre">calc_dx_gradient</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_input</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><span class="pre">xarray.DataArray</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.Dataset.html#xarray.Dataset" title="(in xarray v2026.1.0)"><span class="pre">xarray.Dataset</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">lon_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'lon'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'lat'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_dx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">R</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">6371200.0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><span class="pre">xarray.DataArray</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.Dataset.html#xarray.Dataset" title="(in xarray v2026.1.0)"><span class="pre">xarray.Dataset</span></a></span></span><a class="headerlink" href="#easyclimate.core.diff.calc_dx_gradient" title="Link to this definition">#</a></dt>
<dd><p>Calculate the zonal gradient of the input data in physical units (meters).</p>
<p>This function computes the partial derivative <span class="math notranslate nohighlight">\(\partial F / \partial x\)</span>,
where <span class="math notranslate nohighlight">\(x\)</span> is the eastward distance along a parallel (in meters). It is
the full physical zonal gradient on a sphere, given by:</p>
<div class="math notranslate nohighlight">
\[\frac{\partial F}{\partial x} = \frac{1}{R \cos \varphi} \cdot \frac{\partial F}{\partial \lambda}\]</div>
<p>where <span class="math notranslate nohighlight">\(R\)</span> is the Earth‚Äôs radius, <span class="math notranslate nohighlight">\(\varphi\)</span> is latitude, and
<span class="math notranslate nohighlight">\(\lambda\)</span> is longitude in radians. This is essential for dynamical
calculations like advection or wave propagation in atmospheric/oceanic models.</p>
<p>The computation uses finite differences along the longitude dimension:
<span class="math notranslate nohighlight">\(\partial F / \partial x = (\partial F / \partial i) / (\partial x / \partial i)\)</span>,
where <span class="math notranslate nohighlight">\(i\)</span> is the grid index. Longitude is assumed in degrees and
converted to radians; latitude is broadcasted for the cosine factor.</p>
<section id="id1">
<h3>Parameters<a class="headerlink" href="#id1" title="Link to this heading">#</a></h3>
<dl>
<dt>data_input<span class="classifier"><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.DataArray</span></code></a> or <a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.Dataset.html#xarray.Dataset" title="(in xarray v2026.1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.Dataset</span></code></a></span></dt><dd><p>The spatio-temporal data to be calculated. If a Dataset, the gradient is applied to all
data variables.</p>
</dd>
<dt>lon_dim: <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, default: <cite>lon</cite>.</dt><dd><p>Longitude coordinate dimension name. By default, the gradient is applied over the <cite>lon</cite> dimension.</p>
</dd>
<dt>lat_dim: <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, default: <cite>lat</cite>.</dt><dd><p>Latitude coordinate dimension name. Used to compute the cosine factor; broadcasted if necessary.</p>
</dd>
<dt>min_dx: <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, default: <cite>1.0</cite> (<span class="math notranslate nohighlight">\(\mathrm{m}\)</span>).</dt><dd><p>The minimum acceptable value of <cite>dx</cite> (zonal spacing in meters), below which the output
is set to NaN to avoid numerical instabilities from very small grid spacings.
Set to a negative value to disable this check.</p>
</dd>
<dt>edge_order: {1, 2}, optional</dt><dd><p>Order of the finite difference used at the boundaries. 1 uses first-order accurate
one-sided differences; 2 uses second-order accurate one-sided differences. Default: 2.</p>
</dd>
<dt>R: <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, default: <cite>6370000</cite> (<span class="math notranslate nohighlight">\(\mathrm{m}\)</span>).</dt><dd><p>Radius of the Earth in meters (approximate mean radius). Can be adjusted for specific models.</p>
</dd>
</dl>
</section>
<section id="id2">
<h3>Returns<a class="headerlink" href="#id2" title="Link to this heading">#</a></h3>
<dl class="simple">
<dt><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.DataArray</span></code></a> or <a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.Dataset.html#xarray.Dataset" title="(in xarray v2026.1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.Dataset</span></code></a></dt><dd><p>The zonal gradient <span class="math notranslate nohighlight">\(\partial F / \partial x\)</span>, with the same shape and coordinates
as the input. Units are those of the input data divided by meters (e.g., if F is in K,
output is K/m). Invalid regions (dx &lt; min_dx) are NaN.</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<ul class="simple">
<li><p><a class="reference internal" href="#easyclimate.core.diff.calc_gradient" title="easyclimate.core.diff.calc_gradient"><code class="xref py py-func docutils literal notranslate"><span class="pre">calc_gradient</span></code></a></p></li>
<li><p><a class="reference internal" href="#easyclimate.core.diff.calc_dlon_radian_gradient" title="easyclimate.core.diff.calc_dlon_radian_gradient"><code class="xref py py-func docutils literal notranslate"><span class="pre">calc_dlon_radian_gradient</span></code></a></p></li>
<li><p><a class="reference internal" href="#easyclimate.core.diff.calc_dy_gradient" title="easyclimate.core.diff.calc_dy_gradient"><code class="xref py py-func docutils literal notranslate"><span class="pre">calc_dy_gradient</span></code></a></p></li>
</ul>
</div>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="easyclimate.core.diff.calc_dlon_radian_gradient">
<span class="sig-prename descclassname"><span class="pre">easyclimate.core.diff.</span></span><span class="sig-name descname"><span class="pre">calc_dlon_radian_gradient</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_input</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><span class="pre">xarray.DataArray</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.Dataset.html#xarray.Dataset" title="(in xarray v2026.1.0)"><span class="pre">xarray.Dataset</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">lon_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'lon'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><span class="pre">xarray.DataArray</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.Dataset.html#xarray.Dataset" title="(in xarray v2026.1.0)"><span class="pre">xarray.Dataset</span></a></span></span><a class="headerlink" href="#easyclimate.core.diff.calc_dlon_radian_gradient" title="Link to this definition">#</a></dt>
<dd><p>Calculate the gradient of the input data with respect to longitude in radians.</p>
<p>This function computes the partial derivative <span class="math notranslate nohighlight">\(\partial F / \partial \lambda\)</span>,
where <span class="math notranslate nohighlight">\(\lambda\)</span> is the longitude in radians. It is useful for spherical coordinate
calculations, such as in wave activity flux (WAF) formulations, where angular gradients
must be in radians for consistency with trigonometric functions and the Earth‚Äôs radius.</p>
<p>The computation uses finite differences:</p>
<div class="math notranslate nohighlight">
\[\frac{\partial F}{\partial \lambda} = \frac{\partial F}{\partial i } / \frac{\partial \lambda}{\partial i},\]</div>
<p>where <span class="math notranslate nohighlight">\(i\)</span> is the grid index along the longitude dimension. Longitude values are
assumed to be in degrees initially and converted to radians for the denominator.</p>
<section id="id3">
<h3>Parameters<a class="headerlink" href="#id3" title="Link to this heading">#</a></h3>
<dl>
<dt>data_input<span class="classifier"><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.DataArray</span></code></a> or <a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.Dataset.html#xarray.Dataset" title="(in xarray v2026.1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.Dataset</span></code></a></span></dt><dd><p>The spatio-temporal data to be calculated. If a Dataset, the gradient is applied to all data variables.</p>
</dd>
<dt>lon_dim: <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, default: <cite>lon</cite>.</dt><dd><p>Longitude coordinate dimension name. By default, the gradient is applied over the <cite>lon</cite> dimension.</p>
</dd>
<dt>edge_order: {1, 2}, optional</dt><dd><p>Order of the finite difference used at the boundaries. 1 uses first-order accurate
one-sided differences; 2 uses second-order accurate one-sided differences. Default: 2.</p>
</dd>
</dl>
</section>
<section id="id4">
<h3>Returns<a class="headerlink" href="#id4" title="Link to this heading">#</a></h3>
<dl class="simple">
<dt><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.DataArray</span></code></a> or <a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.Dataset.html#xarray.Dataset" title="(in xarray v2026.1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.Dataset</span></code></a></dt><dd><p>The gradient <span class="math notranslate nohighlight">\(\partial F / \partial \lambda\)</span> (in radians), with the same shape
and coordinates as the input. Units are inherited from the input data divided by radians
(e.g., if F is in K, output is K/rad).</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="easyclimate.core.diff.calc_dlon_degree_gradient">
<span class="sig-prename descclassname"><span class="pre">easyclimate.core.diff.</span></span><span class="sig-name descname"><span class="pre">calc_dlon_degree_gradient</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_input</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><span class="pre">xarray.DataArray</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.Dataset.html#xarray.Dataset" title="(in xarray v2026.1.0)"><span class="pre">xarray.Dataset</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">lon_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'lon'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><span class="pre">xarray.DataArray</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.Dataset.html#xarray.Dataset" title="(in xarray v2026.1.0)"><span class="pre">xarray.Dataset</span></a></span></span><a class="headerlink" href="#easyclimate.core.diff.calc_dlon_degree_gradient" title="Link to this definition">#</a></dt>
<dd><p>Calculate the gradient of the input data with respect to longitude in degrees.</p>
<p>This function computes the partial derivative <span class="math notranslate nohighlight">\(\partial F / \partial \lambda\)</span>,
where <span class="math notranslate nohighlight">\(\lambda\)</span> is the longitude in degrees. It is suitable for general-purpose
gradient calculations where degree units are preferred for interpretability.</p>
<p>The computation uses finite differences:</p>
<div class="math notranslate nohighlight">
\[\frac{\partial F}{\partial \lambda} = \frac{\partial F}{\partial i} / \frac{\partial \lambda}{\partial i},\]</div>
<p>where <span class="math notranslate nohighlight">\(i\)</span> is the grid index along the longitude dimension. Longitude values remain
in degrees for the denominator.</p>
<section id="id5">
<h3>Parameters<a class="headerlink" href="#id5" title="Link to this heading">#</a></h3>
<dl>
<dt>data_input<span class="classifier"><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.DataArray</span></code></a> or <a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.Dataset.html#xarray.Dataset" title="(in xarray v2026.1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.Dataset</span></code></a></span></dt><dd><p>The spatio-temporal data to be calculated. If a Dataset, the gradient is applied to all
data variables.</p>
</dd>
<dt>lon_dim: <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, default: <cite>lon</cite>.</dt><dd><p>Longitude coordinate dimension name. By default, the gradient is applied over the <cite>lon</cite> dimension.</p>
</dd>
<dt>edge_order: {1, 2}, optional</dt><dd><p>Order of the finite difference used at the boundaries. 1 uses first-order accurate
one-sided differences; 2 uses second-order accurate one-sided differences. Default: 2.</p>
</dd>
</dl>
</section>
<section id="id6">
<h3>Returns<a class="headerlink" href="#id6" title="Link to this heading">#</a></h3>
<dl class="simple">
<dt><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.DataArray</span></code></a> or <a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.Dataset.html#xarray.Dataset" title="(in xarray v2026.1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.Dataset</span></code></a></dt><dd><p>The gradient <span class="math notranslate nohighlight">\(\partial F / \partial \lambda\)</span> (in degrees), with the same shape
and coordinates as the input. Units are inherited from the input data divided by degrees
(e.g., if F is in K, output is K/deg).</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<ul class="simple">
<li><p><a class="reference internal" href="#easyclimate.core.diff.calc_gradient" title="easyclimate.core.diff.calc_gradient"><code class="xref py py-func docutils literal notranslate"><span class="pre">calc_gradient</span></code></a></p></li>
<li><p><a class="reference internal" href="#easyclimate.core.diff.calc_dlon_radian_gradient" title="easyclimate.core.diff.calc_dlon_radian_gradient"><code class="xref py py-func docutils literal notranslate"><span class="pre">calc_dlon_radian_gradient</span></code></a></p></li>
<li><p><a class="reference internal" href="#easyclimate.core.diff.calc_dlat_degree_gradient" title="easyclimate.core.diff.calc_dlat_degree_gradient"><code class="xref py py-func docutils literal notranslate"><span class="pre">calc_dlat_degree_gradient</span></code></a></p></li>
</ul>
</div>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="easyclimate.core.diff.calc_dy_gradient">
<span class="sig-prename descclassname"><span class="pre">easyclimate.core.diff.</span></span><span class="sig-name descname"><span class="pre">calc_dy_gradient</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_input</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><span class="pre">xarray.DataArray</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.Dataset.html#xarray.Dataset" title="(in xarray v2026.1.0)"><span class="pre">xarray.Dataset</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'lat'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_dy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">R</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">6371200.0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><span class="pre">xarray.DataArray</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.Dataset.html#xarray.Dataset" title="(in xarray v2026.1.0)"><span class="pre">xarray.Dataset</span></a></span></span><a class="headerlink" href="#easyclimate.core.diff.calc_dy_gradient" title="Link to this definition">#</a></dt>
<dd><p>Calculate the meridional gradient of the input data in physical units (meters).</p>
<p>This function computes the partial derivative <span class="math notranslate nohighlight">\(\partial F / \partial y\)</span>,
where <span class="math notranslate nohighlight">\(y\)</span> is the northward distance along a meridian (in meters). It is
the full physical meridional gradient on a sphere, given by:</p>
<div class="math notranslate nohighlight">
\[\frac{\partial F}{\partial y} = \frac{1}{R} \cdot \frac{\partial F}{\partial \varphi}\]</div>
<p>where <span class="math notranslate nohighlight">\(R\)</span> is the Earth‚Äôs radius and <span class="math notranslate nohighlight">\(\varphi\)</span> is latitude in radians.
This is essential for dynamical calculations like advection or vorticity in models.</p>
<p>The computation uses finite differences along the latitude dimension:
<span class="math notranslate nohighlight">\(\partial F / \partial y = (\partial F / \partial j) / (\partial y / \partial j)\)</span>,
where <span class="math notranslate nohighlight">\(j\)</span> is the grid index. Latitude is assumed in degrees and
converted to radians.</p>
<section id="id7">
<h3>Parameters<a class="headerlink" href="#id7" title="Link to this heading">#</a></h3>
<dl>
<dt>data_input<span class="classifier"><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.DataArray</span></code></a> or <a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.Dataset.html#xarray.Dataset" title="(in xarray v2026.1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.Dataset</span></code></a></span></dt><dd><p>The spatio-temporal data to be calculated. If a Dataset, the gradient is applied to all
data variables.</p>
</dd>
<dt>lat_dim: <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, default: <cite>lat</cite>.</dt><dd><p>Latitude coordinate dimension name. By default, the gradient is applied over the <cite>lat</cite> dimension.</p>
</dd>
<dt>min_dy: <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, default: <cite>1.0</cite>.</dt><dd><p>The minimum acceptable value of <cite>dy</cite> (meridional spacing in meters), below which the output
is set to NaN to avoid numerical instabilities from very small grid spacings.
Set to a negative value to disable this check. Unit: meters.</p>
</dd>
<dt>edge_order: {1, 2}, optional</dt><dd><p>Order of the finite difference used at the boundaries. 1 uses first-order accurate
one-sided differences; 2 uses second-order accurate one-sided differences. Default: 2.</p>
</dd>
<dt>R: <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, default: <cite>6370000</cite>.</dt><dd><p>Radius of the Earth in meters (approximate mean radius). Can be adjusted for specific models.</p>
</dd>
</dl>
</section>
<section id="id8">
<h3>Returns<a class="headerlink" href="#id8" title="Link to this heading">#</a></h3>
<dl class="simple">
<dt><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.DataArray</span></code></a> or <a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.Dataset.html#xarray.Dataset" title="(in xarray v2026.1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.Dataset</span></code></a></dt><dd><p>The meridional gradient <span class="math notranslate nohighlight">\(\partial F / \partial y\)</span>, with the same shape and coordinates
as the input. Units are those of the input data divided by meters (e.g., if F is in K,
output is K/m). Invalid regions (dy &lt; min_dy) are NaN.</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<ul class="simple">
<li><p><a class="reference internal" href="#easyclimate.core.diff.calc_gradient" title="easyclimate.core.diff.calc_gradient"><code class="xref py py-func docutils literal notranslate"><span class="pre">calc_gradient</span></code></a></p></li>
<li><p><a class="reference internal" href="#easyclimate.core.diff.calc_dlat_radian_gradient" title="easyclimate.core.diff.calc_dlat_radian_gradient"><code class="xref py py-func docutils literal notranslate"><span class="pre">calc_dlat_radian_gradient</span></code></a></p></li>
<li><p><a class="reference internal" href="#easyclimate.core.diff.calc_dx_gradient" title="easyclimate.core.diff.calc_dx_gradient"><code class="xref py py-func docutils literal notranslate"><span class="pre">calc_dx_gradient</span></code></a></p></li>
</ul>
</div>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="easyclimate.core.diff.calc_dlat_radian_gradient">
<span class="sig-prename descclassname"><span class="pre">easyclimate.core.diff.</span></span><span class="sig-name descname"><span class="pre">calc_dlat_radian_gradient</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_input</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><span class="pre">xarray.DataArray</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.Dataset.html#xarray.Dataset" title="(in xarray v2026.1.0)"><span class="pre">xarray.Dataset</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'lat'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><span class="pre">xarray.DataArray</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.Dataset.html#xarray.Dataset" title="(in xarray v2026.1.0)"><span class="pre">xarray.Dataset</span></a></span></span><a class="headerlink" href="#easyclimate.core.diff.calc_dlat_radian_gradient" title="Link to this definition">#</a></dt>
<dd><p>Calculate the gradient of the input data with respect to latitude in radians.</p>
<p>This function computes the partial derivative <span class="math notranslate nohighlight">\(\partial F / \partial \phi\)</span>,
where <span class="math notranslate nohighlight">\(\phi\)</span> is the latitude in radians. It is useful for spherical coordinate
calculations, such as in wave activity flux (WAF) formulations.</p>
<p>The computation uses finite differences:</p>
<div class="math notranslate nohighlight">
\[\frac{\partial F}{\partial \phi} = \frac{\partial F}{\partial j} / \frac{\partial \phi}{\partial j},\]</div>
<p>where <span class="math notranslate nohighlight">\(j\)</span> is the grid index along the latitude dimension. Latitude values are
assumed to be in degrees initially and converted to radians for the denominator.</p>
<section id="id9">
<h3>Parameters<a class="headerlink" href="#id9" title="Link to this heading">#</a></h3>
<dl>
<dt>data_input<span class="classifier"><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.DataArray</span></code></a> or <a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.Dataset.html#xarray.Dataset" title="(in xarray v2026.1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.Dataset</span></code></a></span></dt><dd><p>The spatio-temporal data to be calculated. If a Dataset, the gradient is applied to all
data variables.</p>
</dd>
<dt>lat_dim: <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, default: <cite>lat</cite>.</dt><dd><p>Latitude coordinate dimension name. By default, the gradient is applied over the <cite>lat</cite> dimension.</p>
</dd>
<dt>edge_order: {1, 2}, optional</dt><dd><p>Order of the finite difference used at the boundaries. 1 uses first-order accurate
one-sided differences; 2 uses second-order accurate one-sided differences. Default: 2.</p>
</dd>
</dl>
</section>
<section id="id10">
<h3>Returns<a class="headerlink" href="#id10" title="Link to this heading">#</a></h3>
<dl class="simple">
<dt><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.DataArray</span></code></a> or <a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.Dataset.html#xarray.Dataset" title="(in xarray v2026.1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.Dataset</span></code></a></dt><dd><p>The gradient <span class="math notranslate nohighlight">\(\partial F / \partial \phi\)</span> (in radians), with the same shape
and coordinates as the input. Units are inherited from the input data divided by radians
(e.g., if F is in K, output is K/rad).</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<ul class="simple">
<li><p><a class="reference internal" href="#easyclimate.core.diff.calc_gradient" title="easyclimate.core.diff.calc_gradient"><code class="xref py py-func docutils literal notranslate"><span class="pre">calc_gradient</span></code></a></p></li>
<li><p><a class="reference internal" href="#easyclimate.core.diff.calc_dlat_degree_gradient" title="easyclimate.core.diff.calc_dlat_degree_gradient"><code class="xref py py-func docutils literal notranslate"><span class="pre">calc_dlat_degree_gradient</span></code></a></p></li>
<li><p><a class="reference internal" href="#easyclimate.core.diff.calc_dlon_radian_gradient" title="easyclimate.core.diff.calc_dlon_radian_gradient"><code class="xref py py-func docutils literal notranslate"><span class="pre">calc_dlon_radian_gradient</span></code></a></p></li>
</ul>
</div>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="easyclimate.core.diff.calc_dlat_degree_gradient">
<span class="sig-prename descclassname"><span class="pre">easyclimate.core.diff.</span></span><span class="sig-name descname"><span class="pre">calc_dlat_degree_gradient</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_input</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><span class="pre">xarray.DataArray</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.Dataset.html#xarray.Dataset" title="(in xarray v2026.1.0)"><span class="pre">xarray.Dataset</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'lat'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><span class="pre">xarray.DataArray</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.Dataset.html#xarray.Dataset" title="(in xarray v2026.1.0)"><span class="pre">xarray.Dataset</span></a></span></span><a class="headerlink" href="#easyclimate.core.diff.calc_dlat_degree_gradient" title="Link to this definition">#</a></dt>
<dd><p>Calculate the gradient of the input data with respect to latitude in degrees.</p>
<p>This function computes the partial derivative <span class="math notranslate nohighlight">\(\partial F / \partial \phi\)</span>,
where <span class="math notranslate nohighlight">\(\phi\)</span> is the latitude in degrees. It is suitable for general-purpose
gradient calculations where degree units are preferred.</p>
<p>The computation uses finite differences:</p>
<div class="math notranslate nohighlight">
\[\frac{\partial F}{\partial \phi} = \frac{\partial F}{\partial j} / \frac{\partial \phi}{\partial j},\]</div>
<p>where <span class="math notranslate nohighlight">\(j\)</span> is the grid index along the latitude dimension. Latitude values remain
in degrees for the denominator.</p>
<section id="id11">
<h3>Parameters<a class="headerlink" href="#id11" title="Link to this heading">#</a></h3>
<dl>
<dt>data_input<span class="classifier"><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.DataArray</span></code></a> or <a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.Dataset.html#xarray.Dataset" title="(in xarray v2026.1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.Dataset</span></code></a></span></dt><dd><p>The spatio-temporal data to be calculated. If a Dataset, the gradient is applied to all
data variables.</p>
</dd>
<dt>lat_dim: <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, default: <cite>lat</cite>.</dt><dd><p>Latitude coordinate dimension name. By default, the gradient is applied over the <cite>lat</cite> dimension.</p>
</dd>
<dt>edge_order: {1, 2}, optional</dt><dd><p>Order of the finite difference used at the boundaries. 1 uses first-order accurate
one-sided differences; 2 uses second-order accurate one-sided differences. Default: 2.</p>
</dd>
</dl>
</section>
<section id="id12">
<h3>Returns<a class="headerlink" href="#id12" title="Link to this heading">#</a></h3>
<dl class="simple">
<dt><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.DataArray</span></code></a> or <a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.Dataset.html#xarray.Dataset" title="(in xarray v2026.1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.Dataset</span></code></a></dt><dd><p>The gradient <span class="math notranslate nohighlight">\(\partial F / \partial \phi\)</span> (in degrees), with the same shape
and coordinates as the input. Units are inherited from the input data divided by degrees
(e.g., if F is in K, output is K/deg).</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<ul class="simple">
<li><p><a class="reference internal" href="#easyclimate.core.diff.calc_gradient" title="easyclimate.core.diff.calc_gradient"><code class="xref py py-func docutils literal notranslate"><span class="pre">calc_gradient</span></code></a></p></li>
<li><p><a class="reference internal" href="#easyclimate.core.diff.calc_dlat_radian_gradient" title="easyclimate.core.diff.calc_dlat_radian_gradient"><code class="xref py py-func docutils literal notranslate"><span class="pre">calc_dlat_radian_gradient</span></code></a></p></li>
<li><p><a class="reference internal" href="#easyclimate.core.diff.calc_dlon_degree_gradient" title="easyclimate.core.diff.calc_dlon_degree_gradient"><code class="xref py py-func docutils literal notranslate"><span class="pre">calc_dlon_degree_gradient</span></code></a></p></li>
</ul>
</div>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="easyclimate.core.diff.calc_dx_laplacian">
<span class="sig-prename descclassname"><span class="pre">easyclimate.core.diff.</span></span><span class="sig-name descname"><span class="pre">calc_dx_laplacian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_input</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><span class="pre">xarray.DataArray</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.Dataset.html#xarray.Dataset" title="(in xarray v2026.1.0)"><span class="pre">xarray.Dataset</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">lon_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'lon'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'lat'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_dx2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1000000000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">R</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">6371200.0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><span class="pre">xarray.DataArray</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.Dataset.html#xarray.Dataset" title="(in xarray v2026.1.0)"><span class="pre">xarray.Dataset</span></a></span></span><a class="headerlink" href="#easyclimate.core.diff.calc_dx_laplacian" title="Link to this definition">#</a></dt>
<dd><p>Calculation of the second-order partial derivative term (Laplace term) along longitude.</p>
<div class="math notranslate nohighlight">
\[\frac{\partial^2 F}{\partial x^2} = \frac{1}{(R \cos\varphi)^2} \cdot \frac{\partial^2 F}{\partial \lambda^2}\]</div>
<section id="id13">
<h3>Parameters<a class="headerlink" href="#id13" title="Link to this heading">#</a></h3>
<dl>
<dt>data_input<span class="classifier"><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.DataArray</span></code></a> or <a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.Dataset.html#xarray.Dataset" title="(in xarray v2026.1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.Dataset</span></code></a></span></dt><dd><p>The spatio-temporal data to be calculated.</p>
</dd>
<dt>lon_dim: <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, default: <cite>lon</cite>.</dt><dd><p>Longitude coordinate dimension name. By default extracting is applied over the <cite>lon</cite> dimension.</p>
</dd>
<dt>lat_dim: <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, default: <cite>lat</cite>.</dt><dd><p>Latitude coordinate dimension name. By default extracting is applied over the <cite>lat</cite> dimension.</p>
</dd>
<dt>min_dx2: <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, default: <cite>1e9</cite>.</dt><dd><p>The minimum acceptable value of <span class="math notranslate nohighlight">\((\mathrm{d}x)^2\)</span>, below which parts will set <cite>nan</cite> to avoid large computational errors.
The unit is m. You can set it to a negative value in order to remove this benefit.</p>
</dd>
<dt>edge_order: {1, 2}, optional</dt><dd><p>Gradient is calculated using N-th order accurate differences at the boundaries. Default: 1.</p>
</dd>
<dt>R: <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, default: <cite>6370000</cite>.</dt><dd><p>Radius of the Earth.</p>
</dd>
</dl>
</section>
<section id="id14">
<h3>Returns<a class="headerlink" href="#id14" title="Link to this heading">#</a></h3>
<p>The second-order partial derivative term (Laplace term) along longitude (<a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.DataArray</span></code></a> or <a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.Dataset.html#xarray.Dataset" title="(in xarray v2026.1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.Dataset</span></code></a>).</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#easyclimate.core.diff.calc_gradient" title="easyclimate.core.diff.calc_gradient"><code class="xref py py-func docutils literal notranslate"><span class="pre">calc_gradient</span></code></a></p>
</div>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="easyclimate.core.diff.calc_dy_laplacian">
<span class="sig-prename descclassname"><span class="pre">easyclimate.core.diff.</span></span><span class="sig-name descname"><span class="pre">calc_dy_laplacian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_input</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><span class="pre">xarray.DataArray</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.Dataset.html#xarray.Dataset" title="(in xarray v2026.1.0)"><span class="pre">xarray.Dataset</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'lat'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_dy2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">R</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">6371200.0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><span class="pre">xarray.DataArray</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.Dataset.html#xarray.Dataset" title="(in xarray v2026.1.0)"><span class="pre">xarray.Dataset</span></a></span></span><a class="headerlink" href="#easyclimate.core.diff.calc_dy_laplacian" title="Link to this definition">#</a></dt>
<dd><p>Calculation of the second-order partial derivative term (Laplace term) along latitude.</p>
<div class="math notranslate nohighlight">
\[\frac{\partial^2 F}{\partial y^2} = \frac{1}{R^2} \cdot \frac{\partial^2 F}{\partial \varphi^2}\]</div>
<section id="id15">
<h3>Parameters<a class="headerlink" href="#id15" title="Link to this heading">#</a></h3>
<dl>
<dt>data_input<span class="classifier"><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.DataArray</span></code></a> or <a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.Dataset.html#xarray.Dataset" title="(in xarray v2026.1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.Dataset</span></code></a></span></dt><dd><p>The spatio-temporal data to be calculated.</p>
</dd>
<dt>lat_dim: <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, default: <cite>lat</cite>.</dt><dd><p>Latitude coordinate dimension name. By default extracting is applied over the <cite>lat</cite> dimension.</p>
</dd>
<dt>min_dy2: <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, default: <cite>1.0</cite>.</dt><dd><p>The minimum acceptable value of <span class="math notranslate nohighlight">\((\mathrm{d}y)^2\)</span>, below which parts will set <cite>nan</cite> to avoid large computational errors.
The unit is m. You can set it to a negative value in order to remove this benefit.</p>
</dd>
<dt>edge_order: {1, 2}, optional</dt><dd><p>Gradient is calculated using N-th order accurate differences at the boundaries. Default: 1.</p>
</dd>
<dt>R: <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, default: <cite>6370000</cite>.</dt><dd><p>Radius of the Earth.</p>
</dd>
</dl>
</section>
<section id="id16">
<h3>Returns<a class="headerlink" href="#id16" title="Link to this heading">#</a></h3>
<p>The second-order partial derivative term (Laplace term) along latitude (<a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.DataArray</span></code></a> or <a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.Dataset.html#xarray.Dataset" title="(in xarray v2026.1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.Dataset</span></code></a>).</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#easyclimate.core.diff.calc_gradient" title="easyclimate.core.diff.calc_gradient"><code class="xref py py-func docutils literal notranslate"><span class="pre">calc_gradient</span></code></a></p>
</div>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="easyclimate.core.diff.calc_dxdy_mixed_derivatives">
<span class="sig-prename descclassname"><span class="pre">easyclimate.core.diff.</span></span><span class="sig-name descname"><span class="pre">calc_dxdy_mixed_derivatives</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_input</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><span class="pre">xarray.DataArray</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.Dataset.html#xarray.Dataset" title="(in xarray v2026.1.0)"><span class="pre">xarray.Dataset</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">lon_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'lon'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'lat'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_dxdy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10000000000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">R</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">6371200.0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><span class="pre">xarray.DataArray</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.Dataset.html#xarray.Dataset" title="(in xarray v2026.1.0)"><span class="pre">xarray.Dataset</span></a></span></span><a class="headerlink" href="#easyclimate.core.diff.calc_dxdy_mixed_derivatives" title="Link to this definition">#</a></dt>
<dd><p>Calculation of second-order mixed partial derivative terms along longitude and latitude.</p>
<div class="math notranslate nohighlight">
\[\frac{\partial^2 F}{\partial x \partial y} = \frac{1}{R^2 \cos\varphi} \cdot \frac{\partial^2 F}{\partial \lambda \partial \varphi}\]</div>
<section id="id17">
<h3>Parameters<a class="headerlink" href="#id17" title="Link to this heading">#</a></h3>
<dl>
<dt>data_input<span class="classifier"><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.DataArray</span></code></a> or <a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.Dataset.html#xarray.Dataset" title="(in xarray v2026.1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.Dataset</span></code></a></span></dt><dd><p>The spatio-temporal data to be calculated.</p>
</dd>
<dt>lon_dim: <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, default: <cite>lon</cite>.</dt><dd><p>Longitude coordinate dimension name. By default extracting is applied over the <cite>lon</cite> dimension.</p>
</dd>
<dt>lat_dim: <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, default: <cite>lat</cite>.</dt><dd><p>Latitude coordinate dimension name. By default extracting is applied over the <cite>lat</cite> dimension.</p>
</dd>
<dt>min_dxdy: <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, default: <cite>1e10</cite>.</dt><dd><p>The minimum acceptable value of <span class="math notranslate nohighlight">\(\mathrm{d}x\mathrm{d}y\)</span>, below which parts will set <cite>nan</cite> to avoid large computational errors.
The unit is m. You can set it to a negative value in order to remove this benefit.</p>
</dd>
<dt>edge_order: {1, 2}, optional</dt><dd><p>Gradient is calculated using N-th order accurate differences at the boundaries. Default: 1.</p>
</dd>
<dt>R: <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, default: <cite>6370000</cite>.</dt><dd><p>Radius of the Earth.</p>
</dd>
</dl>
</section>
<section id="id18">
<h3>Returns<a class="headerlink" href="#id18" title="Link to this heading">#</a></h3>
<p>The second-order mixed partial derivative terms along longitude and latitude (<a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.DataArray</span></code></a> or <a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.Dataset.html#xarray.Dataset" title="(in xarray v2026.1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.Dataset</span></code></a>).</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#easyclimate.core.diff.calc_gradient" title="easyclimate.core.diff.calc_gradient"><code class="xref py py-func docutils literal notranslate"><span class="pre">calc_gradient</span></code></a></p>
</div>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="easyclimate.core.diff.calc_p_gradient">
<span class="sig-prename descclassname"><span class="pre">easyclimate.core.diff.</span></span><span class="sig-name descname"><span class="pre">calc_p_gradient</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_input</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><span class="pre">xarray.DataArray</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">vertical_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">vertical_dim_units</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'hPa'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'Pa'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'mbar'</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><span class="pre">xarray.DataArray</span></a></span></span><a class="headerlink" href="#easyclimate.core.diff.calc_p_gradient" title="Link to this definition">#</a></dt>
<dd><p>Calculate the gradient along the barometric pressure direction in the p-coordinate system.</p>
<div class="math notranslate nohighlight">
\[\frac{\partial F}{\partial p}\]</div>
<section id="id19">
<h3>Parameters<a class="headerlink" href="#id19" title="Link to this heading">#</a></h3>
<dl>
<dt>data_input<span class="classifier"><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.DataArray</span></code></a> or <a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.Dataset.html#xarray.Dataset" title="(in xarray v2026.1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.Dataset</span></code></a></span></dt><dd><p>The spatio-temporal data to be calculated.</p>
</dd>
<dt>vertical_dim: <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>.</dt><dd><p>Vertical coordinate dimension name.</p>
</dd>
<dt>vertical_dim_units: <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>.</dt><dd><p>The unit corresponding to the vertical p-coordinate value. Optional values are <cite>hPa</cite>, <cite>Pa</cite>, <cite>mbar</cite>.</p>
</dd>
</dl>
</section>
<section id="id20">
<h3>Returns<a class="headerlink" href="#id20" title="Link to this heading">#</a></h3>
<p>The gradient along the barometric pressure direction in the p-coordinate system (<a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.DataArray</span></code></a> or <a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.Dataset.html#xarray.Dataset" title="(in xarray v2026.1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.Dataset</span></code></a>).</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#easyclimate.core.diff.calc_gradient" title="easyclimate.core.diff.calc_gradient"><code class="xref py py-func docutils literal notranslate"><span class="pre">calc_gradient</span></code></a></p>
</div>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="easyclimate.core.diff.calc_time_gradient">
<span class="sig-prename descclassname"><span class="pre">easyclimate.core.diff.</span></span><span class="sig-name descname"><span class="pre">calc_time_gradient</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_input</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><span class="pre">xarray.DataArray</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_units</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'time'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><span class="pre">xarray.DataArray</span></a></span></span><a class="headerlink" href="#easyclimate.core.diff.calc_time_gradient" title="Link to this definition">#</a></dt>
<dd><p>Calculate the gradient along the time direction.</p>
<div class="math notranslate nohighlight">
\[\frac{\partial F}{\partial t}\]</div>
<section id="id21">
<h3>Parameters<a class="headerlink" href="#id21" title="Link to this heading">#</a></h3>
<dl>
<dt>data_input<span class="classifier"><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.DataArray</span></code></a> or <a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.Dataset.html#xarray.Dataset" title="(in xarray v2026.1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.Dataset</span></code></a></span></dt><dd><p>The spatio-temporal data to be calculated.</p>
</dd>
<dt>time_units: <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>.</dt><dd><p>The unit corresponding to the time dimension value. Optional values are <cite>seconds</cite>, <cite>months</cite>, <cite>years</cite> and so on.</p>
</dd>
<dt>time_dim: <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, default: <cite>time</cite>.</dt><dd><p>The time coordinate dimension name.</p>
</dd>
</dl>
</section>
<section id="id22">
<h3>Returns<a class="headerlink" href="#id22" title="Link to this heading">#</a></h3>
<p>The gradient along the time direction (<a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.DataArray</span></code></a> or <a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.Dataset.html#xarray.Dataset" title="(in xarray v2026.1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.Dataset</span></code></a>).</p>
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>The units for partial derivative of <cite>time</cite> are <span class="math notranslate nohighlight">\(\mathrm{s^{-1}}\)</span>.</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#easyclimate.core.diff.calc_gradient" title="easyclimate.core.diff.calc_gradient"><code class="xref py py-func docutils literal notranslate"><span class="pre">calc_gradient</span></code></a></p>
</div>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="easyclimate.core.diff.calc_delta_pressure">
<span class="sig-prename descclassname"><span class="pre">easyclimate.core.diff.</span></span><span class="sig-name descname"><span class="pre">calc_delta_pressure</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_input</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><span class="pre">xarray.DataArray</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">surface_pressure_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><span class="pre">xarray.DataArray</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">vertical_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">vertical_dim_units</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'hPa'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'Pa'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'mbar'</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">surface_pressure_data_units</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'hPa'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'Pa'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'mbar'</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><span class="pre">xarray.DataArray</span></a></span></span><a class="headerlink" href="#easyclimate.core.diff.calc_delta_pressure" title="Link to this definition">#</a></dt>
<dd><p>Calculates the pressure layer thickness (delta pressure) of a constant
pressure level coordinate system.</p>
<section id="id23">
<h3>Parameters<a class="headerlink" href="#id23" title="Link to this heading">#</a></h3>
<dl class="simple">
<dt>data_input: <a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.DataArray</span></code></a>.</dt><dd><p>The spatio-temporal data to be calculated.</p>
</dd>
<dt>surface_pressure_data: <a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.DataArray</span></code></a>.</dt><dd><p>Mean surface sea level pressure.</p>
</dd>
<dt>vertical_dim: <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>.</dt><dd><p>Vertical coordinate dimension name.</p>
</dd>
<dt>vertical_dim_units: <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>.</dt><dd><p>The unit corresponding to the vertical p-coordinate value. Optional values are <cite>hPa</cite>, <cite>Pa</cite>, <cite>mbar</cite>.</p>
</dd>
<dt>surface_pressure_data_units: <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>.</dt><dd><p>The unit corresponding to <cite>surface_pressure_data</cite> value. Optional values are <cite>hPa</cite>, <cite>Pa</cite>, <cite>mbar</cite>.</p>
</dd>
</dl>
</section>
<section id="id24">
<h3>Returns<a class="headerlink" href="#id24" title="Link to this heading">#</a></h3>
<p>The pressure layer thickness (delta pressure) of a constant pressure level coordinate system (<a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.DataArray</span></code></a> or <a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.Dataset.html#xarray.Dataset" title="(in xarray v2026.1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.Dataset</span></code></a>).</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<ul class="simple">
<li><p><a class="reference external" href="https://geocat-comp.readthedocs.io/en/latest/user_api/generated/geocat.comp.meteorology.delta_pressure.html#geocat.comp.meteorology.delta_pressure" title="(in GeoCAT-comp v2025.12.2.dev8)"><code class="xref py py-func docutils literal notranslate"><span class="pre">geocat.comp.meteorology.delta_pressure</span></code></a></p></li>
<li><p><a class="reference external" href="https://www.ncl.ucar.edu/Document/Functions/Built-in/dpres_plevel.shtml">dpres_plevel - NCL</a></p></li>
</ul>
</div>
</section>
<section id="examples">
<h3>Examples<a class="headerlink" href="#examples" title="Link to this heading">#</a></h3>
<p>The results in <a class="reference external" href="https://geocat-comp.readthedocs.io/en/latest/user_api/generated/geocat.comp.meteorology.delta_pressure.html#geocat.comp.meteorology.delta_pressure" title="(in GeoCAT-comp v2025.12.2.dev8)"><code class="xref py py-func docutils literal notranslate"><span class="pre">geocat.comp.meteorology.delta_pressure</span></code></a>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">geocat.comp.meteorology</span><span class="w"> </span><span class="kn">import</span> <span class="n">delta_pressure</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dp</span> <span class="o">=</span> <span class="n">delta_pressure</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">pressure_lev</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1000.</span><span class="p">,</span><span class="mf">925.</span><span class="p">,</span><span class="mf">850.</span><span class="p">,</span><span class="mf">700.</span><span class="p">,</span><span class="mf">600.</span><span class="p">,</span><span class="mf">500.</span><span class="p">,</span> <span class="mf">400.</span><span class="p">,</span><span class="mf">300.</span><span class="p">,</span><span class="mf">250.</span><span class="p">,</span><span class="mf">200.</span><span class="p">,</span><span class="mf">150.</span><span class="p">,</span><span class="mf">100.</span><span class="p">,</span> <span class="mf">70.</span><span class="p">,</span><span class="mf">50.</span><span class="p">,</span><span class="mf">30.</span><span class="p">,</span><span class="mf">20.</span><span class="p">,</span><span class="mf">10.</span><span class="p">]),</span>
<span class="gp">... </span>    <span class="n">surface_pressure</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1013</span><span class="p">]),</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span>
<span class="go">[[ 50.5  75.  112.5 125.  100.  100.  100.   75.   50.   50.   50.   40.</span>
<span class="go">   25.   20.   15.   10.    5. ]]</span>
</pre></div>
</div>
<p>For comparison, the results in <a class="reference internal" href="#easyclimate.core.diff.calc_delta_pressure" title="easyclimate.core.diff.calc_delta_pressure"><code class="xref py py-func docutils literal notranslate"><span class="pre">easyclimate.calc_delta_pressure</span></code></a>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">temp_sample</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">292.</span><span class="p">,</span><span class="mf">285.</span><span class="p">,</span><span class="mf">283.</span><span class="p">,</span><span class="mf">277.</span><span class="p">,</span><span class="mf">270.</span><span class="p">,</span><span class="mf">260.</span><span class="p">,</span> <span class="mf">250.</span><span class="p">,</span><span class="mf">235.</span><span class="p">,</span><span class="mf">225.</span><span class="p">,</span><span class="mf">215.</span><span class="p">,</span><span class="mf">207.</span><span class="p">,</span><span class="mf">207.</span><span class="p">,</span> <span class="mf">213.</span><span class="p">,</span><span class="mf">220.</span><span class="p">,</span><span class="mf">225.</span><span class="p">,</span><span class="mf">228.</span><span class="p">,</span><span class="mf">230.</span><span class="p">]]),</span>
<span class="gp">... </span>    <span class="n">dims</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;lat&quot;</span><span class="p">,</span> <span class="s2">&quot;plev&quot;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">coords</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;plev&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1000.</span><span class="p">,</span><span class="mf">925.</span><span class="p">,</span><span class="mf">850.</span><span class="p">,</span><span class="mf">700.</span><span class="p">,</span><span class="mf">600.</span><span class="p">,</span><span class="mf">500.</span><span class="p">,</span> <span class="mf">400.</span><span class="p">,</span><span class="mf">300.</span><span class="p">,</span><span class="mf">250.</span><span class="p">,</span><span class="mf">200.</span><span class="p">,</span><span class="mf">150.</span><span class="p">,</span><span class="mf">100.</span><span class="p">,</span> <span class="mf">70.</span><span class="p">,</span><span class="mf">50.</span><span class="p">,</span><span class="mf">30.</span><span class="p">,</span><span class="mf">20.</span><span class="p">,</span><span class="mf">10.</span><span class="p">]),</span>
<span class="gp">... </span>            <span class="s2">&quot;lat&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">])}</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dp</span> <span class="o">=</span> <span class="n">ecl</span><span class="o">.</span><span class="n">calc_delta_pressure</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">data_input</span> <span class="o">=</span> <span class="n">temp_sample</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">surface_pressure_data</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">([</span><span class="mi">1013</span><span class="p">],</span> <span class="n">dims</span> <span class="o">=</span> <span class="s2">&quot;lat&quot;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">vertical_dim</span> <span class="o">=</span> <span class="s2">&quot;plev&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">surface_pressure_data_units</span> <span class="o">=</span> <span class="s2">&quot;Pa&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">vertical_dim_units</span> <span class="o">=</span> <span class="s2">&quot;Pa&quot;</span><span class="p">,</span>
<span class="gp">... </span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="s2">&quot;lat&quot;</span><span class="p">,</span> <span class="s2">&quot;plev&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span>
<span class="go">&lt;xarray.DataArray &#39;plev&#39; (lat: 1, plev: 17)&gt; Size: 136B</span>
<span class="go">array([[ 50.5,  75. , 112.5, 125. , 100. , 100. , 100. ,  75. ,  50. ,</span>
<span class="go">        50. ,  50. ,  40. ,  25. ,  20. ,  15. ,  10. ,   5. ]])</span>
<span class="go">Coordinates:</span>
<span class="go">* lat      (lat) int64 8B 0</span>
<span class="go">* plev     (plev) float64 136B 1e+03 925.0 850.0 700.0 ... 50.0 30.0 20.0 10.0</span>
</pre></div>
</div>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="easyclimate.core.diff.calc_p_integral">
<span class="sig-prename descclassname"><span class="pre">easyclimate.core.diff.</span></span><span class="sig-name descname"><span class="pre">calc_p_integral</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_input</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><span class="pre">xarray.DataArray</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">vertical_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">vertical_dim_units</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'hPa'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'Pa'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'mbar'</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><span class="pre">xarray.DataArray</span></a></span></span><a class="headerlink" href="#easyclimate.core.diff.calc_p_integral" title="Link to this definition">#</a></dt>
<dd><p>Calculate the vertical integral along the barometric pressure direction in the p-coordinate system.</p>
<section id="id25">
<h3>Parameters<a class="headerlink" href="#id25" title="Link to this heading">#</a></h3>
<dl class="simple">
<dt>data_input: <a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.DataArray</span></code></a>.</dt><dd><p>The spatio-temporal data to be calculated.</p>
</dd>
<dt>vertical_dim: <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>.</dt><dd><p>Vertical coordinate dimension name.</p>
</dd>
<dt>vertical_dim_units: <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>.</dt><dd><p>The unit corresponding to the vertical p-coordinate value. Optional values are <cite>hPa</cite>, <cite>Pa</cite>, <cite>mbar</cite>.</p>
</dd>
<dt>normalize: <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, default: <cite>True</cite>.</dt><dd><p>Whether or not the integral results are averaged over the entire layer.</p>
</dd>
</dl>
</section>
<section id="id26">
<h3>Returns<a class="headerlink" href="#id26" title="Link to this heading">#</a></h3>
<p>The vertical integral along the barometric pressure direction in the p-coordinate system (<a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.DataArray</span></code></a> or <a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.Dataset.html#xarray.Dataset" title="(in xarray v2026.1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.Dataset</span></code></a>).</p>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>This method ignores the effect of topography, so it applies to altitudes <strong>above 900hPa</strong> and is <strong>NOT applicable to the Tibetan Plateau region</strong>.
For a fully accurate vertical integration, please use the <a class="reference internal" href="#easyclimate.core.diff.calc_top2surface_integral" title="easyclimate.core.diff.calc_top2surface_integral"><code class="xref py py-func docutils literal notranslate"><span class="pre">calc_top2surface_integral</span></code></a> function to calculate,
but the speed of the calculation is slightly slowed down.</p>
</div>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="easyclimate.core.diff.calc_top2surface_integral">
<span class="sig-prename descclassname"><span class="pre">easyclimate.core.diff.</span></span><span class="sig-name descname"><span class="pre">calc_top2surface_integral</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_input</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><span class="pre">xarray.DataArray</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">surface_pressure_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><span class="pre">xarray.DataArray</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">vertical_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">surface_pressure_data_units</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'hPa'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'Pa'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'mbar'</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vertical_dim_units</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'hPa'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'Pa'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'mbar'</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'Boer1982'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'Trenberth1991'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'vibeta-ncl'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'vibeta-ncl'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><span class="pre">xarray.DataArray</span></a></span></span><a class="headerlink" href="#easyclimate.core.diff.calc_top2surface_integral" title="Link to this definition">#</a></dt>
<dd><p>Calculate the vertical integral in the p-coordinate system from the ground to the zenith along the barometric pressure direction.</p>
<section id="id27">
<h3>Parameters<a class="headerlink" href="#id27" title="Link to this heading">#</a></h3>
<dl class="simple">
<dt>data_input: <a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.DataArray</span></code></a>.</dt><dd><p>The spatio-temporal data to be calculated.</p>
</dd>
<dt>surface_pressure_data: <a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.DataArray</span></code></a>.</dt><dd><p>Surface level pressure.</p>
</dd>
</dl>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This parameter only accepts local pressure (slp) and must <strong>NOT</strong> be substituted
with mean sea level pressure (msl). There is a fundamental difference in their physical meaning and numerical
characteristics‚Äîlocal pressure reflects atmospheric pressure at the actual elevation of local area,
while mean sea level pressure is a theoretical value adjusted to sea level.</p>
</div>
<dl>
<dt>vertical_dim: <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>.</dt><dd><p>Vertical coordinate dimension name.</p>
</dd>
<dt>surface_pressure_data_units: <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>.</dt><dd><p>The unit corresponding to <cite>surface_pressure_data</cite> value. Optional values are <cite>hPa</cite>, <cite>Pa</cite>, <cite>mbar</cite>.</p>
</dd>
<dt>vertical_dim_units: <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>.</dt><dd><p>The unit corresponding to the vertical p-coordinate value. Optional values are <cite>hPa</cite>, <cite>Pa</cite>, <cite>mbar</cite>.</p>
</dd>
<dt>method: {‚ÄúBoer1982‚Äù, ‚ÄúTrenberth1991‚Äù, ‚Äúvibeta-ncl‚Äù}, default: <cite>vibeta-ncl</cite>.</dt><dd><p>vertical integration method. Optional values are <code class="docutils literal notranslate"><span class="pre">Boer1982</span></code>, <code class="docutils literal notranslate"><span class="pre">Trenberth1991</span></code> and <code class="docutils literal notranslate"><span class="pre">vibeta-ncl</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The trapezoidal rule of integration is exactly equivalent to</p>
<div class="math notranslate nohighlight">
\[I = \sum_{j=1,2J-1,2} (\beta M)_j \Delta p_j,\]</div>
<p>where Kevin E. Trenberth (1991) define</p>
<div class="math notranslate nohighlight">
\[\begin{split}\beta_j = \left\lbrace
\begin{array}{ll}
1, &amp; \mathrm{if} \ p_{j-1} &lt; p_s,\\
0, &amp; \mathrm{if} \ p_{j+1} &gt; p_s ,\\
\frac{p_s - p_{j+1}}{p_{j-1} - p_{j+1}}, &amp; \mathrm{if}  \ p_{j-1} &gt; p_s &gt; p_{j+1}.
\end{array}
\right.\end{split}\]</div>
<p>While G. J. Boer (1982) define <span class="math notranslate nohighlight">\(\beta = 0, 1\)</span> only.</p>
</div>
</dd>
<dt>normalize: <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, default: <cite>True</cite>.</dt><dd><p>Whether or not the integral results are averaged over the entire layer.</p>
</dd>
</dl>
</section>
<section id="id28">
<h3>Returns<a class="headerlink" href="#id28" title="Link to this heading">#</a></h3>
<p>The vertical integral in the p-coordinate system from the ground to the zenith along the barometric pressure direction. (<a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.DataArray</span></code></a>).</p>
</section>
<section id="reference">
<h3>Reference<a class="headerlink" href="#reference" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://doi.org/10.1175/1520-0493(1982)110%3C1801:DEIIC%3E2.0.CO;2">Boer, G. J., 1982: Diagnostic Equations in Isobaric Coordinates. Mon. Wea. Rev., 110, 1801‚Äì1820,</a></p></li>
<li><p><a class="reference external" href="https://doi.org/10.1175/1520-0442(1991)004%3C0707:CDFGAC%3E2.0.CO;2">Trenberth, K. E., 1991: Climate Diagnostics from Global Analyses: Conservation of Mass in ECMWF Analyses. J. Climate, 4, 707‚Äì722,</a></p></li>
</ul>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<ul class="simple">
<li><p><a class="reference external" href="https://www.ncl.ucar.edu/Document/Functions/Built-in/vibeta.shtml">vibeta - NCL</a></p></li>
<li><p><a class="reference external" href="https://www.ncl.ucar.edu/Document/Functions/Built-in/dpres_plevel.shtml">dpres_plevel - NCL</a></p></li>
</ul>
</div>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="easyclimate.core.diff.calc_dxdy_laplacian">
<span class="sig-prename descclassname"><span class="pre">easyclimate.core.diff.</span></span><span class="sig-name descname"><span class="pre">calc_dxdy_laplacian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_input</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><span class="pre">xarray.DataArray</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">lon_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'lon'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'lat'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">R</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">6371200.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spherical_coord</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><span class="pre">xarray.DataArray</span></a></span></span><a class="headerlink" href="#easyclimate.core.diff.calc_dxdy_laplacian" title="Link to this definition">#</a></dt>
<dd><p>Calculate the horizontal Laplace term.</p>
<p>rectangular coordinates</p>
<div class="math notranslate nohighlight">
\[\nabla^2 F = \frac{\partial^2 F}{\partial x^2} + \frac{\partial^2 F}{\partial y^2}\]</div>
<p>Spherical coordinates</p>
<div class="math notranslate nohighlight">
\[\nabla^2 F = \frac{\partial^2 F}{\partial x^2} + \frac{\partial^2 F}{\partial y^2} - \frac{1}{R} \frac{\partial F}{\partial y} \tan \varphi\]</div>
<section id="id29">
<h3>Parameters<a class="headerlink" href="#id29" title="Link to this heading">#</a></h3>
<dl class="simple">
<dt>data_input: <a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.DataArray</span></code></a>.</dt><dd><p>The spatio-temporal data to be calculated.</p>
</dd>
<dt>lon_dim: <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, default: <cite>lon</cite>.</dt><dd><p>Longitude coordinate dimension name. By default extracting is applied over the <cite>lon</cite> dimension.</p>
</dd>
<dt>lat_dim: <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, default: <cite>lat</cite>.</dt><dd><p>Latitude coordinate dimension name. By default extracting is applied over the <cite>lat</cite> dimension.</p>
</dd>
<dt>R: <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, default: <cite>6370000</cite>.</dt><dd><p>Radius of the Earth.</p>
</dd>
<dt>spherical_coord: <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, default: <cite>True</cite>.</dt><dd><p>Whether or not to compute the horizontal Laplace term in spherical coordinates.</p>
</dd>
</dl>
</section>
<section id="id30">
<h3>Returns<a class="headerlink" href="#id30" title="Link to this heading">#</a></h3>
<p>The horizontal Laplace term. (<a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.DataArray</span></code></a>).</p>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="easyclimate.core.diff.calc_divergence">
<span class="sig-prename descclassname"><span class="pre">easyclimate.core.diff.</span></span><span class="sig-name descname"><span class="pre">calc_divergence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><span class="pre">xarray.DataArray</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">v_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><span class="pre">xarray.DataArray</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">lon_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'lon'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'lat'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">R</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">6371200.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spherical_coord</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cyclic_boundary</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'easyclimate'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'uv2dv_cfd-ncl'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'uv2dv_cfd-ncl'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><span class="pre">xarray.DataArray</span></a></span></span><a class="headerlink" href="#easyclimate.core.diff.calc_divergence" title="Link to this definition">#</a></dt>
<dd><p>Calculate the horizontal divergence term.</p>
<p>rectangular coordinates</p>
<div class="math notranslate nohighlight">
\[\mathrm{D} = \frac{\partial u}{\partial x} + \frac{\partial v}{\partial y}\]</div>
<p>Spherical coordinates</p>
<div class="math notranslate nohighlight">
\[\mathrm{D} = \frac{\partial u}{\partial x} + \frac{\partial v}{\partial y} - \frac{v}{R} \tan \varphi\]</div>
<section id="id31">
<h3>Parameters<a class="headerlink" href="#id31" title="Link to this heading">#</a></h3>
<dl class="simple">
<dt>u_data: <a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.DataArray</span></code></a>.</dt><dd><p>The zonal wind data.</p>
</dd>
<dt>v_data: <a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.DataArray</span></code></a>.</dt><dd><p>The meridional wind data.</p>
</dd>
<dt>lon_dim: <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, default: <cite>lon</cite>.</dt><dd><p>Longitude coordinate dimension name. By default extracting is applied over the <cite>lon</cite> dimension.</p>
</dd>
<dt>lat_dim: <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, default: <cite>lat</cite>.</dt><dd><p>Latitude coordinate dimension name. By default extracting is applied over the <cite>lat</cite> dimension.</p>
</dd>
<dt>R: <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, default: <cite>6371200.0</cite>.</dt><dd><p>Radius of the Earth.</p>
</dd>
<dt>spherical_coord: <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, default: <cite>True</cite>.</dt><dd><p>Whether or not to compute the horizontal Laplace term in spherical coordinates. The parameter is applicable only when <code class="docutils literal notranslate"><span class="pre">method</span> <span class="pre">=</span> <span class="pre">easyclimate</span></code>.</p>
</dd>
<dt>cyclic_boundary: <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, default: <cite>False</cite>.</dt><dd><p>If True, assume cyclic (periodic) boundaries in longitude. The parameter is applicable only when <code class="docutils literal notranslate"><span class="pre">method</span> <span class="pre">=</span> <span class="pre">ddvfidf-ncl</span></code>.</p>
</dd>
<dt>method: {‚Äúeasyclimate‚Äù, ‚Äúddvfidf-ncl‚Äù}, default: <cite>ddvfidf-ncl</cite>.</dt><dd><p>The method to calculate horizontal divergence term. Optional values are <code class="docutils literal notranslate"><span class="pre">easyclimate</span></code> and <code class="docutils literal notranslate"><span class="pre">ddvfidf-ncl</span></code>.</p>
</dd>
</dl>
</section>
<section id="id32">
<h3>Returns<a class="headerlink" href="#id32" title="Link to this heading">#</a></h3>
<p>The horizontal divergence term. (<a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.DataArray</span></code></a>).</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<ul class="simple">
<li><p><a class="reference external" href="https://www.ncl.ucar.edu/Document/Functions/Built-in/uv2dv_cfd.shtml">https://www.ncl.ucar.edu/Document/Functions/Built-in/uv2dv_cfd.shtml</a></p></li>
<li><p>Howard B. Bluestein. (1992). Synoptic-Dynamic Meteorology in Midlatitudes: Principles of Kinematics and Dynamics, Vol. 1. p113-114</p></li>
</ul>
</div>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="easyclimate.core.diff.calc_vorticity">
<span class="sig-prename descclassname"><span class="pre">easyclimate.core.diff.</span></span><span class="sig-name descname"><span class="pre">calc_vorticity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><span class="pre">xarray.DataArray</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">v_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><span class="pre">xarray.DataArray</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">lon_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'lon'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'lat'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">R</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">6371200.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spherical_coord</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cyclic_boundary</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'easyclimate'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'uv2vr_cfd-ncl'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'uv2vr_cfd-ncl'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><span class="pre">xarray.DataArray</span></a></span></span><a class="headerlink" href="#easyclimate.core.diff.calc_vorticity" title="Link to this definition">#</a></dt>
<dd><p>Calculate the horizontal relative vorticity term.</p>
<p>rectangular coordinates</p>
<div class="math notranslate nohighlight">
\[\zeta = \frac{\partial v}{\partial x} - \frac{\partial u}{\partial y}\]</div>
<p>Spherical coordinates</p>
<div class="math notranslate nohighlight">
\[\zeta = \frac{\partial v}{\partial x} - \frac{\partial u}{\partial y} + \frac{u}{R} \tan \varphi\]</div>
<section id="id33">
<h3>Parameters<a class="headerlink" href="#id33" title="Link to this heading">#</a></h3>
<dl class="simple">
<dt>u_data: <a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.DataArray</span></code></a>.</dt><dd><p>The zonal wind data.</p>
</dd>
<dt>v_data: <a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.DataArray</span></code></a>.</dt><dd><p>The meridional wind data.</p>
</dd>
<dt>lon_dim: <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, default: <cite>lon</cite>.</dt><dd><p>Longitude coordinate dimension name. By default extracting is applied over the <cite>lon</cite> dimension.</p>
</dd>
<dt>lat_dim: <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, default: <cite>lat</cite>.</dt><dd><p>Latitude coordinate dimension name. By default extracting is applied over the <cite>lat</cite> dimension.</p>
</dd>
<dt>R: <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, default: <cite>6370000</cite>.</dt><dd><p>Radius of the Earth.</p>
</dd>
<dt>spherical_coord: <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, default: <cite>True</cite>.</dt><dd><p>Whether or not to compute the horizontal Laplace term in spherical coordinates.</p>
</dd>
<dt>cyclic_boundary: <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, default: <cite>False</cite>.</dt><dd><p>If True, assume cyclic (periodic) boundaries in longitude. The parameter is applicable only when <code class="docutils literal notranslate"><span class="pre">method</span> <span class="pre">=</span> <span class="pre">uv2vr_cfd-ncl</span></code>.</p>
</dd>
<dt>method: {‚Äúeasyclimate‚Äù, ‚Äúuv2vr_cfd-ncl‚Äù}, default: <cite>uv2vr_cfd-ncl</cite>.</dt><dd><p>The method to calculate horizontal divergence term. Optional values are <code class="docutils literal notranslate"><span class="pre">easyclimate</span></code> and <code class="docutils literal notranslate"><span class="pre">uv2vr_cfd-ncl</span></code>.</p>
</dd>
</dl>
</section>
<section id="id34">
<h3>Returns<a class="headerlink" href="#id34" title="Link to this heading">#</a></h3>
<p>The horizontal relative vorticity term. (<a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.DataArray</span></code></a>).</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<ul class="simple">
<li><p><a class="reference external" href="https://www.ncl.ucar.edu/Document/Functions/Built-in/uv2vr_cfd.shtml">https://www.ncl.ucar.edu/Document/Functions/Built-in/uv2vr_cfd.shtml</a></p></li>
<li><p>Howard B. Bluestein. (1992). Synoptic-Dynamic Meteorology in Midlatitudes: Principles of Kinematics and Dynamics, Vol. 1. p113-114</p></li>
</ul>
</div>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="easyclimate.core.diff.calc_geostrophic_wind">
<span class="sig-prename descclassname"><span class="pre">easyclimate.core.diff.</span></span><span class="sig-name descname"><span class="pre">calc_geostrophic_wind</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><span class="pre">xarray.DataArray</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">lon_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'lon'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'lat'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">7.292e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">g</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">9.8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">R</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">6371200.0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><span class="pre">xarray.DataArray</span></a></span></span><a class="headerlink" href="#easyclimate.core.diff.calc_geostrophic_wind" title="Link to this definition">#</a></dt>
<dd><p>Calculate the geostrophic wind.</p>
<div class="math notranslate nohighlight">
\[u_g = - \frac{g}{f} \frac{\partial H}{\partial y}\]</div>
<div class="math notranslate nohighlight">
\[v_g = \frac{g}{f} \frac{\partial H}{\partial x}\]</div>
<section id="id35">
<h3>Parameters<a class="headerlink" href="#id35" title="Link to this heading">#</a></h3>
<dl class="simple">
<dt>z_data: <a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.DataArray</span></code></a>.</dt><dd><p>Atmospheric geopotential height.</p>
</dd>
<dt>lon_dim: <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, default: <cite>lon</cite>.</dt><dd><p>Longitude coordinate dimension name. By default extracting is applied over the <cite>lon</cite> dimension.</p>
</dd>
<dt>lat_dim: <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, default: <cite>lat</cite>.</dt><dd><p>Latitude coordinate dimension name. By default extracting is applied over the <cite>lat</cite> dimension.</p>
</dd>
<dt>omega: <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, default: <cite>7.292e-5</cite>.</dt><dd><p>The angular speed of the earth.</p>
</dd>
<dt>g: <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, default: <cite>9.8</cite>.</dt><dd><p>The acceleration of gravity.</p>
</dd>
<dt>R: <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, default: <cite>6370000</cite>.</dt><dd><p>Radius of the Earth.</p>
</dd>
</dl>
</section>
<section id="id36">
<h3>Returns<a class="headerlink" href="#id36" title="Link to this heading">#</a></h3>
<dl class="simple">
<dt>The geostrophic wind term. (<a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.DataArray</span></code></a>).</dt><dd><ul class="simple">
<li><p>ug</p></li>
<li><p>vg</p></li>
</ul>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="easyclimate.core.diff.calc_geostrophic_wind_vorticity">
<span class="sig-prename descclassname"><span class="pre">easyclimate.core.diff.</span></span><span class="sig-name descname"><span class="pre">calc_geostrophic_wind_vorticity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><span class="pre">xarray.DataArray</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">lon_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'lon'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'lat'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spherical_coord</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">7.292e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">g</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">9.8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">R</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">6371200.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cyclic_boundary</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'easyclimate'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'uv2vr_cfd-ncl'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'uv2vr_cfd-ncl'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><span class="pre">xarray.DataArray</span></a></span></span><a class="headerlink" href="#easyclimate.core.diff.calc_geostrophic_wind_vorticity" title="Link to this definition">#</a></dt>
<dd><p>Calculate the geostrophic vorticity.</p>
<p>Rectangular coordinates</p>
<div class="math notranslate nohighlight">
\[\zeta_g = \frac{\partial v_g}{\partial x} - \frac{\partial u_g}{\partial y}\]</div>
<p>Spherical coordinates</p>
<div class="math notranslate nohighlight">
\[\zeta_g = \frac{\partial v_g}{\partial x} - \frac{\partial u_g}{\partial y} + \frac{u_g}{R} \tan \varphi\]</div>
<section id="id37">
<h3>Parameters<a class="headerlink" href="#id37" title="Link to this heading">#</a></h3>
<dl class="simple">
<dt>z_data: <a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.DataArray</span></code></a>.</dt><dd><p>Atmospheric geopotential height.</p>
</dd>
<dt>lon_dim: <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, default: <cite>lon</cite>.</dt><dd><p>Longitude coordinate dimension name. By default extracting is applied over the <cite>lon</cite> dimension.</p>
</dd>
<dt>lat_dim: <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, default: <cite>lat</cite>.</dt><dd><p>Latitude coordinate dimension name. By default extracting is applied over the <cite>lat</cite> dimension.</p>
</dd>
<dt>spherical_coord: <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, default: <cite>True</cite>.</dt><dd><p>Whether or not to compute the horizontal Laplace term in spherical coordinates.</p>
</dd>
<dt>omega: <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, default: <cite>7.292e-5</cite>.</dt><dd><p>The angular speed of the earth.</p>
</dd>
<dt>g: <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, default: <cite>9.8</cite>.</dt><dd><p>The acceleration of gravity.</p>
</dd>
<dt>R: <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, default: <cite>6370000</cite>.</dt><dd><p>Radius of the Earth.</p>
</dd>
<dt>cyclic_boundary: <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, default: <cite>False</cite>.</dt><dd><p>If True, assume cyclic (periodic) boundaries in longitude. The parameter is applicable only when <code class="docutils literal notranslate"><span class="pre">method</span> <span class="pre">=</span> <span class="pre">uv2vr_cfd-ncl</span></code>.</p>
</dd>
<dt>method: {‚Äúeasyclimate‚Äù, ‚Äúuv2vr_cfd-ncl‚Äù}, default: <cite>uv2vr_cfd-ncl</cite>.</dt><dd><p>The method to calculate horizontal divergence term. Optional values are <code class="docutils literal notranslate"><span class="pre">easyclimate</span></code> and <code class="docutils literal notranslate"><span class="pre">uv2vr_cfd-ncl</span></code>.</p>
</dd>
</dl>
</section>
<section id="id38">
<h3>Returns<a class="headerlink" href="#id38" title="Link to this heading">#</a></h3>
<p>The geostrophic vorticity term. (<a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.DataArray</span></code></a>).</p>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="easyclimate.core.diff.calc_horizontal_water_flux">
<span class="sig-prename descclassname"><span class="pre">easyclimate.core.diff.</span></span><span class="sig-name descname"><span class="pre">calc_horizontal_water_flux</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">specific_humidity_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><span class="pre">xarray.DataArray</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">u_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><span class="pre">xarray.DataArray</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">v_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><span class="pre">xarray.DataArray</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">g</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">9.8</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.Dataset.html#xarray.Dataset" title="(in xarray v2026.1.0)"><span class="pre">xarray.Dataset</span></a></span></span><a class="headerlink" href="#easyclimate.core.diff.calc_horizontal_water_flux" title="Link to this definition">#</a></dt>
<dd><p>Calculate horizontal water vapor flux at each vertical level.</p>
<div class="math notranslate nohighlight">
\[\frac{1}{g} q \mathbf{V} = \frac{1}{g} (u q\ \mathbf{i} + vq\ \mathbf{j})\]</div>
<section id="id39">
<h3>Parameters<a class="headerlink" href="#id39" title="Link to this heading">#</a></h3>
<dl class="simple">
<dt>specific_humidity_data: <a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.DataArray</span></code></a>.</dt><dd><p>The absolute humidity data.</p>
</dd>
<dt>u_data: <a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.DataArray</span></code></a>.</dt><dd><p>The zonal wind data.</p>
</dd>
<dt>v_data: <a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.DataArray</span></code></a>.</dt><dd><p>The meridional wind data.</p>
</dd>
<dt>g: <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, default: <cite>9.8</cite>.</dt><dd><p>The acceleration of gravity.</p>
</dd>
</dl>
</section>
<section id="id40">
<h3>Returns<a class="headerlink" href="#id40" title="Link to this heading">#</a></h3>
<p>The water vapor flux. (<a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.Dataset.html#xarray.Dataset" title="(in xarray v2026.1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.Dataset</span></code></a>).</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(qu\)</span>: zonal water vapor flux.</p></li>
<li><p><span class="math notranslate nohighlight">\(qv\)</span>: meridional water vapor flux.</p></li>
</ul>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="easyclimate.core.diff.calc_vertical_water_flux">
<span class="sig-prename descclassname"><span class="pre">easyclimate.core.diff.</span></span><span class="sig-name descname"><span class="pre">calc_vertical_water_flux</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">specific_humidity_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><span class="pre">xarray.DataArray</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><span class="pre">xarray.DataArray</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">g</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">9.8</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><span class="pre">xarray.DataArray</span></a></span></span><a class="headerlink" href="#easyclimate.core.diff.calc_vertical_water_flux" title="Link to this definition">#</a></dt>
<dd><p>Calculate vertical water vapor flux.</p>
<div class="math notranslate nohighlight">
\[-\omega \frac{q}{g}\]</div>
<section id="id41">
<h3>Parameters<a class="headerlink" href="#id41" title="Link to this heading">#</a></h3>
<dl class="simple">
<dt>specific_humidity_data: <a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.DataArray</span></code></a>.</dt><dd><p>The absolute humidity data.</p>
</dd>
<dt>omega_data: <a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.DataArray</span></code></a>.</dt><dd><p>The vertical velocity data (<span class="math notranslate nohighlight">\(\frac{\mathrm{d} p}{\mathrm{d} t}\)</span>).</p>
</dd>
<dt>g: <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, default: <cite>9.8</cite>.</dt><dd><p>The acceleration of gravity.</p>
</dd>
</dl>
</section>
<section id="id42">
<h3>Returns<a class="headerlink" href="#id42" title="Link to this heading">#</a></h3>
<p>The vertical water flux. (<a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.DataArray</span></code></a>).</p>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="easyclimate.core.diff.calc_water_flux_top2surface_integral">
<span class="sig-prename descclassname"><span class="pre">easyclimate.core.diff.</span></span><span class="sig-name descname"><span class="pre">calc_water_flux_top2surface_integral</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">specific_humidity_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><span class="pre">xarray.DataArray</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">u_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><span class="pre">xarray.DataArray</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">v_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><span class="pre">xarray.DataArray</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">surface_pressure_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><span class="pre">xarray.DataArray</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">surface_pressure_data_units</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'hPa'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'Pa'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'mbar'</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">specific_humidity_data_units</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'kg/kg'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'g/kg'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'g/g'</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vertical_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">vertical_dim_units</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'hPa'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'Pa'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'mbar'</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'Boer1982'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'Trenberth1991'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'vibeta-ncl'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'vibeta-ncl'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">g</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">9.8</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><span class="pre">xarray.DataArray</span></a></span></span><a class="headerlink" href="#easyclimate.core.diff.calc_water_flux_top2surface_integral" title="Link to this definition">#</a></dt>
<dd><p>Calculate the water vapor flux across the vertical level.</p>
<div class="math notranslate nohighlight">
\[\frac{1}{g} \int_0^{p_s} (q\mathbf{v}),dp\]</div>
<section id="id43">
<h3>Parameters<a class="headerlink" href="#id43" title="Link to this heading">#</a></h3>
<dl class="simple">
<dt>specific_humidity: <a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.DataArray</span></code></a>.</dt><dd><p>The absolute humidity data.</p>
</dd>
<dt>u_data: <a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.DataArray</span></code></a>.</dt><dd><p>The zonal wind data.</p>
</dd>
<dt>v_data: <a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.DataArray</span></code></a>.</dt><dd><p>The meridional wind data.</p>
</dd>
<dt>surface_pressure_data: <a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.DataArray</span></code></a>.</dt><dd><p>Mean surface sea level pressure.</p>
</dd>
<dt>surface_pressure_data_units: <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>.</dt><dd><p>The unit corresponding to <cite>surface_pressure_data</cite> value. Optional values are <cite>hPa</cite>, <cite>Pa</cite>, <cite>mbar</cite>.</p>
</dd>
<dt>specific_humidity_data_units: <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>.</dt><dd><p>The unit corresponding to <cite>specific_humidity</cite> value. Optional values are <cite>kg/kg</cite>, <cite>g/kg</cite> and so on.</p>
</dd>
<dt>vertical_dim: <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>.</dt><dd><p>Vertical coordinate dimension name.</p>
</dd>
<dt>vertical_dim_units: <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>.</dt><dd><p>The unit corresponding to the vertical p-coordinate value. Optional values are <cite>hPa</cite>, <cite>Pa</cite>, <cite>mbar</cite>.</p>
</dd>
<dt>method: <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, default: <cite>‚ÄòTrenberth1991‚Äô</cite>.</dt><dd><p>Vertical integration method. Optional values are <cite>Boer1982</cite>, <cite>‚ÄòTrenberth1991‚Äô</cite>.</p>
</dd>
<dt>g: <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, default: <cite>9.8</cite>.</dt><dd><p>The acceleration of gravity.</p>
</dd>
</dl>
</section>
<section id="id44">
<h3>Returns<a class="headerlink" href="#id44" title="Link to this heading">#</a></h3>
<p>The water vapor flux. (<a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.Dataset.html#xarray.Dataset" title="(in xarray v2026.1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.Dataset</span></code></a>, <span class="math notranslate nohighlight">\(\mathrm{kg \cdot m^-1 \cdot s^-1 }\)</span>).</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(qu\)</span>: zonal water vapor flux.</p></li>
<li><p><span class="math notranslate nohighlight">\(qv\)</span>: meridional water vapor flux.</p></li>
</ul>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#easyclimate.core.diff.calc_top2surface_integral" title="easyclimate.core.diff.calc_top2surface_integral"><code class="xref py py-func docutils literal notranslate"><span class="pre">calc_top2surface_integral</span></code></a></p>
</div>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="easyclimate.core.diff.calc_divergence_watervaporflux">
<span class="sig-prename descclassname"><span class="pre">easyclimate.core.diff.</span></span><span class="sig-name descname"><span class="pre">calc_divergence_watervaporflux</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">specific_humidity_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><span class="pre">xarray.DataArray</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">u_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><span class="pre">xarray.DataArray</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">v_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><span class="pre">xarray.DataArray</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">specific_humidity_data_units</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'kg/kg'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'g/kg'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'g/g'</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spherical_coord</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cyclic_boundary</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'easyclimate'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'uv2dv_cfd-ncl'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'uv2dv_cfd-ncl'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lon_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'lon'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'lat'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">g</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">9.8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">R</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">6371200.0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><span class="pre">xarray.DataArray</span></a></span></span><a class="headerlink" href="#easyclimate.core.diff.calc_divergence_watervaporflux" title="Link to this definition">#</a></dt>
<dd><p>Calculate water vapor flux divergence at each vertical level.</p>
<div class="math notranslate nohighlight">
\[\nabla \left( \frac{1}{g} q \mathbf{V} \right) = \frac{1}{g} \nabla \cdot \left( q \mathbf{V} \right)\]</div>
<section id="id45">
<h3>Parameters<a class="headerlink" href="#id45" title="Link to this heading">#</a></h3>
<dl class="simple">
<dt>specific_humidity_data: <a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.DataArray</span></code></a>.</dt><dd><p>The absolute humidity data.</p>
</dd>
<dt>u_data: <a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.DataArray</span></code></a>.</dt><dd><p>The zonal wind data.</p>
</dd>
<dt>v_data: <a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.DataArray</span></code></a>.</dt><dd><p>The meridional wind data.</p>
</dd>
<dt>specific_humidity_data_units: <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>.</dt><dd><p>The unit corresponding to <cite>specific_humidity</cite> value. Optional values are <cite>kg/kg</cite>, <cite>g/kg</cite> and so on.</p>
</dd>
<dt>spherical_coord: <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, default: <cite>True</cite>.</dt><dd><p>Whether or not to compute the horizontal Laplace term in spherical coordinates. The parameter is applicable only when <code class="docutils literal notranslate"><span class="pre">method</span> <span class="pre">=</span> <span class="pre">easyclimate</span></code>.</p>
</dd>
<dt>cyclic_boundary: <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, default: <cite>False</cite>.</dt><dd><p>If True, assume cyclic (periodic) boundaries in longitude. The parameter is applicable only when <code class="docutils literal notranslate"><span class="pre">method</span> <span class="pre">=</span> <span class="pre">ddvfidf-ncl</span></code>.</p>
</dd>
</dl>
<p>method: {‚Äúeasyclimate‚Äù, ‚Äúddvfidf-ncl‚Äù}, default: <cite>ddvfidf-ncl</cite>.
lon_dim: <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, default: <cite>lon</cite>.</p>
<blockquote>
<div><p>Longitude coordinate dimension name. By default extracting is applied over the <cite>lon</cite> dimension.</p>
</div></blockquote>
<dl class="simple">
<dt>lat_dim: <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, default: <cite>lat</cite>.</dt><dd><p>Latitude coordinate dimension name. By default extracting is applied over the <cite>lat</cite> dimension.</p>
</dd>
<dt>g: <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, default: <cite>9.8</cite>.</dt><dd><p>The acceleration of gravity.</p>
</dd>
<dt>R: <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, default: <cite>6370000</cite>.</dt><dd><p>Radius of the Earth.</p>
</dd>
</dl>
</section>
<section id="id46">
<h3>Returns<a class="headerlink" href="#id46" title="Link to this heading">#</a></h3>
<p>The water vapor flux divergence. (<a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.DataArray</span></code></a>).</p>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="easyclimate.core.diff.calc_divergence_watervaporflux_top2surface_integral">
<span class="sig-prename descclassname"><span class="pre">easyclimate.core.diff.</span></span><span class="sig-name descname"><span class="pre">calc_divergence_watervaporflux_top2surface_integral</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">specific_humidity_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><span class="pre">xarray.DataArray</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">u_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><span class="pre">xarray.DataArray</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">v_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><span class="pre">xarray.DataArray</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">surface_pressure_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><span class="pre">xarray.DataArray</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">vertical_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">specific_humidity_data_units</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'kg/kg'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'g/kg'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'g/g'</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">surface_pressure_data_units</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'hPa'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'Pa'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'mbar'</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vertical_dim_units</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'hPa'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'Pa'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'mbar'</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spherical_coord</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cyclic_boundary</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lon_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'lon'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'lat'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">integral_method</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'Boer1982'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'Trenberth1991'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'vibeta-ncl'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'vibeta-ncl'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">div_method</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'easyclimate'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'uv2dv_cfd-ncl'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'uv2dv_cfd-ncl'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">g</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">9.8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">R</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">6371200.0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><span class="pre">xarray.DataArray</span></a></span></span><a class="headerlink" href="#easyclimate.core.diff.calc_divergence_watervaporflux_top2surface_integral" title="Link to this definition">#</a></dt>
<dd><p>Calculate water vapor flux divergence across the vertical level.</p>
<div class="math notranslate nohighlight">
\[\nabla \cdot \frac{1}{g} \int_0^{p_s} (q\mathbf{v}),dp\]</div>
<section id="id47">
<h3>Parameters<a class="headerlink" href="#id47" title="Link to this heading">#</a></h3>
<dl>
<dt>specific_humidity_data: <a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.DataArray</span></code></a>.</dt><dd><p>The absolute humidity data.</p>
</dd>
<dt>u_data: <a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.DataArray</span></code></a>.</dt><dd><p>The zonal wind data.</p>
</dd>
<dt>v_data: <a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.DataArray</span></code></a>.</dt><dd><p>The meridional wind data.</p>
</dd>
<dt>surface_pressure_data: <a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.DataArray</span></code></a>.</dt><dd><p>Mean surface sea level pressure.</p>
</dd>
<dt>vertical_dim: <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>.</dt><dd><p>Vertical coordinate dimension name.</p>
</dd>
<dt>specific_humidity_data_units: <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>.</dt><dd><p>The unit corresponding to <cite>specific_humidity</cite> value. Optional values are <cite>kg/kg</cite>, <cite>g/kg</cite> and so on.</p>
</dd>
<dt>surface_pressure_data_units: <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>.</dt><dd><p>The unit corresponding to <cite>surface_pressure_data</cite> value. Optional values are <cite>hPa</cite>, <cite>Pa</cite>, <cite>mbar</cite>.</p>
</dd>
<dt>vertical_dim_units: <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>.</dt><dd><p>The unit corresponding to the vertical p-coordinate value. Optional values are <cite>hPa</cite>, <cite>Pa</cite>, <cite>mbar</cite>.</p>
</dd>
<dt>spherical_coord: <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, default: <cite>True</cite>.</dt><dd><p>Whether or not to compute the horizontal Laplace term in spherical coordinates. The parameter is applicable only when <code class="docutils literal notranslate"><span class="pre">method</span> <span class="pre">=</span> <span class="pre">easyclimate</span></code>.</p>
</dd>
<dt>cyclic_boundary: <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, default: <cite>False</cite>.</dt><dd><p>If True, assume cyclic (periodic) boundaries in longitude. The parameter is applicable only when <code class="docutils literal notranslate"><span class="pre">method</span> <span class="pre">=</span> <span class="pre">ddvfidf-ncl</span></code>.</p>
</dd>
<dt>lon_dim: <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, default: <cite>lon</cite>.</dt><dd><p>Longitude coordinate dimension name. By default extracting is applied over the <cite>lon</cite> dimension.</p>
</dd>
<dt>lat_dim: <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, default: <cite>lat</cite>.</dt><dd><p>Latitude coordinate dimension name. By default extracting is applied over the <cite>lat</cite> dimension.</p>
</dd>
<dt>integral_method: {‚ÄúBoer1982‚Äù, ‚ÄúTrenberth1991‚Äù, ‚Äúvibeta-ncl‚Äù}, default: <cite>vibeta-ncl</cite>.</dt><dd><p>The vertical integration method. Optional values are <code class="docutils literal notranslate"><span class="pre">Boer1982</span></code>, <code class="docutils literal notranslate"><span class="pre">Trenberth1991</span></code> and <code class="docutils literal notranslate"><span class="pre">vibeta-ncl</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The trapezoidal rule of integration is exactly equivalent to</p>
<div class="math notranslate nohighlight">
\[I = \sum_{j=1,2J-1,2} (\beta M)_j \Delta p_j,\]</div>
<p>where Kevin E. Trenberth (1991) define</p>
<div class="math notranslate nohighlight">
\[\begin{split}\beta_j = \left\lbrace
\begin{array}{ll}
1, &amp; \mathrm{if} \ p_{j-1} &lt; p_s,\\
0, &amp; \mathrm{if} \ p_{j+1} &gt; p_s ,\\
\frac{p_s - p_{j+1}}{p_{j-1} - p_{j+1}}, &amp; \mathrm{if}  \ p_{j-1} &gt; p_s &gt; p_{j+1}.
\end{array}
\right.\end{split}\]</div>
<p>While G. J. Boer (1982) define <span class="math notranslate nohighlight">\(\beta = 0, 1\)</span> only.</p>
</div>
</dd>
<dt>div_method: {‚Äúeasyclimate‚Äù, ‚Äúddvfidf-ncl‚Äù}, default: <cite>ddvfidf-ncl</cite>.</dt><dd><p>The method to calculate horizontal divergence term. Optional values are <code class="docutils literal notranslate"><span class="pre">easyclimate</span></code> and <code class="docutils literal notranslate"><span class="pre">ddvfidf-ncl</span></code>.</p>
</dd>
<dt>g: <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, default: <cite>9.8</cite>.</dt><dd><p>The acceleration of gravity.</p>
</dd>
<dt>R: <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, default: <cite>6370000</cite>.</dt><dd><p>Radius of the Earth.</p>
</dd>
</dl>
</section>
<section id="id48">
<h3>Returns<a class="headerlink" href="#id48" title="Link to this heading">#</a></h3>
<p>The water vapor flux divergence. (<a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.DataArray</span></code></a>, <span class="math notranslate nohighlight">\(\mathrm{kg \cdot m^-2 \cdot s^-1 }\)</span>).</p>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="easyclimate.core.diff.calc_u_advection">
<span class="sig-prename descclassname"><span class="pre">easyclimate.core.diff.</span></span><span class="sig-name descname"><span class="pre">calc_u_advection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><span class="pre">xarray.DataArray</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">temper_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><span class="pre">xarray.DataArray</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">lon_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'lon'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'lat'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_dx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">R</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">6371200.0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><span class="pre">xarray.DataArray</span></a></span></span><a class="headerlink" href="#easyclimate.core.diff.calc_u_advection" title="Link to this definition">#</a></dt>
<dd><p>Calculate zonal temperature advection at each vertical level.</p>
<div class="math notranslate nohighlight">
\[-u \frac{\partial T}{\partial x}\]</div>
<section id="id49">
<h3>Parameters<a class="headerlink" href="#id49" title="Link to this heading">#</a></h3>
<dl class="simple">
<dt>u_data: <a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.DataArray</span></code></a>.</dt><dd><p>The zonal wind data.</p>
</dd>
<dt>temper_data: <a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.DataArray</span></code></a>.</dt><dd><p>Air temperature.</p>
</dd>
<dt>lon_dim: <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, default: <cite>lon</cite>.</dt><dd><p>Longitude coordinate dimension name. By default extracting is applied over the <cite>lon</cite> dimension.</p>
</dd>
<dt>lat_dim: <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, default: <cite>lat</cite>.</dt><dd><p>Latitude coordinate dimension name. By default extracting is applied over the <cite>lat</cite> dimension.</p>
</dd>
<dt>min_dx: <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, default: <cite>1.0</cite>.</dt><dd><p>The minimum acceptable value of <cite>dx</cite>, below which parts will set <cite>nan</cite> to avoid large computational errors.
The unit is m. You can set it to a negative value in order to remove this benefit.</p>
</dd>
<dt>edge_order: {1, 2}, optional</dt><dd><p>Gradient is calculated using N-th order accurate differences at the boundaries. Default: 1.</p>
</dd>
<dt>R: <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, default: <cite>6370000</cite>.</dt><dd><p>Radius of the Earth.</p>
</dd>
</dl>
</section>
<section id="id50">
<h3>Returns<a class="headerlink" href="#id50" title="Link to this heading">#</a></h3>
<p>The zonal temperature advection. (<a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.DataArray</span></code></a>).</p>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="easyclimate.core.diff.calc_v_advection">
<span class="sig-prename descclassname"><span class="pre">easyclimate.core.diff.</span></span><span class="sig-name descname"><span class="pre">calc_v_advection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><span class="pre">xarray.DataArray</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">temper_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><span class="pre">xarray.DataArray</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'lat'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_dy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">R</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">6371200.0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><span class="pre">xarray.DataArray</span></a></span></span><a class="headerlink" href="#easyclimate.core.diff.calc_v_advection" title="Link to this definition">#</a></dt>
<dd><p>Calculate meridional temperature advection at each vertical level.</p>
<div class="math notranslate nohighlight">
\[-v \frac{\partial T}{\partial y}\]</div>
<section id="id51">
<h3>Parameters<a class="headerlink" href="#id51" title="Link to this heading">#</a></h3>
<dl class="simple">
<dt>v_data: <a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.DataArray</span></code></a>.</dt><dd><p>The meridional wind data.</p>
</dd>
<dt>temper_data: <a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.DataArray</span></code></a>.</dt><dd><p>Air temperature.</p>
</dd>
<dt>lat_dim: <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, default: <cite>lat</cite>.</dt><dd><p>Latitude coordinate dimension name. By default extracting is applied over the <cite>lat</cite> dimension.</p>
</dd>
</dl>
</section>
<section id="id52">
<h3>Returns<a class="headerlink" href="#id52" title="Link to this heading">#</a></h3>
<p>The meridional temperature advection. (<a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.DataArray</span></code></a>).</p>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="easyclimate.core.diff.calc_p_advection">
<span class="sig-prename descclassname"><span class="pre">easyclimate.core.diff.</span></span><span class="sig-name descname"><span class="pre">calc_p_advection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">omega_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><span class="pre">xarray.DataArray</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">temper_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><span class="pre">xarray.DataArray</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">vertical_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">vertical_dim_units</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'hPa'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'Pa'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'mbar'</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><span class="pre">xarray.DataArray</span></a></span></span><a class="headerlink" href="#easyclimate.core.diff.calc_p_advection" title="Link to this definition">#</a></dt>
<dd><p>Calculate vertical temperature transport at each vertical level.</p>
<div class="math notranslate nohighlight">
\[-\omega \frac{\partial T}{\partial p}\]</div>
<section id="id53">
<h3>Parameters<a class="headerlink" href="#id53" title="Link to this heading">#</a></h3>
<dl class="simple">
<dt>omega: <a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.DataArray</span></code></a>.</dt><dd><p>The vertical velocity data (<span class="math notranslate nohighlight">\(\frac{\mathrm{d} p}{\mathrm{d} t}\)</span>).</p>
</dd>
<dt>temper_data: <a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.DataArray</span></code></a>.</dt><dd><p>Air temperature.</p>
</dd>
<dt>vertical_dim: <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>.</dt><dd><p>Vertical coordinate dimension name.</p>
</dd>
<dt>vertical_dim_units: <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>.</dt><dd><p>The unit corresponding to the vertical p-coordinate value. Optional values are <cite>hPa</cite>, <cite>Pa</cite>, <cite>mbar</cite>.</p>
</dd>
</dl>
</section>
<section id="id54">
<h3>Returns<a class="headerlink" href="#id54" title="Link to this heading">#</a></h3>
<p>The vertical temperature transport. (<a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.DataArray</span></code></a>).</p>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="easyclimate.core.diff.calc_shear_stretch_deform">
<span class="sig-prename descclassname"><span class="pre">easyclimate.core.diff.</span></span><span class="sig-name descname"><span class="pre">calc_shear_stretch_deform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><span class="pre">xarray.DataArray</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">v_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><span class="pre">xarray.DataArray</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">lon_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'lon'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'lat'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">{1,</span> <span class="pre">2}</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">R</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">6371200.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#easyclimate.core.diff.calc_shear_stretch_deform" title="Link to this definition">#</a></dt>
<dd><ul class="simple">
<li><p><a class="reference external" href="https://www.ncl.ucar.edu/Document/Functions/Contributed/shear_stretch_deform_cfd.shtml">https://www.ncl.ucar.edu/Document/Functions/Contributed/shear_stretch_deform_cfd.shtml</a></p></li>
<li><p>Spensberger, C., &amp; Spengler, T. (2014). A New Look at Deformation as a Diagnostic for Large-Scale Flow. Journal of the Atmospheric Sciences, 71(11), 4221-4234. <a class="reference external" href="https://doi.org/10.1175/JAS-D-14-0108.1">https://doi.org/10.1175/JAS-D-14-0108.1</a></p></li>
</ul>
</dd></dl>

</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#functions">Functions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-contents">Module Contents</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#easyclimate.core.diff.calc_gradient"><code class="docutils literal notranslate"><span class="pre">calc_gradient()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#easyclimate.core.diff.calc_dx_gradient"><code class="docutils literal notranslate"><span class="pre">calc_dx_gradient()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#easyclimate.core.diff.calc_dlon_radian_gradient"><code class="docutils literal notranslate"><span class="pre">calc_dlon_radian_gradient()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#easyclimate.core.diff.calc_dlon_degree_gradient"><code class="docutils literal notranslate"><span class="pre">calc_dlon_degree_gradient()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#easyclimate.core.diff.calc_dy_gradient"><code class="docutils literal notranslate"><span class="pre">calc_dy_gradient()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#easyclimate.core.diff.calc_dlat_radian_gradient"><code class="docutils literal notranslate"><span class="pre">calc_dlat_radian_gradient()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#easyclimate.core.diff.calc_dlat_degree_gradient"><code class="docutils literal notranslate"><span class="pre">calc_dlat_degree_gradient()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#easyclimate.core.diff.calc_dx_laplacian"><code class="docutils literal notranslate"><span class="pre">calc_dx_laplacian()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#easyclimate.core.diff.calc_dy_laplacian"><code class="docutils literal notranslate"><span class="pre">calc_dy_laplacian()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#easyclimate.core.diff.calc_dxdy_mixed_derivatives"><code class="docutils literal notranslate"><span class="pre">calc_dxdy_mixed_derivatives()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#easyclimate.core.diff.calc_p_gradient"><code class="docutils literal notranslate"><span class="pre">calc_p_gradient()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#easyclimate.core.diff.calc_time_gradient"><code class="docutils literal notranslate"><span class="pre">calc_time_gradient()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#easyclimate.core.diff.calc_delta_pressure"><code class="docutils literal notranslate"><span class="pre">calc_delta_pressure()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#easyclimate.core.diff.calc_p_integral"><code class="docutils literal notranslate"><span class="pre">calc_p_integral()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#easyclimate.core.diff.calc_top2surface_integral"><code class="docutils literal notranslate"><span class="pre">calc_top2surface_integral()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#easyclimate.core.diff.calc_dxdy_laplacian"><code class="docutils literal notranslate"><span class="pre">calc_dxdy_laplacian()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#easyclimate.core.diff.calc_divergence"><code class="docutils literal notranslate"><span class="pre">calc_divergence()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#easyclimate.core.diff.calc_vorticity"><code class="docutils literal notranslate"><span class="pre">calc_vorticity()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#easyclimate.core.diff.calc_geostrophic_wind"><code class="docutils literal notranslate"><span class="pre">calc_geostrophic_wind()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#easyclimate.core.diff.calc_geostrophic_wind_vorticity"><code class="docutils literal notranslate"><span class="pre">calc_geostrophic_wind_vorticity()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#easyclimate.core.diff.calc_horizontal_water_flux"><code class="docutils literal notranslate"><span class="pre">calc_horizontal_water_flux()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#easyclimate.core.diff.calc_vertical_water_flux"><code class="docutils literal notranslate"><span class="pre">calc_vertical_water_flux()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#easyclimate.core.diff.calc_water_flux_top2surface_integral"><code class="docutils literal notranslate"><span class="pre">calc_water_flux_top2surface_integral()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#easyclimate.core.diff.calc_divergence_watervaporflux"><code class="docutils literal notranslate"><span class="pre">calc_divergence_watervaporflux()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#easyclimate.core.diff.calc_divergence_watervaporflux_top2surface_integral"><code class="docutils literal notranslate"><span class="pre">calc_divergence_watervaporflux_top2surface_integral()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#easyclimate.core.diff.calc_u_advection"><code class="docutils literal notranslate"><span class="pre">calc_u_advection()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#easyclimate.core.diff.calc_v_advection"><code class="docutils literal notranslate"><span class="pre">calc_v_advection()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#easyclimate.core.diff.calc_p_advection"><code class="docutils literal notranslate"><span class="pre">calc_p_advection()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#easyclimate.core.diff.calc_shear_stretch_deform"><code class="docutils literal notranslate"><span class="pre">calc_shear_stretch_deform()</span></code></a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By shenyulu and easyclimate developers
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      ¬© Copyright 2022-2026, ShenyuluÔºàÊ∑±Èõ®Èú≤Ôºâ and easyclimate developers.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    <p class="last-updated">
  Last updated on 2026-01-30.
  <br/>
</p>
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>